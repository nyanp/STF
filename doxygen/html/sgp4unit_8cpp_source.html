<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>STF: stf/environment/sgp4/sgp4unit.cpp ソースファイル</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- 作成： Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'検索');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STF</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li class="current"><a href="files.html"><span>ファイル</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>ファイル一覧</span></a></li>
      <li><a href="globals.html"><span>ファイルメンバ</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>stf/environment/sgp4/sgp4unit.cpp</h1>  </div>
</div>
<div class="contents">
<a href="sgp4unit_8cpp.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">/*     ----------------------------------------------------------------</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">*                               sgp4unit.cpp</span>
<a name="l00011"></a>00011 <span class="comment">*</span>
<a name="l00012"></a>00012 <span class="comment">*    this file contains the sgp4 procedures for analytical propagation</span>
<a name="l00013"></a>00013 <span class="comment">*    of a satellite. the code was originally released in the 1980 and 1986</span>
<a name="l00014"></a>00014 <span class="comment">*    spacetrack papers. a detailed discussion of the theory and history</span>
<a name="l00015"></a>00015 <span class="comment">*    may be found in the 2006 aiaa paper by vallado, crawford, hujsak,</span>
<a name="l00016"></a>00016 <span class="comment">*    and kelso.</span>
<a name="l00017"></a>00017 <span class="comment">*</span>
<a name="l00018"></a>00018 <span class="comment">*                            companion code for</span>
<a name="l00019"></a>00019 <span class="comment">*               fundamentals of astrodynamics and applications</span>
<a name="l00020"></a>00020 <span class="comment">*                                    2007</span>
<a name="l00021"></a>00021 <span class="comment">*                              by david vallado</span>
<a name="l00022"></a>00022 <span class="comment">*</span>
<a name="l00023"></a>00023 <span class="comment">*       (w) 719-573-2600, email dvallado@agi.com</span>
<a name="l00024"></a>00024 <span class="comment">*</span>
<a name="l00025"></a>00025 <span class="comment">*    current :</span>
<a name="l00026"></a>00026 <span class="comment">*              16 nov 07  david vallado</span>
<a name="l00027"></a>00027 <span class="comment">*                           misc fixes for better compliance</span>
<a name="l00028"></a>00028 <span class="comment">*    changes :</span>
<a name="l00029"></a>00029 <span class="comment">*              20 apr 07  david vallado</span>
<a name="l00030"></a>00030 <span class="comment">*                           misc fixes for constants</span>
<a name="l00031"></a>00031 <span class="comment">*              11 aug 06  david vallado</span>
<a name="l00032"></a>00032 <span class="comment">*                           chg lyddane choice back to strn3, constants, misc doc</span>
<a name="l00033"></a>00033 <span class="comment">*              15 dec 05  david vallado</span>
<a name="l00034"></a>00034 <span class="comment">*                           misc fixes</span>
<a name="l00035"></a>00035 <span class="comment">*              26 jul 05  david vallado</span>
<a name="l00036"></a>00036 <span class="comment">*                           fixes for paper</span>
<a name="l00037"></a>00037 <span class="comment">*                           note that each fix is preceded by a</span>
<a name="l00038"></a>00038 <span class="comment">*                           comment with &quot;sgp4fix&quot; and an explanation of</span>
<a name="l00039"></a>00039 <span class="comment">*                           what was changed</span>
<a name="l00040"></a>00040 <span class="comment">*              10 aug 04  david vallado</span>
<a name="l00041"></a>00041 <span class="comment">*                           2nd printing baseline working</span>
<a name="l00042"></a>00042 <span class="comment">*              14 may 01  david vallado</span>
<a name="l00043"></a>00043 <span class="comment">*                           2nd edition baseline</span>
<a name="l00044"></a>00044 <span class="comment">*                     80  norad</span>
<a name="l00045"></a>00045 <span class="comment">*                           original baseline</span>
<a name="l00046"></a>00046 <span class="comment">*       ----------------------------------------------------------------      */</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#pragma warning ( disable : 4996 )              //fopenエラー回避</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="sgp4unit_8h.html" title="NJHILSから持ってきた軌道計算関係モジュールを，sgp4名前空間でラップして使用．">sgp4unit.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="sgp4unit_8cpp.html#afc82212f442ea24d50fc0e52fbfcafd0">00053</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="sgp4unit_8cpp.html#afc82212f442ea24d50fc0e52fbfcafd0">help</a> = <span class="charliteral">&#39;n&#39;</span>;
<a name="l00054"></a><a class="code" href="sgp4unit_8cpp.html#acc82048058003f0e517f9a8c503ae89a">00054</a> FILE *<a class="code" href="sgp4unit_8cpp.html#acc82048058003f0e517f9a8c503ae89a">dbgfile</a>;
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">00056</a> <span class="preprocessor">#define pi 3.14159265358979323846</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 <span class="keyword">namespace </span><a class="code" href="namespacesgp4.html#adee1a80d66854d4af45c2a24df69a594">sgp4</a> {
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">/* ----------- local functions - only ever used internally by sgp4 ---------- */</span>
<a name="l00061"></a>00061 <span class="keyword">static</span> <span class="keywordtype">void</span> dpper
<a name="l00062"></a>00062      (
<a name="l00063"></a>00063        <span class="keywordtype">double</span> e3,     <span class="keywordtype">double</span> ee2,    <span class="keywordtype">double</span> peo,     <span class="keywordtype">double</span> pgho,   <span class="keywordtype">double</span> pho,
<a name="l00064"></a>00064        <span class="keywordtype">double</span> pinco,  <span class="keywordtype">double</span> plo,    <span class="keywordtype">double</span> se2,     <span class="keywordtype">double</span> se3,    <span class="keywordtype">double</span> sgh2,
<a name="l00065"></a>00065        <span class="keywordtype">double</span> sgh3,   <span class="keywordtype">double</span> sgh4,   <span class="keywordtype">double</span> sh2,     <span class="keywordtype">double</span> sh3,    <span class="keywordtype">double</span> si2,
<a name="l00066"></a>00066        <span class="keywordtype">double</span> si3,    <span class="keywordtype">double</span> sl2,    <span class="keywordtype">double</span> sl3,     <span class="keywordtype">double</span> sl4,    <span class="keywordtype">double</span> t,
<a name="l00067"></a>00067        <span class="keywordtype">double</span> xgh2,   <span class="keywordtype">double</span> xgh3,   <span class="keywordtype">double</span> xgh4,    <span class="keywordtype">double</span> xh2,    <span class="keywordtype">double</span> xh3,
<a name="l00068"></a>00068        <span class="keywordtype">double</span> xi2,    <span class="keywordtype">double</span> xi3,    <span class="keywordtype">double</span> xl2,     <span class="keywordtype">double</span> xl3,    <span class="keywordtype">double</span> xl4,
<a name="l00069"></a>00069        <span class="keywordtype">double</span> zmol,   <span class="keywordtype">double</span> zmos,   <span class="keywordtype">double</span> inclo,
<a name="l00070"></a>00070        <span class="keywordtype">char</span> init,
<a name="l00071"></a>00071        <span class="keywordtype">double</span>&amp; ep,    <span class="keywordtype">double</span>&amp; inclp, <span class="keywordtype">double</span>&amp; nodep,  <span class="keywordtype">double</span>&amp; argpp, <span class="keywordtype">double</span>&amp; mp
<a name="l00072"></a>00072      );
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="keyword">static</span> <span class="keywordtype">void</span> dscom
<a name="l00075"></a>00075      (
<a name="l00076"></a>00076        <span class="keywordtype">double</span> epoch,  <span class="keywordtype">double</span> ep,     <span class="keywordtype">double</span> argpp,   <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> inclp,
<a name="l00077"></a>00077        <span class="keywordtype">double</span> nodep,  <span class="keywordtype">double</span> np,
<a name="l00078"></a>00078        <span class="keywordtype">double</span>&amp; snodm, <span class="keywordtype">double</span>&amp; cnodm, <span class="keywordtype">double</span>&amp; sinim,  <span class="keywordtype">double</span>&amp; cosim, <span class="keywordtype">double</span>&amp; sinomm,
<a name="l00079"></a>00079        <span class="keywordtype">double</span>&amp; cosomm, <span class="keywordtype">double</span>&amp; day,   <span class="keywordtype">double</span>&amp; e3,     <span class="keywordtype">double</span>&amp; ee2,   <span class="keywordtype">double</span>&amp; em,
<a name="l00080"></a>00080        <span class="keywordtype">double</span>&amp; emsq,  <span class="keywordtype">double</span>&amp; gam,   <span class="keywordtype">double</span>&amp; peo,    <span class="keywordtype">double</span>&amp; pgho,  <span class="keywordtype">double</span>&amp; pho,
<a name="l00081"></a>00081        <span class="keywordtype">double</span>&amp; pinco, <span class="keywordtype">double</span>&amp; plo,   <span class="keywordtype">double</span>&amp; rtemsq, <span class="keywordtype">double</span>&amp; se2,   <span class="keywordtype">double</span>&amp; se3,
<a name="l00082"></a>00082        <span class="keywordtype">double</span>&amp; sgh2,  <span class="keywordtype">double</span>&amp; sgh3,  <span class="keywordtype">double</span>&amp; sgh4,   <span class="keywordtype">double</span>&amp; sh2,   <span class="keywordtype">double</span>&amp; sh3,
<a name="l00083"></a>00083        <span class="keywordtype">double</span>&amp; si2,   <span class="keywordtype">double</span>&amp; si3,   <span class="keywordtype">double</span>&amp; sl2,    <span class="keywordtype">double</span>&amp; sl3,   <span class="keywordtype">double</span>&amp; sl4,
<a name="l00084"></a>00084        <span class="keywordtype">double</span>&amp; s1,    <span class="keywordtype">double</span>&amp; s2,    <span class="keywordtype">double</span>&amp; s3,     <span class="keywordtype">double</span>&amp; s4,    <span class="keywordtype">double</span>&amp; s5,
<a name="l00085"></a>00085        <span class="keywordtype">double</span>&amp; s6,    <span class="keywordtype">double</span>&amp; s7,    <span class="keywordtype">double</span>&amp; ss1,    <span class="keywordtype">double</span>&amp; ss2,   <span class="keywordtype">double</span>&amp; ss3,
<a name="l00086"></a>00086        <span class="keywordtype">double</span>&amp; ss4,   <span class="keywordtype">double</span>&amp; ss5,   <span class="keywordtype">double</span>&amp; ss6,    <span class="keywordtype">double</span>&amp; ss7,   <span class="keywordtype">double</span>&amp; sz1,
<a name="l00087"></a>00087        <span class="keywordtype">double</span>&amp; sz2,   <span class="keywordtype">double</span>&amp; sz3,   <span class="keywordtype">double</span>&amp; sz11,   <span class="keywordtype">double</span>&amp; sz12,  <span class="keywordtype">double</span>&amp; sz13,
<a name="l00088"></a>00088        <span class="keywordtype">double</span>&amp; sz21,  <span class="keywordtype">double</span>&amp; sz22,  <span class="keywordtype">double</span>&amp; sz23,   <span class="keywordtype">double</span>&amp; sz31,  <span class="keywordtype">double</span>&amp; sz32,
<a name="l00089"></a>00089        <span class="keywordtype">double</span>&amp; sz33,  <span class="keywordtype">double</span>&amp; xgh2,  <span class="keywordtype">double</span>&amp; xgh3,   <span class="keywordtype">double</span>&amp; xgh4,  <span class="keywordtype">double</span>&amp; xh2,
<a name="l00090"></a>00090        <span class="keywordtype">double</span>&amp; xh3,   <span class="keywordtype">double</span>&amp; xi2,   <span class="keywordtype">double</span>&amp; xi3,    <span class="keywordtype">double</span>&amp; xl2,   <span class="keywordtype">double</span>&amp; xl3,
<a name="l00091"></a>00091        <span class="keywordtype">double</span>&amp; xl4,   <span class="keywordtype">double</span>&amp; nm,    <span class="keywordtype">double</span>&amp; z1,     <span class="keywordtype">double</span>&amp; z2,    <span class="keywordtype">double</span>&amp; z3,
<a name="l00092"></a>00092        <span class="keywordtype">double</span>&amp; z11,   <span class="keywordtype">double</span>&amp; z12,   <span class="keywordtype">double</span>&amp; z13,    <span class="keywordtype">double</span>&amp; z21,   <span class="keywordtype">double</span>&amp; z22,
<a name="l00093"></a>00093        <span class="keywordtype">double</span>&amp; z23,   <span class="keywordtype">double</span>&amp; z31,   <span class="keywordtype">double</span>&amp; z32,    <span class="keywordtype">double</span>&amp; z33,   <span class="keywordtype">double</span>&amp; zmol,
<a name="l00094"></a>00094        <span class="keywordtype">double</span>&amp; zmos
<a name="l00095"></a>00095      );
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="keyword">static</span> <span class="keywordtype">void</span> dsinit
<a name="l00098"></a>00098      (
<a name="l00099"></a>00099        <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,
<a name="l00100"></a>00100        <span class="keywordtype">double</span> cosim,  <span class="keywordtype">double</span> emsq,   <span class="keywordtype">double</span> argpo,   <span class="keywordtype">double</span> s1,     <span class="keywordtype">double</span> s2,
<a name="l00101"></a>00101        <span class="keywordtype">double</span> s3,     <span class="keywordtype">double</span> s4,     <span class="keywordtype">double</span> s5,      <span class="keywordtype">double</span> sinim,  <span class="keywordtype">double</span> ss1,
<a name="l00102"></a>00102        <span class="keywordtype">double</span> ss2,    <span class="keywordtype">double</span> ss3,    <span class="keywordtype">double</span> ss4,     <span class="keywordtype">double</span> ss5,    <span class="keywordtype">double</span> sz1,
<a name="l00103"></a>00103        <span class="keywordtype">double</span> sz3,    <span class="keywordtype">double</span> sz11,   <span class="keywordtype">double</span> sz13,    <span class="keywordtype">double</span> sz21,   <span class="keywordtype">double</span> sz23,
<a name="l00104"></a>00104        <span class="keywordtype">double</span> sz31,   <span class="keywordtype">double</span> sz33,   <span class="keywordtype">double</span> t,       <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> gsto,
<a name="l00105"></a>00105        <span class="keywordtype">double</span> mo,     <span class="keywordtype">double</span> mdot,   <span class="keywordtype">double</span> no,      <span class="keywordtype">double</span> nodeo,  <span class="keywordtype">double</span> nodedot,
<a name="l00106"></a>00106        <span class="keywordtype">double</span> xpidot, <span class="keywordtype">double</span> z1,     <span class="keywordtype">double</span> z3,      <span class="keywordtype">double</span> z11,    <span class="keywordtype">double</span> z13,
<a name="l00107"></a>00107        <span class="keywordtype">double</span> z21,    <span class="keywordtype">double</span> z23,    <span class="keywordtype">double</span> z31,     <span class="keywordtype">double</span> z33,    <span class="keywordtype">double</span> ecco,
<a name="l00108"></a>00108        <span class="keywordtype">double</span> eccsq,  <span class="keywordtype">double</span>&amp; em,    <span class="keywordtype">double</span>&amp; argpm,  <span class="keywordtype">double</span>&amp; inclm, <span class="keywordtype">double</span>&amp; mm,
<a name="l00109"></a>00109        <span class="keywordtype">double</span>&amp; nm,    <span class="keywordtype">double</span>&amp; nodem,
<a name="l00110"></a>00110        <span class="keywordtype">int</span>&amp; irez,
<a name="l00111"></a>00111        <span class="keywordtype">double</span>&amp; atime, <span class="keywordtype">double</span>&amp; d2201, <span class="keywordtype">double</span>&amp; d2211,  <span class="keywordtype">double</span>&amp; d3210, <span class="keywordtype">double</span>&amp; d3222,
<a name="l00112"></a>00112        <span class="keywordtype">double</span>&amp; d4410, <span class="keywordtype">double</span>&amp; d4422, <span class="keywordtype">double</span>&amp; d5220,  <span class="keywordtype">double</span>&amp; d5232, <span class="keywordtype">double</span>&amp; d5421,
<a name="l00113"></a>00113        <span class="keywordtype">double</span>&amp; d5433, <span class="keywordtype">double</span>&amp; dedt,  <span class="keywordtype">double</span>&amp; didt,   <span class="keywordtype">double</span>&amp; dmdt,  <span class="keywordtype">double</span>&amp; dndt,
<a name="l00114"></a>00114        <span class="keywordtype">double</span>&amp; dnodt, <span class="keywordtype">double</span>&amp; domdt, <span class="keywordtype">double</span>&amp; del1,   <span class="keywordtype">double</span>&amp; del2,  <span class="keywordtype">double</span>&amp; del3,
<a name="l00115"></a>00115        <span class="keywordtype">double</span>&amp; xfact, <span class="keywordtype">double</span>&amp; xlamo, <span class="keywordtype">double</span>&amp; xli,    <span class="keywordtype">double</span>&amp; xni
<a name="l00116"></a>00116      );
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="keyword">static</span> <span class="keywordtype">void</span> dspace
<a name="l00119"></a>00119      (
<a name="l00120"></a>00120        <span class="keywordtype">int</span> irez,
<a name="l00121"></a>00121        <span class="keywordtype">double</span> d2201,  <span class="keywordtype">double</span> d2211,  <span class="keywordtype">double</span> d3210,   <span class="keywordtype">double</span> d3222,  <span class="keywordtype">double</span> d4410,
<a name="l00122"></a>00122        <span class="keywordtype">double</span> d4422,  <span class="keywordtype">double</span> d5220,  <span class="keywordtype">double</span> d5232,   <span class="keywordtype">double</span> d5421,  <span class="keywordtype">double</span> d5433,
<a name="l00123"></a>00123        <span class="keywordtype">double</span> dedt,   <span class="keywordtype">double</span> del1,   <span class="keywordtype">double</span> del2,    <span class="keywordtype">double</span> del3,   <span class="keywordtype">double</span> didt,
<a name="l00124"></a>00124        <span class="keywordtype">double</span> dmdt,   <span class="keywordtype">double</span> dnodt,  <span class="keywordtype">double</span> domdt,   <span class="keywordtype">double</span> argpo,  <span class="keywordtype">double</span> argpdot,
<a name="l00125"></a>00125        <span class="keywordtype">double</span> t,      <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> gsto,    <span class="keywordtype">double</span> xfact,  <span class="keywordtype">double</span> xlamo,
<a name="l00126"></a>00126        <span class="keywordtype">double</span> no,
<a name="l00127"></a>00127        <span class="keywordtype">double</span>&amp; atime, <span class="keywordtype">double</span>&amp; em,    <span class="keywordtype">double</span>&amp; argpm,  <span class="keywordtype">double</span>&amp; inclm, <span class="keywordtype">double</span>&amp; xli,
<a name="l00128"></a>00128        <span class="keywordtype">double</span>&amp; mm,    <span class="keywordtype">double</span>&amp; xni,   <span class="keywordtype">double</span>&amp; nodem,  <span class="keywordtype">double</span>&amp; dndt,  <span class="keywordtype">double</span>&amp; nm
<a name="l00129"></a>00129      );
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keyword">static</span> <span class="keywordtype">void</span> initl
<a name="l00132"></a>00132      (
<a name="l00133"></a>00133        <span class="keywordtype">int</span> satn,      <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,
<a name="l00134"></a>00134        <span class="keywordtype">double</span> ecco,   <span class="keywordtype">double</span> epoch,  <span class="keywordtype">double</span> inclo,   <span class="keywordtype">double</span>&amp; no,
<a name="l00135"></a>00135        <span class="keywordtype">char</span>&amp; method,
<a name="l00136"></a>00136        <span class="keywordtype">double</span>&amp; ainv,  <span class="keywordtype">double</span>&amp; ao,    <span class="keywordtype">double</span>&amp; con41,  <span class="keywordtype">double</span>&amp; con42, <span class="keywordtype">double</span>&amp; cosio,
<a name="l00137"></a>00137        <span class="keywordtype">double</span>&amp; cosio2, <span class="keywordtype">double</span>&amp; eccsq, <span class="keywordtype">double</span>&amp; omeosq, <span class="keywordtype">double</span>&amp; posq,
<a name="l00138"></a>00138        <span class="keywordtype">double</span>&amp; <a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>,    <span class="keywordtype">double</span>&amp; rteosq, <span class="keywordtype">double</span>&amp; sinio , <span class="keywordtype">double</span>&amp; gsto
<a name="l00139"></a>00139      );
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00142"></a>00142 <span class="comment">*</span>
<a name="l00143"></a>00143 <span class="comment">*                           procedure dpper</span>
<a name="l00144"></a>00144 <span class="comment">*</span>
<a name="l00145"></a>00145 <span class="comment">*  this procedure provides deep space long period periodic contributions</span>
<a name="l00146"></a>00146 <span class="comment">*    to the mean elements.  by design, these periodics are zero at epoch.</span>
<a name="l00147"></a>00147 <span class="comment">*    this used to be dscom which included initialization, but it&#39;s really a</span>
<a name="l00148"></a>00148 <span class="comment">*    recurring function.</span>
<a name="l00149"></a>00149 <span class="comment">*</span>
<a name="l00150"></a>00150 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l00151"></a>00151 <span class="comment">*</span>
<a name="l00152"></a>00152 <span class="comment">*  inputs        :</span>
<a name="l00153"></a>00153 <span class="comment">*    e3          -</span>
<a name="l00154"></a>00154 <span class="comment">*    ee2         -</span>
<a name="l00155"></a>00155 <span class="comment">*    peo         -</span>
<a name="l00156"></a>00156 <span class="comment">*    pgho        -</span>
<a name="l00157"></a>00157 <span class="comment">*    pho         -</span>
<a name="l00158"></a>00158 <span class="comment">*    pinco       -</span>
<a name="l00159"></a>00159 <span class="comment">*    plo         -</span>
<a name="l00160"></a>00160 <span class="comment">*    se2 , se3 , sgh2, sgh3, sgh4, sh2, sh3, si2, si3, sl2, sl3, sl4 -</span>
<a name="l00161"></a>00161 <span class="comment">*    t           -</span>
<a name="l00162"></a>00162 <span class="comment">*    xh2, xh3, xi2, xi3, xl2, xl3, xl4 -</span>
<a name="l00163"></a>00163 <span class="comment">*    zmol        -</span>
<a name="l00164"></a>00164 <span class="comment">*    zmos        -</span>
<a name="l00165"></a>00165 <span class="comment">*    ep          - eccentricity                           0.0 - 1.0</span>
<a name="l00166"></a>00166 <span class="comment">*    inclo       - inclination - needed for lyddane modification</span>
<a name="l00167"></a>00167 <span class="comment">*    nodep       - right ascension of ascending node</span>
<a name="l00168"></a>00168 <span class="comment">*    argpp       - argument of perigee</span>
<a name="l00169"></a>00169 <span class="comment">*    mp          - mean anomaly</span>
<a name="l00170"></a>00170 <span class="comment">*</span>
<a name="l00171"></a>00171 <span class="comment">*  outputs       :</span>
<a name="l00172"></a>00172 <span class="comment">*    ep          - eccentricity                           0.0 - 1.0</span>
<a name="l00173"></a>00173 <span class="comment">*    inclp       - inclination</span>
<a name="l00174"></a>00174 <span class="comment">*    nodep        - right ascension of ascending node</span>
<a name="l00175"></a>00175 <span class="comment">*    argpp       - argument of perigee</span>
<a name="l00176"></a>00176 <span class="comment">*    mp          - mean anomaly</span>
<a name="l00177"></a>00177 <span class="comment">*</span>
<a name="l00178"></a>00178 <span class="comment">*  locals        :</span>
<a name="l00179"></a>00179 <span class="comment">*    alfdp       -</span>
<a name="l00180"></a>00180 <span class="comment">*    betdp       -</span>
<a name="l00181"></a>00181 <span class="comment">*    cosip  , sinip  , cosop  , sinop  ,</span>
<a name="l00182"></a>00182 <span class="comment">*    dalf        -</span>
<a name="l00183"></a>00183 <span class="comment">*    dbet        -</span>
<a name="l00184"></a>00184 <span class="comment">*    dls         -</span>
<a name="l00185"></a>00185 <span class="comment">*    f2, f3      -</span>
<a name="l00186"></a>00186 <span class="comment">*    pe          -</span>
<a name="l00187"></a>00187 <span class="comment">*    pgh         -</span>
<a name="l00188"></a>00188 <span class="comment">*    ph          -</span>
<a name="l00189"></a>00189 <span class="comment">*    pinc        -</span>
<a name="l00190"></a>00190 <span class="comment">*    pl          -</span>
<a name="l00191"></a>00191 <span class="comment">*    sel   , ses   , sghl  , sghs  , shl   , shs   , sil   , sinzf , sis   ,</span>
<a name="l00192"></a>00192 <span class="comment">*    sll   , sls</span>
<a name="l00193"></a>00193 <span class="comment">*    xls         -</span>
<a name="l00194"></a>00194 <span class="comment">*    xnoh        -</span>
<a name="l00195"></a>00195 <span class="comment">*    zf          -</span>
<a name="l00196"></a>00196 <span class="comment">*    zm          -</span>
<a name="l00197"></a>00197 <span class="comment">*</span>
<a name="l00198"></a>00198 <span class="comment">*  coupling      :</span>
<a name="l00199"></a>00199 <span class="comment">*    none.</span>
<a name="l00200"></a>00200 <span class="comment">*</span>
<a name="l00201"></a>00201 <span class="comment">*  references    :</span>
<a name="l00202"></a>00202 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00203"></a>00203 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l00204"></a>00204 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l00205"></a>00205 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l00206"></a>00206 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="keyword">static</span> <span class="keywordtype">void</span> dpper
<a name="l00209"></a>00209      (
<a name="l00210"></a>00210        <span class="keywordtype">double</span> e3,     <span class="keywordtype">double</span> ee2,    <span class="keywordtype">double</span> peo,     <span class="keywordtype">double</span> pgho,   <span class="keywordtype">double</span> pho,
<a name="l00211"></a>00211        <span class="keywordtype">double</span> pinco,  <span class="keywordtype">double</span> plo,    <span class="keywordtype">double</span> se2,     <span class="keywordtype">double</span> se3,    <span class="keywordtype">double</span> sgh2,
<a name="l00212"></a>00212        <span class="keywordtype">double</span> sgh3,   <span class="keywordtype">double</span> sgh4,   <span class="keywordtype">double</span> sh2,     <span class="keywordtype">double</span> sh3,    <span class="keywordtype">double</span> si2,
<a name="l00213"></a>00213        <span class="keywordtype">double</span> si3,    <span class="keywordtype">double</span> sl2,    <span class="keywordtype">double</span> sl3,     <span class="keywordtype">double</span> sl4,    <span class="keywordtype">double</span> t,
<a name="l00214"></a>00214        <span class="keywordtype">double</span> xgh2,   <span class="keywordtype">double</span> xgh3,   <span class="keywordtype">double</span> xgh4,    <span class="keywordtype">double</span> xh2,    <span class="keywordtype">double</span> xh3,
<a name="l00215"></a>00215        <span class="keywordtype">double</span> xi2,    <span class="keywordtype">double</span> xi3,    <span class="keywordtype">double</span> xl2,     <span class="keywordtype">double</span> xl3,    <span class="keywordtype">double</span> xl4,
<a name="l00216"></a>00216        <span class="keywordtype">double</span> zmol,   <span class="keywordtype">double</span> zmos,   <span class="keywordtype">double</span> inclo,
<a name="l00217"></a>00217        <span class="keywordtype">char</span> init,
<a name="l00218"></a>00218        <span class="keywordtype">double</span>&amp; ep,    <span class="keywordtype">double</span>&amp; inclp, <span class="keywordtype">double</span>&amp; nodep,  <span class="keywordtype">double</span>&amp; argpp, <span class="keywordtype">double</span>&amp; mp
<a name="l00219"></a>00219      )
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221      <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00222"></a>00222      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l00223"></a>00223      <span class="keywordtype">double</span> alfdp, betdp, cosip, cosop, dalf, dbet, dls,
<a name="l00224"></a>00224           f2,    f3,    pe,    pgh,   ph,   pinc, pl ,
<a name="l00225"></a>00225           sel,   ses,   sghl,  sghs,  shll, shs,  sil,
<a name="l00226"></a>00226           sinip, sinop, sinzf, sis,   sll,  sls,  xls,
<a name="l00227"></a>00227           xnoh,  zf,    zm,    zel,   zes,  znl,  zns;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229      <span class="comment">/* ---------------------- constants ----------------------------- */</span>
<a name="l00230"></a>00230      zns   = 1.19459e-5;
<a name="l00231"></a>00231      zes   = 0.01675;
<a name="l00232"></a>00232      znl   = 1.5835218e-4;
<a name="l00233"></a>00233      zel   = 0.05490;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235      <span class="comment">/* --------------- calculate time varying periodics ----------- */</span>
<a name="l00236"></a>00236      zm    = zmos + zns * t;
<a name="l00237"></a>00237      <span class="comment">// be sure that the initial call has time set to zero</span>
<a name="l00238"></a>00238      <span class="keywordflow">if</span> (init == <span class="charliteral">&#39;y&#39;</span>)
<a name="l00239"></a>00239          zm = zmos;
<a name="l00240"></a>00240      zf    = zm + 2.0 * zes * sin(zm);
<a name="l00241"></a>00241      sinzf = sin(zf);
<a name="l00242"></a>00242      f2    =  0.5 * sinzf * sinzf - 0.25;
<a name="l00243"></a>00243      f3    = -0.5 * sinzf * cos(zf);
<a name="l00244"></a>00244      ses   = se2* f2 + se3 * f3;
<a name="l00245"></a>00245      sis   = si2 * f2 + si3 * f3;
<a name="l00246"></a>00246      sls   = sl2 * f2 + sl3 * f3 + sl4 * sinzf;
<a name="l00247"></a>00247      sghs  = sgh2 * f2 + sgh3 * f3 + sgh4 * sinzf;
<a name="l00248"></a>00248      shs   = sh2 * f2 + sh3 * f3;
<a name="l00249"></a>00249      zm    = zmol + znl * t;
<a name="l00250"></a>00250      <span class="keywordflow">if</span> (init == <span class="charliteral">&#39;y&#39;</span>)
<a name="l00251"></a>00251          zm = zmol;
<a name="l00252"></a>00252      zf    = zm + 2.0 * zel * sin(zm);
<a name="l00253"></a>00253      sinzf = sin(zf);
<a name="l00254"></a>00254      f2    =  0.5 * sinzf * sinzf - 0.25;
<a name="l00255"></a>00255      f3    = -0.5 * sinzf * cos(zf);
<a name="l00256"></a>00256      sel   = ee2 * f2 + e3 * f3;
<a name="l00257"></a>00257      sil   = xi2 * f2 + xi3 * f3;
<a name="l00258"></a>00258      sll   = xl2 * f2 + xl3 * f3 + xl4 * sinzf;
<a name="l00259"></a>00259      sghl  = xgh2 * f2 + xgh3 * f3 + xgh4 * sinzf;
<a name="l00260"></a>00260      shll  = xh2 * f2 + xh3 * f3;
<a name="l00261"></a>00261      pe    = ses + sel;
<a name="l00262"></a>00262      pinc  = sis + sil;
<a name="l00263"></a>00263      pl    = sls + sll;
<a name="l00264"></a>00264      pgh   = sghs + sghl;
<a name="l00265"></a>00265      ph    = shs + shll;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267      <span class="keywordflow">if</span> (init == <span class="charliteral">&#39;n&#39;</span>)
<a name="l00268"></a>00268        {
<a name="l00269"></a>00269        pe    = pe - peo;
<a name="l00270"></a>00270        pinc  = pinc - pinco;
<a name="l00271"></a>00271        pl    = pl - plo;
<a name="l00272"></a>00272        pgh   = pgh - pgho;
<a name="l00273"></a>00273        ph    = ph - pho;
<a name="l00274"></a>00274        inclp = inclp + pinc;
<a name="l00275"></a>00275        ep    = ep + pe;
<a name="l00276"></a>00276        sinip = sin(inclp);
<a name="l00277"></a>00277        cosip = cos(inclp);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279        <span class="comment">/* ----------------- apply periodics directly ------------ */</span>
<a name="l00280"></a>00280        <span class="comment">//  sgp4fix for lyddane choice</span>
<a name="l00281"></a>00281        <span class="comment">//  strn3 used original inclination - this is technically feasible</span>
<a name="l00282"></a>00282        <span class="comment">//  gsfc used perturbed inclination - also technically feasible</span>
<a name="l00283"></a>00283        <span class="comment">//  probably best to readjust the 0.2 limit value and limit discontinuity</span>
<a name="l00284"></a>00284        <span class="comment">//  0.2 rad = 11.45916 deg</span>
<a name="l00285"></a>00285        <span class="comment">//  use next line for original strn3 approach and original inclination</span>
<a name="l00286"></a>00286        <span class="comment">//  if (inclo &gt;= 0.2)</span>
<a name="l00287"></a>00287        <span class="comment">//  use next line for gsfc version and perturbed inclination</span>
<a name="l00288"></a>00288        <span class="keywordflow">if</span> (inclp &gt;= 0.2)
<a name="l00289"></a>00289          {
<a name="l00290"></a>00290            ph     = ph / sinip;
<a name="l00291"></a>00291            pgh    = pgh - cosip * ph;
<a name="l00292"></a>00292            argpp  = argpp + pgh;
<a name="l00293"></a>00293            nodep  = nodep + ph;
<a name="l00294"></a>00294            mp     = mp + pl;
<a name="l00295"></a>00295          }
<a name="l00296"></a>00296          <span class="keywordflow">else</span>
<a name="l00297"></a>00297          {
<a name="l00298"></a>00298            <span class="comment">/* ---- apply periodics with lyddane modification ---- */</span>
<a name="l00299"></a>00299            sinop  = sin(nodep);
<a name="l00300"></a>00300            cosop  = cos(nodep);
<a name="l00301"></a>00301            alfdp  = sinip * sinop;
<a name="l00302"></a>00302            betdp  = sinip * cosop;
<a name="l00303"></a>00303            dalf   =  ph * cosop + pinc * cosip * sinop;
<a name="l00304"></a>00304            dbet   = -ph * sinop + pinc * cosip * cosop;
<a name="l00305"></a>00305            alfdp  = alfdp + dalf;
<a name="l00306"></a>00306            betdp  = betdp + dbet;
<a name="l00307"></a>00307            nodep  = fmod(nodep, twopi);
<a name="l00308"></a>00308            <span class="comment">//  sgp4fix for afspc written intrinsic functions</span>
<a name="l00309"></a>00309            <span class="comment">// nodep used without a trigonometric function ahead</span>
<a name="l00310"></a>00310            <span class="keywordflow">if</span> (nodep &lt; 0.0)
<a name="l00311"></a>00311                nodep = nodep + twopi;
<a name="l00312"></a>00312            xls    = mp + argpp + cosip * nodep;
<a name="l00313"></a>00313            dls    = pl + pgh - pinc * nodep * sinip;
<a name="l00314"></a>00314            xls    = xls + dls;
<a name="l00315"></a>00315            xnoh   = nodep;
<a name="l00316"></a>00316            nodep  = atan2(alfdp, betdp);
<a name="l00317"></a>00317            <span class="comment">//  sgp4fix for afspc written intrinsic functions</span>
<a name="l00318"></a>00318            <span class="comment">// nodep used without a trigonometric function ahead</span>
<a name="l00319"></a>00319            <span class="keywordflow">if</span> (nodep &lt; 0.0)
<a name="l00320"></a>00320                nodep = nodep + twopi;
<a name="l00321"></a>00321            <span class="keywordflow">if</span> (fabs(xnoh - nodep) &gt; <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>)
<a name="l00322"></a>00322              <span class="keywordflow">if</span> (nodep &lt; xnoh)
<a name="l00323"></a>00323                 nodep = nodep + twopi;
<a name="l00324"></a>00324                <span class="keywordflow">else</span>
<a name="l00325"></a>00325                 nodep = nodep - twopi;
<a name="l00326"></a>00326            mp    = mp + pl;
<a name="l00327"></a>00327            argpp = xls - mp - cosip * nodep;
<a name="l00328"></a>00328          }
<a name="l00329"></a>00329        }   <span class="comment">// if init == &#39;n&#39;</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 <span class="comment">//#include &quot;debug1.cpp&quot;</span>
<a name="l00332"></a>00332 }  <span class="comment">// end dpper</span>
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l00335"></a>00335 <span class="comment">*</span>
<a name="l00336"></a>00336 <span class="comment">*                           procedure dscom</span>
<a name="l00337"></a>00337 <span class="comment">*</span>
<a name="l00338"></a>00338 <span class="comment">*  this procedure provides deep space common items used by both the secular</span>
<a name="l00339"></a>00339 <span class="comment">*    and periodics subroutines.  input is provided as shown. this routine</span>
<a name="l00340"></a>00340 <span class="comment">*    used to be called dpper, but the functions inside weren&#39;t well organized.</span>
<a name="l00341"></a>00341 <span class="comment">*</span>
<a name="l00342"></a>00342 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l00343"></a>00343 <span class="comment">*</span>
<a name="l00344"></a>00344 <span class="comment">*  inputs        :</span>
<a name="l00345"></a>00345 <span class="comment">*    epoch       -</span>
<a name="l00346"></a>00346 <span class="comment">*    ep          - eccentricity</span>
<a name="l00347"></a>00347 <span class="comment">*    argpp       - argument of perigee</span>
<a name="l00348"></a>00348 <span class="comment">*    tc          -</span>
<a name="l00349"></a>00349 <span class="comment">*    inclp       - inclination</span>
<a name="l00350"></a>00350 <span class="comment">*    nodep       - right ascension of ascending node</span>
<a name="l00351"></a>00351 <span class="comment">*    np          - mean motion</span>
<a name="l00352"></a>00352 <span class="comment">*</span>
<a name="l00353"></a>00353 <span class="comment">*  outputs       :</span>
<a name="l00354"></a>00354 <span class="comment">*    sinim  , cosim  , sinomm , cosomm , snodm  , cnodm</span>
<a name="l00355"></a>00355 <span class="comment">*    day         -</span>
<a name="l00356"></a>00356 <span class="comment">*    e3          -</span>
<a name="l00357"></a>00357 <span class="comment">*    ee2         -</span>
<a name="l00358"></a>00358 <span class="comment">*    em          - eccentricity</span>
<a name="l00359"></a>00359 <span class="comment">*    emsq        - eccentricity squared</span>
<a name="l00360"></a>00360 <span class="comment">*    gam         -</span>
<a name="l00361"></a>00361 <span class="comment">*    peo         -</span>
<a name="l00362"></a>00362 <span class="comment">*    pgho        -</span>
<a name="l00363"></a>00363 <span class="comment">*    pho         -</span>
<a name="l00364"></a>00364 <span class="comment">*    pinco       -</span>
<a name="l00365"></a>00365 <span class="comment">*    plo         -</span>
<a name="l00366"></a>00366 <span class="comment">*    rtemsq      -</span>
<a name="l00367"></a>00367 <span class="comment">*    se2, se3         -</span>
<a name="l00368"></a>00368 <span class="comment">*    sgh2, sgh3, sgh4        -</span>
<a name="l00369"></a>00369 <span class="comment">*    sh2, sh3, si2, si3, sl2, sl3, sl4         -</span>
<a name="l00370"></a>00370 <span class="comment">*    s1, s2, s3, s4, s5, s6, s7          -</span>
<a name="l00371"></a>00371 <span class="comment">*    ss1, ss2, ss3, ss4, ss5, ss6, ss7, sz1, sz2, sz3         -</span>
<a name="l00372"></a>00372 <span class="comment">*    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -</span>
<a name="l00373"></a>00373 <span class="comment">*    xgh2, xgh3, xgh4, xh2, xh3, xi2, xi3, xl2, xl3, xl4         -</span>
<a name="l00374"></a>00374 <span class="comment">*    nm          - mean motion</span>
<a name="l00375"></a>00375 <span class="comment">*    z1, z2, z3, z11, z12, z13, z21, z22, z23, z31, z32, z33         -</span>
<a name="l00376"></a>00376 <span class="comment">*    zmol        -</span>
<a name="l00377"></a>00377 <span class="comment">*    zmos        -</span>
<a name="l00378"></a>00378 <span class="comment">*</span>
<a name="l00379"></a>00379 <span class="comment">*  locals        :</span>
<a name="l00380"></a>00380 <span class="comment">*    a1, a2, a3, a4, a5, a6, a7, a8, a9, a10         -</span>
<a name="l00381"></a>00381 <span class="comment">*    betasq      -</span>
<a name="l00382"></a>00382 <span class="comment">*    cc          -</span>
<a name="l00383"></a>00383 <span class="comment">*    ctem, stem        -</span>
<a name="l00384"></a>00384 <span class="comment">*    x1, x2, x3, x4, x5, x6, x7, x8          -</span>
<a name="l00385"></a>00385 <span class="comment">*    xnodce      -</span>
<a name="l00386"></a>00386 <span class="comment">*    xnoi        -</span>
<a name="l00387"></a>00387 <span class="comment">*    zcosg  , zsing  , zcosgl , zsingl , zcosh  , zsinh  , zcoshl , zsinhl ,</span>
<a name="l00388"></a>00388 <span class="comment">*    zcosi  , zsini  , zcosil , zsinil ,</span>
<a name="l00389"></a>00389 <span class="comment">*    zx          -</span>
<a name="l00390"></a>00390 <span class="comment">*    zy          -</span>
<a name="l00391"></a>00391 <span class="comment">*</span>
<a name="l00392"></a>00392 <span class="comment">*  coupling      :</span>
<a name="l00393"></a>00393 <span class="comment">*    none.</span>
<a name="l00394"></a>00394 <span class="comment">*</span>
<a name="l00395"></a>00395 <span class="comment">*  references    :</span>
<a name="l00396"></a>00396 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00397"></a>00397 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l00398"></a>00398 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l00399"></a>00399 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l00400"></a>00400 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="keyword">static</span> <span class="keywordtype">void</span> dscom
<a name="l00403"></a>00403      (
<a name="l00404"></a>00404        <span class="keywordtype">double</span> epoch,  <span class="keywordtype">double</span> ep,     <span class="keywordtype">double</span> argpp,   <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> inclp,
<a name="l00405"></a>00405        <span class="keywordtype">double</span> nodep,  <span class="keywordtype">double</span> np,
<a name="l00406"></a>00406        <span class="keywordtype">double</span>&amp; snodm, <span class="keywordtype">double</span>&amp; cnodm, <span class="keywordtype">double</span>&amp; sinim,  <span class="keywordtype">double</span>&amp; cosim, <span class="keywordtype">double</span>&amp; sinomm,
<a name="l00407"></a>00407        <span class="keywordtype">double</span>&amp; cosomm, <span class="keywordtype">double</span>&amp; day,   <span class="keywordtype">double</span>&amp; e3,     <span class="keywordtype">double</span>&amp; ee2,   <span class="keywordtype">double</span>&amp; em,
<a name="l00408"></a>00408        <span class="keywordtype">double</span>&amp; emsq,  <span class="keywordtype">double</span>&amp; gam,   <span class="keywordtype">double</span>&amp; peo,    <span class="keywordtype">double</span>&amp; pgho,  <span class="keywordtype">double</span>&amp; pho,
<a name="l00409"></a>00409        <span class="keywordtype">double</span>&amp; pinco, <span class="keywordtype">double</span>&amp; plo,   <span class="keywordtype">double</span>&amp; rtemsq, <span class="keywordtype">double</span>&amp; se2,   <span class="keywordtype">double</span>&amp; se3,
<a name="l00410"></a>00410        <span class="keywordtype">double</span>&amp; sgh2,  <span class="keywordtype">double</span>&amp; sgh3,  <span class="keywordtype">double</span>&amp; sgh4,   <span class="keywordtype">double</span>&amp; sh2,   <span class="keywordtype">double</span>&amp; sh3,
<a name="l00411"></a>00411        <span class="keywordtype">double</span>&amp; si2,   <span class="keywordtype">double</span>&amp; si3,   <span class="keywordtype">double</span>&amp; sl2,    <span class="keywordtype">double</span>&amp; sl3,   <span class="keywordtype">double</span>&amp; sl4,
<a name="l00412"></a>00412        <span class="keywordtype">double</span>&amp; s1,    <span class="keywordtype">double</span>&amp; s2,    <span class="keywordtype">double</span>&amp; s3,     <span class="keywordtype">double</span>&amp; s4,    <span class="keywordtype">double</span>&amp; s5,
<a name="l00413"></a>00413        <span class="keywordtype">double</span>&amp; s6,    <span class="keywordtype">double</span>&amp; s7,    <span class="keywordtype">double</span>&amp; ss1,    <span class="keywordtype">double</span>&amp; ss2,   <span class="keywordtype">double</span>&amp; ss3,
<a name="l00414"></a>00414        <span class="keywordtype">double</span>&amp; ss4,   <span class="keywordtype">double</span>&amp; ss5,   <span class="keywordtype">double</span>&amp; ss6,    <span class="keywordtype">double</span>&amp; ss7,   <span class="keywordtype">double</span>&amp; sz1,
<a name="l00415"></a>00415        <span class="keywordtype">double</span>&amp; sz2,   <span class="keywordtype">double</span>&amp; sz3,   <span class="keywordtype">double</span>&amp; sz11,   <span class="keywordtype">double</span>&amp; sz12,  <span class="keywordtype">double</span>&amp; sz13,
<a name="l00416"></a>00416        <span class="keywordtype">double</span>&amp; sz21,  <span class="keywordtype">double</span>&amp; sz22,  <span class="keywordtype">double</span>&amp; sz23,   <span class="keywordtype">double</span>&amp; sz31,  <span class="keywordtype">double</span>&amp; sz32,
<a name="l00417"></a>00417        <span class="keywordtype">double</span>&amp; sz33,  <span class="keywordtype">double</span>&amp; xgh2,  <span class="keywordtype">double</span>&amp; xgh3,   <span class="keywordtype">double</span>&amp; xgh4,  <span class="keywordtype">double</span>&amp; xh2,
<a name="l00418"></a>00418        <span class="keywordtype">double</span>&amp; xh3,   <span class="keywordtype">double</span>&amp; xi2,   <span class="keywordtype">double</span>&amp; xi3,    <span class="keywordtype">double</span>&amp; xl2,   <span class="keywordtype">double</span>&amp; xl3,
<a name="l00419"></a>00419        <span class="keywordtype">double</span>&amp; xl4,   <span class="keywordtype">double</span>&amp; nm,    <span class="keywordtype">double</span>&amp; z1,     <span class="keywordtype">double</span>&amp; z2,    <span class="keywordtype">double</span>&amp; z3,
<a name="l00420"></a>00420        <span class="keywordtype">double</span>&amp; z11,   <span class="keywordtype">double</span>&amp; z12,   <span class="keywordtype">double</span>&amp; z13,    <span class="keywordtype">double</span>&amp; z21,   <span class="keywordtype">double</span>&amp; z22,
<a name="l00421"></a>00421        <span class="keywordtype">double</span>&amp; z23,   <span class="keywordtype">double</span>&amp; z31,   <span class="keywordtype">double</span>&amp; z32,    <span class="keywordtype">double</span>&amp; z33,   <span class="keywordtype">double</span>&amp; zmol,
<a name="l00422"></a>00422        <span class="keywordtype">double</span>&amp; zmos
<a name="l00423"></a>00423      )
<a name="l00424"></a>00424 {
<a name="l00425"></a>00425      <span class="comment">/* -------------------------- constants ------------------------- */</span>
<a name="l00426"></a>00426      <span class="keyword">const</span> <span class="keywordtype">double</span> zes     =  0.01675;
<a name="l00427"></a>00427      <span class="keyword">const</span> <span class="keywordtype">double</span> zel     =  0.05490;
<a name="l00428"></a>00428      <span class="keyword">const</span> <span class="keywordtype">double</span> c1ss    =  2.9864797e-6;
<a name="l00429"></a>00429      <span class="keyword">const</span> <span class="keywordtype">double</span> c1l     =  4.7968065e-7;
<a name="l00430"></a>00430      <span class="keyword">const</span> <span class="keywordtype">double</span> zsinis  =  0.39785416;
<a name="l00431"></a>00431      <span class="keyword">const</span> <span class="keywordtype">double</span> zcosis  =  0.91744867;
<a name="l00432"></a>00432      <span class="keyword">const</span> <span class="keywordtype">double</span> zcosgs  =  0.1945905;
<a name="l00433"></a>00433      <span class="keyword">const</span> <span class="keywordtype">double</span> zsings  = -0.98088458;
<a name="l00434"></a>00434      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi   =  2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436      <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00437"></a>00437      <span class="keywordtype">int</span> lsflg;
<a name="l00438"></a>00438      <span class="keywordtype">double</span> a1    , a2    , a3    , a4    , a5    , a6    , a7    ,
<a name="l00439"></a>00439         a8    , a9    , a10   , betasq, cc    , ctem  , stem  ,
<a name="l00440"></a>00440         x1    , x2    , x3    , x4    , x5    , x6    , x7    ,
<a name="l00441"></a>00441         x8    , xnodce, xnoi  , zcosg , zcosgl, zcosh , zcoshl,
<a name="l00442"></a>00442         zcosi , zcosil, zsing , zsingl, zsinh , zsinhl, zsini ,
<a name="l00443"></a>00443         zsinil, zx    , zy;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445      nm     = np;
<a name="l00446"></a>00446      em     = ep;
<a name="l00447"></a>00447      snodm  = sin(nodep);
<a name="l00448"></a>00448      cnodm  = cos(nodep);
<a name="l00449"></a>00449      sinomm = sin(argpp);
<a name="l00450"></a>00450      cosomm = cos(argpp);
<a name="l00451"></a>00451      sinim  = sin(inclp);
<a name="l00452"></a>00452      cosim  = cos(inclp);
<a name="l00453"></a>00453      emsq   = em * em;
<a name="l00454"></a>00454      betasq = 1.0 - emsq;
<a name="l00455"></a>00455      rtemsq = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(betasq);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457      <span class="comment">/* ----------------- initialize lunar solar terms --------------- */</span>
<a name="l00458"></a>00458      peo    = 0.0;
<a name="l00459"></a>00459      pinco  = 0.0;
<a name="l00460"></a>00460      plo    = 0.0;
<a name="l00461"></a>00461      pgho   = 0.0;
<a name="l00462"></a>00462      pho    = 0.0;
<a name="l00463"></a>00463      day    = epoch + 18261.5 + tc / 1440.0;
<a name="l00464"></a>00464      xnodce = fmod(4.5236020 - 9.2422029e-4 * day, twopi);
<a name="l00465"></a>00465      stem   = sin(xnodce);
<a name="l00466"></a>00466      ctem   = cos(xnodce);
<a name="l00467"></a>00467      zcosil = 0.91375164 - 0.03568096 * ctem;
<a name="l00468"></a>00468      zsinil = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(1.0 - zcosil * zcosil);
<a name="l00469"></a>00469      zsinhl = 0.089683511 * stem / zsinil;
<a name="l00470"></a>00470      zcoshl = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(1.0 - zsinhl * zsinhl);
<a name="l00471"></a>00471      gam    = 5.8351514 + 0.0019443680 * day;
<a name="l00472"></a>00472      zx     = 0.39785416 * stem / zsinil;
<a name="l00473"></a>00473      zy     = zcoshl * ctem + 0.91744867 * zsinhl * stem;
<a name="l00474"></a>00474      zx     = atan2(zx, zy);
<a name="l00475"></a>00475      zx     = gam + zx - xnodce;
<a name="l00476"></a>00476      zcosgl = cos(zx);
<a name="l00477"></a>00477      zsingl = sin(zx);
<a name="l00478"></a>00478 
<a name="l00479"></a>00479      <span class="comment">/* ------------------------- do solar terms --------------------- */</span>
<a name="l00480"></a>00480      zcosg = zcosgs;
<a name="l00481"></a>00481      zsing = zsings;
<a name="l00482"></a>00482      zcosi = zcosis;
<a name="l00483"></a>00483      zsini = zsinis;
<a name="l00484"></a>00484      zcosh = cnodm;
<a name="l00485"></a>00485      zsinh = snodm;
<a name="l00486"></a>00486      cc    = c1ss;
<a name="l00487"></a>00487      xnoi  = 1.0 / nm;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489      <span class="keywordflow">for</span> (lsflg = 1; lsflg &lt;= 2; lsflg++)
<a name="l00490"></a>00490        {
<a name="l00491"></a>00491          a1  =   zcosg * zcosh + zsing * zcosi * zsinh;
<a name="l00492"></a>00492          a3  =  -zsing * zcosh + zcosg * zcosi * zsinh;
<a name="l00493"></a>00493          a7  =  -zcosg * zsinh + zsing * zcosi * zcosh;
<a name="l00494"></a>00494          a8  =   zsing * zsini;
<a name="l00495"></a>00495          a9  =   zsing * zsinh + zcosg * zcosi * zcosh;
<a name="l00496"></a>00496          a10 =   zcosg * zsini;
<a name="l00497"></a>00497          a2  =   cosim * a7 + sinim * a8;
<a name="l00498"></a>00498          a4  =   cosim * a9 + sinim * a10;
<a name="l00499"></a>00499          a5  =  -sinim * a7 + cosim * a8;
<a name="l00500"></a>00500          a6  =  -sinim * a9 + cosim * a10;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502          x1  =  a1 * cosomm + a2 * sinomm;
<a name="l00503"></a>00503          x2  =  a3 * cosomm + a4 * sinomm;
<a name="l00504"></a>00504          x3  = -a1 * sinomm + a2 * cosomm;
<a name="l00505"></a>00505          x4  = -a3 * sinomm + a4 * cosomm;
<a name="l00506"></a>00506          x5  =  a5 * sinomm;
<a name="l00507"></a>00507          x6  =  a6 * sinomm;
<a name="l00508"></a>00508          x7  =  a5 * cosomm;
<a name="l00509"></a>00509          x8  =  a6 * cosomm;
<a name="l00510"></a>00510 
<a name="l00511"></a>00511          z31 = 12.0 * x1 * x1 - 3.0 * x3 * x3;
<a name="l00512"></a>00512          z32 = 24.0 * x1 * x2 - 6.0 * x3 * x4;
<a name="l00513"></a>00513          z33 = 12.0 * x2 * x2 - 3.0 * x4 * x4;
<a name="l00514"></a>00514          z1  =  3.0 *  (a1 * a1 + a2 * a2) + z31 * emsq;
<a name="l00515"></a>00515          z2  =  6.0 *  (a1 * a3 + a2 * a4) + z32 * emsq;
<a name="l00516"></a>00516          z3  =  3.0 *  (a3 * a3 + a4 * a4) + z33 * emsq;
<a name="l00517"></a>00517          z11 = -6.0 * a1 * a5 + emsq *  (-24.0 * x1 * x7-6.0 * x3 * x5);
<a name="l00518"></a>00518          z12 = -6.0 *  (a1 * a6 + a3 * a5) + emsq *
<a name="l00519"></a>00519                 (-24.0 * (x2 * x7 + x1 * x8) - 6.0 * (x3 * x6 + x4 * x5));
<a name="l00520"></a>00520          z13 = -6.0 * a3 * a6 + emsq * (-24.0 * x2 * x8 - 6.0 * x4 * x6);
<a name="l00521"></a>00521          z21 =  6.0 * a2 * a5 + emsq * (24.0 * x1 * x5 - 6.0 * x3 * x7);
<a name="l00522"></a>00522          z22 =  6.0 *  (a4 * a5 + a2 * a6) + emsq *
<a name="l00523"></a>00523                 (24.0 * (x2 * x5 + x1 * x6) - 6.0 * (x4 * x7 + x3 * x8));
<a name="l00524"></a>00524          z23 =  6.0 * a4 * a6 + emsq * (24.0 * x2 * x6 - 6.0 * x4 * x8);
<a name="l00525"></a>00525          z1  = z1 + z1 + betasq * z31;
<a name="l00526"></a>00526          z2  = z2 + z2 + betasq * z32;
<a name="l00527"></a>00527          z3  = z3 + z3 + betasq * z33;
<a name="l00528"></a>00528          s3  = cc * xnoi;
<a name="l00529"></a>00529          s2  = -0.5 * s3 / rtemsq;
<a name="l00530"></a>00530          s4  = s3 * rtemsq;
<a name="l00531"></a>00531          s1  = -15.0 * em * s4;
<a name="l00532"></a>00532          s5  = x1 * x3 + x2 * x4;
<a name="l00533"></a>00533          s6  = x2 * x3 + x1 * x4;
<a name="l00534"></a>00534          s7  = x2 * x4 - x1 * x3;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536          <span class="comment">/* ----------------------- do lunar terms ------------------- */</span>
<a name="l00537"></a>00537          <span class="keywordflow">if</span> (lsflg == 1)
<a name="l00538"></a>00538            {
<a name="l00539"></a>00539              ss1   = s1;
<a name="l00540"></a>00540              ss2   = s2;
<a name="l00541"></a>00541              ss3   = s3;
<a name="l00542"></a>00542              ss4   = s4;
<a name="l00543"></a>00543              ss5   = s5;
<a name="l00544"></a>00544              ss6   = s6;
<a name="l00545"></a>00545              ss7   = s7;
<a name="l00546"></a>00546              sz1   = z1;
<a name="l00547"></a>00547              sz2   = z2;
<a name="l00548"></a>00548              sz3   = z3;
<a name="l00549"></a>00549              sz11  = z11;
<a name="l00550"></a>00550              sz12  = z12;
<a name="l00551"></a>00551              sz13  = z13;
<a name="l00552"></a>00552              sz21  = z21;
<a name="l00553"></a>00553              sz22  = z22;
<a name="l00554"></a>00554              sz23  = z23;
<a name="l00555"></a>00555              sz31  = z31;
<a name="l00556"></a>00556              sz32  = z32;
<a name="l00557"></a>00557              sz33  = z33;
<a name="l00558"></a>00558              zcosg = zcosgl;
<a name="l00559"></a>00559              zsing = zsingl;
<a name="l00560"></a>00560              zcosi = zcosil;
<a name="l00561"></a>00561              zsini = zsinil;
<a name="l00562"></a>00562              zcosh = zcoshl * cnodm + zsinhl * snodm;
<a name="l00563"></a>00563              zsinh = snodm * zcoshl - cnodm * zsinhl;
<a name="l00564"></a>00564              cc    = c1l;
<a name="l00565"></a>00565           }
<a name="l00566"></a>00566        }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568      zmol = fmod(4.7199672 + 0.22997150  * day - gam, twopi);
<a name="l00569"></a>00569      zmos = fmod(6.2565837 + 0.017201977 * day, twopi);
<a name="l00570"></a>00570 
<a name="l00571"></a>00571      <span class="comment">/* ------------------------ do solar terms ---------------------- */</span>
<a name="l00572"></a>00572      se2  =   2.0 * ss1 * ss6;
<a name="l00573"></a>00573      se3  =   2.0 * ss1 * ss7;
<a name="l00574"></a>00574      si2  =   2.0 * ss2 * sz12;
<a name="l00575"></a>00575      si3  =   2.0 * ss2 * (sz13 - sz11);
<a name="l00576"></a>00576      sl2  =  -2.0 * ss3 * sz2;
<a name="l00577"></a>00577      sl3  =  -2.0 * ss3 * (sz3 - sz1);
<a name="l00578"></a>00578      sl4  =  -2.0 * ss3 * (-21.0 - 9.0 * emsq) * zes;
<a name="l00579"></a>00579      sgh2 =   2.0 * ss4 * sz32;
<a name="l00580"></a>00580      sgh3 =   2.0 * ss4 * (sz33 - sz31);
<a name="l00581"></a>00581      sgh4 = -18.0 * ss4 * zes;
<a name="l00582"></a>00582      sh2  =  -2.0 * ss2 * sz22;
<a name="l00583"></a>00583      sh3  =  -2.0 * ss2 * (sz23 - sz21);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585      <span class="comment">/* ------------------------ do lunar terms ---------------------- */</span>
<a name="l00586"></a>00586      ee2  =   2.0 * s1 * s6;
<a name="l00587"></a>00587      e3   =   2.0 * s1 * s7;
<a name="l00588"></a>00588      xi2  =   2.0 * s2 * z12;
<a name="l00589"></a>00589      xi3  =   2.0 * s2 * (z13 - z11);
<a name="l00590"></a>00590      xl2  =  -2.0 * s3 * z2;
<a name="l00591"></a>00591      xl3  =  -2.0 * s3 * (z3 - z1);
<a name="l00592"></a>00592      xl4  =  -2.0 * s3 * (-21.0 - 9.0 * emsq) * zel;
<a name="l00593"></a>00593      xgh2 =   2.0 * s4 * z32;
<a name="l00594"></a>00594      xgh3 =   2.0 * s4 * (z33 - z31);
<a name="l00595"></a>00595      xgh4 = -18.0 * s4 * zel;
<a name="l00596"></a>00596      xh2  =  -2.0 * s2 * z22;
<a name="l00597"></a>00597      xh3  =  -2.0 * s2 * (z23 - z21);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="comment">//#include &quot;debug2.cpp&quot;</span>
<a name="l00600"></a>00600 }  <span class="comment">// end dscom</span>
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l00603"></a>00603 <span class="comment">*</span>
<a name="l00604"></a>00604 <span class="comment">*                           procedure dsinit</span>
<a name="l00605"></a>00605 <span class="comment">*</span>
<a name="l00606"></a>00606 <span class="comment">*  this procedure provides deep space contributions to mean motion dot due</span>
<a name="l00607"></a>00607 <span class="comment">*    to geopotential resonance with half day and one day orbits.</span>
<a name="l00608"></a>00608 <span class="comment">*</span>
<a name="l00609"></a>00609 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l00610"></a>00610 <span class="comment">*</span>
<a name="l00611"></a>00611 <span class="comment">*  inputs        :</span>
<a name="l00612"></a>00612 <span class="comment">*    cosim, sinim-</span>
<a name="l00613"></a>00613 <span class="comment">*    emsq        - eccentricity squared</span>
<a name="l00614"></a>00614 <span class="comment">*    argpo       - argument of perigee</span>
<a name="l00615"></a>00615 <span class="comment">*    s1, s2, s3, s4, s5      -</span>
<a name="l00616"></a>00616 <span class="comment">*    ss1, ss2, ss3, ss4, ss5 -</span>
<a name="l00617"></a>00617 <span class="comment">*    sz1, sz3, sz11, sz13, sz21, sz23, sz31, sz33 -</span>
<a name="l00618"></a>00618 <span class="comment">*    t           - time</span>
<a name="l00619"></a>00619 <span class="comment">*    tc          -</span>
<a name="l00620"></a>00620 <span class="comment">*    gsto        - greenwich sidereal time                   rad</span>
<a name="l00621"></a>00621 <span class="comment">*    mo          - mean anomaly</span>
<a name="l00622"></a>00622 <span class="comment">*    mdot        - mean anomaly dot (rate)</span>
<a name="l00623"></a>00623 <span class="comment">*    no          - mean motion</span>
<a name="l00624"></a>00624 <span class="comment">*    nodeo       - right ascension of ascending node</span>
<a name="l00625"></a>00625 <span class="comment">*    nodedot     - right ascension of ascending node dot (rate)</span>
<a name="l00626"></a>00626 <span class="comment">*    xpidot      -</span>
<a name="l00627"></a>00627 <span class="comment">*    z1, z3, z11, z13, z21, z23, z31, z33 -</span>
<a name="l00628"></a>00628 <span class="comment">*    eccm        - eccentricity</span>
<a name="l00629"></a>00629 <span class="comment">*    argpm       - argument of perigee</span>
<a name="l00630"></a>00630 <span class="comment">*    inclm       - inclination</span>
<a name="l00631"></a>00631 <span class="comment">*    mm          - mean anomaly</span>
<a name="l00632"></a>00632 <span class="comment">*    xn          - mean motion</span>
<a name="l00633"></a>00633 <span class="comment">*    nodem       - right ascension of ascending node</span>
<a name="l00634"></a>00634 <span class="comment">*</span>
<a name="l00635"></a>00635 <span class="comment">*  outputs       :</span>
<a name="l00636"></a>00636 <span class="comment">*    em          - eccentricity</span>
<a name="l00637"></a>00637 <span class="comment">*    argpm       - argument of perigee</span>
<a name="l00638"></a>00638 <span class="comment">*    inclm       - inclination</span>
<a name="l00639"></a>00639 <span class="comment">*    mm          - mean anomaly</span>
<a name="l00640"></a>00640 <span class="comment">*    nm          - mean motion</span>
<a name="l00641"></a>00641 <span class="comment">*    nodem       - right ascension of ascending node</span>
<a name="l00642"></a>00642 <span class="comment">*    irez        - flag for resonance           0-none, 1-one day, 2-half day</span>
<a name="l00643"></a>00643 <span class="comment">*    atime       -</span>
<a name="l00644"></a>00644 <span class="comment">*    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433    -</span>
<a name="l00645"></a>00645 <span class="comment">*    dedt        -</span>
<a name="l00646"></a>00646 <span class="comment">*    didt        -</span>
<a name="l00647"></a>00647 <span class="comment">*    dmdt        -</span>
<a name="l00648"></a>00648 <span class="comment">*    dndt        -</span>
<a name="l00649"></a>00649 <span class="comment">*    dnodt       -</span>
<a name="l00650"></a>00650 <span class="comment">*    domdt       -</span>
<a name="l00651"></a>00651 <span class="comment">*    del1, del2, del3        -</span>
<a name="l00652"></a>00652 <span class="comment">*    ses  , sghl , sghs , sgs  , shl  , shs  , sis  , sls</span>
<a name="l00653"></a>00653 <span class="comment">*    theta       -</span>
<a name="l00654"></a>00654 <span class="comment">*    xfact       -</span>
<a name="l00655"></a>00655 <span class="comment">*    xlamo       -</span>
<a name="l00656"></a>00656 <span class="comment">*    xli         -</span>
<a name="l00657"></a>00657 <span class="comment">*    xni</span>
<a name="l00658"></a>00658 <span class="comment">*</span>
<a name="l00659"></a>00659 <span class="comment">*  locals        :</span>
<a name="l00660"></a>00660 <span class="comment">*    ainv2       -</span>
<a name="l00661"></a>00661 <span class="comment">*    aonv        -</span>
<a name="l00662"></a>00662 <span class="comment">*    cosisq      -</span>
<a name="l00663"></a>00663 <span class="comment">*    eoc         -</span>
<a name="l00664"></a>00664 <span class="comment">*    f220, f221, f311, f321, f322, f330, f441, f442, f522, f523, f542, f543  -</span>
<a name="l00665"></a>00665 <span class="comment">*    g200, g201, g211, g300, g310, g322, g410, g422, g520, g521, g532, g533  -</span>
<a name="l00666"></a>00666 <span class="comment">*    sini2       -</span>
<a name="l00667"></a>00667 <span class="comment">*    temp        -</span>
<a name="l00668"></a>00668 <span class="comment">*    temp1       -</span>
<a name="l00669"></a>00669 <span class="comment">*    theta       -</span>
<a name="l00670"></a>00670 <span class="comment">*    xno2        -</span>
<a name="l00671"></a>00671 <span class="comment">*</span>
<a name="l00672"></a>00672 <span class="comment">*  coupling      :</span>
<a name="l00673"></a>00673 <span class="comment">*    getgravconst</span>
<a name="l00674"></a>00674 <span class="comment">*</span>
<a name="l00675"></a>00675 <span class="comment">*  references    :</span>
<a name="l00676"></a>00676 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00677"></a>00677 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l00678"></a>00678 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l00679"></a>00679 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l00680"></a>00680 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l00681"></a>00681 
<a name="l00682"></a>00682 <span class="keyword">static</span> <span class="keywordtype">void</span> dsinit
<a name="l00683"></a>00683      (
<a name="l00684"></a>00684        <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,
<a name="l00685"></a>00685        <span class="keywordtype">double</span> cosim,  <span class="keywordtype">double</span> emsq,   <span class="keywordtype">double</span> argpo,   <span class="keywordtype">double</span> s1,     <span class="keywordtype">double</span> s2,
<a name="l00686"></a>00686        <span class="keywordtype">double</span> s3,     <span class="keywordtype">double</span> s4,     <span class="keywordtype">double</span> s5,      <span class="keywordtype">double</span> sinim,  <span class="keywordtype">double</span> ss1,
<a name="l00687"></a>00687        <span class="keywordtype">double</span> ss2,    <span class="keywordtype">double</span> ss3,    <span class="keywordtype">double</span> ss4,     <span class="keywordtype">double</span> ss5,    <span class="keywordtype">double</span> sz1,
<a name="l00688"></a>00688        <span class="keywordtype">double</span> sz3,    <span class="keywordtype">double</span> sz11,   <span class="keywordtype">double</span> sz13,    <span class="keywordtype">double</span> sz21,   <span class="keywordtype">double</span> sz23,
<a name="l00689"></a>00689        <span class="keywordtype">double</span> sz31,   <span class="keywordtype">double</span> sz33,   <span class="keywordtype">double</span> t,       <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> gsto,
<a name="l00690"></a>00690        <span class="keywordtype">double</span> mo,     <span class="keywordtype">double</span> mdot,   <span class="keywordtype">double</span> no,      <span class="keywordtype">double</span> nodeo,  <span class="keywordtype">double</span> nodedot,
<a name="l00691"></a>00691        <span class="keywordtype">double</span> xpidot, <span class="keywordtype">double</span> z1,     <span class="keywordtype">double</span> z3,      <span class="keywordtype">double</span> z11,    <span class="keywordtype">double</span> z13,
<a name="l00692"></a>00692        <span class="keywordtype">double</span> z21,    <span class="keywordtype">double</span> z23,    <span class="keywordtype">double</span> z31,     <span class="keywordtype">double</span> z33,    <span class="keywordtype">double</span> ecco,
<a name="l00693"></a>00693        <span class="keywordtype">double</span> eccsq,  <span class="keywordtype">double</span>&amp; em,    <span class="keywordtype">double</span>&amp; argpm,  <span class="keywordtype">double</span>&amp; inclm, <span class="keywordtype">double</span>&amp; mm,
<a name="l00694"></a>00694        <span class="keywordtype">double</span>&amp; nm,    <span class="keywordtype">double</span>&amp; nodem,
<a name="l00695"></a>00695        <span class="keywordtype">int</span>&amp; irez,
<a name="l00696"></a>00696        <span class="keywordtype">double</span>&amp; atime, <span class="keywordtype">double</span>&amp; d2201, <span class="keywordtype">double</span>&amp; d2211,  <span class="keywordtype">double</span>&amp; d3210, <span class="keywordtype">double</span>&amp; d3222,
<a name="l00697"></a>00697        <span class="keywordtype">double</span>&amp; d4410, <span class="keywordtype">double</span>&amp; d4422, <span class="keywordtype">double</span>&amp; d5220,  <span class="keywordtype">double</span>&amp; d5232, <span class="keywordtype">double</span>&amp; d5421,
<a name="l00698"></a>00698        <span class="keywordtype">double</span>&amp; d5433, <span class="keywordtype">double</span>&amp; dedt,  <span class="keywordtype">double</span>&amp; didt,   <span class="keywordtype">double</span>&amp; dmdt,  <span class="keywordtype">double</span>&amp; dndt,
<a name="l00699"></a>00699        <span class="keywordtype">double</span>&amp; dnodt, <span class="keywordtype">double</span>&amp; domdt, <span class="keywordtype">double</span>&amp; del1,   <span class="keywordtype">double</span>&amp; del2,  <span class="keywordtype">double</span>&amp; del3,
<a name="l00700"></a>00700        <span class="keywordtype">double</span>&amp; xfact, <span class="keywordtype">double</span>&amp; xlamo, <span class="keywordtype">double</span>&amp; xli,    <span class="keywordtype">double</span>&amp; xni
<a name="l00701"></a>00701      )
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703      <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00704"></a>00704      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706      <span class="keywordtype">double</span> ainv2 , aonv=0.0, cosisq, eoc, f220 , f221  , f311  ,
<a name="l00707"></a>00707           f321  , f322  , f330  , f441  , f442  , f522  , f523  ,
<a name="l00708"></a>00708           f542  , f543  , g200  , g201  , g211  , g300  , g310  ,
<a name="l00709"></a>00709           g322  , g410  , g422  , g520  , g521  , g532  , g533  ,
<a name="l00710"></a>00710           ses   , sgs   , sghl  , sghs  , shs   , shll  , sis   ,
<a name="l00711"></a>00711           sini2 , sls   , temp  , temp1 , theta , xno2  , q22   ,
<a name="l00712"></a>00712           q31   , q33   , root22, root44, root54, rptim , root32,
<a name="l00713"></a>00713           root52, x2o3  , xke   , znl   , emo   , zns   , emsqo,
<a name="l00714"></a>00714           tumin, mu, radiusearthkm, j2, j3, j4, j3oj2;
<a name="l00715"></a>00715 
<a name="l00716"></a>00716      q22    = 1.7891679e-6;
<a name="l00717"></a>00717      q31    = 2.1460748e-6;
<a name="l00718"></a>00718      q33    = 2.2123015e-7;
<a name="l00719"></a>00719      root22 = 1.7891679e-6;
<a name="l00720"></a>00720      root44 = 7.3636953e-9;
<a name="l00721"></a>00721      root54 = 2.1765803e-9;
<a name="l00722"></a>00722      rptim  = 4.37526908801129966e-3; <span class="comment">// this equates to 7.29211514668855e-5 rad/sec</span>
<a name="l00723"></a>00723      root32 = 3.7393792e-7;
<a name="l00724"></a>00724      root52 = 1.1428639e-7;
<a name="l00725"></a>00725      x2o3   = 2.0 / 3.0;
<a name="l00726"></a>00726      znl    = 1.5835218e-4;
<a name="l00727"></a>00727      zns    = 1.19459e-5;
<a name="l00728"></a>00728 
<a name="l00729"></a>00729      <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l00730"></a>00730      <a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">getgravconst</a>( whichconst, tumin, mu, radiusearthkm, xke, j2, j3, j4, j3oj2 );
<a name="l00731"></a>00731 
<a name="l00732"></a>00732      <span class="comment">/* -------------------- deep space initialization ------------ */</span>
<a name="l00733"></a>00733      irez = 0;
<a name="l00734"></a>00734      <span class="keywordflow">if</span> ((nm &lt; 0.0052359877) &amp;&amp; (nm &gt; 0.0034906585))
<a name="l00735"></a>00735          irez = 1;
<a name="l00736"></a>00736      <span class="keywordflow">if</span> ((nm &gt;= 8.26e-3) &amp;&amp; (nm &lt;= 9.24e-3) &amp;&amp; (em &gt;= 0.5))
<a name="l00737"></a>00737          irez = 2;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739      <span class="comment">/* ------------------------ do solar terms ------------------- */</span>
<a name="l00740"></a>00740      ses  =  ss1 * zns * ss5;
<a name="l00741"></a>00741      sis  =  ss2 * zns * (sz11 + sz13);
<a name="l00742"></a>00742      sls  = -zns * ss3 * (sz1 + sz3 - 14.0 - 6.0 * emsq);
<a name="l00743"></a>00743      sghs =  ss4 * zns * (sz31 + sz33 - 6.0);
<a name="l00744"></a>00744      shs  = -zns * ss2 * (sz21 + sz23);
<a name="l00745"></a>00745      <span class="comment">// sgp4fix for 180 deg incl</span>
<a name="l00746"></a>00746      <span class="keywordflow">if</span> ((inclm &lt; 5.2359877e-2) || (inclm &gt; <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a> - 5.2359877e-2))
<a name="l00747"></a>00747        shs = 0.0;
<a name="l00748"></a>00748      <span class="keywordflow">if</span> (sinim != 0.0)
<a name="l00749"></a>00749        shs = shs / sinim;
<a name="l00750"></a>00750      sgs  = sghs - cosim * shs;
<a name="l00751"></a>00751 
<a name="l00752"></a>00752      <span class="comment">/* ------------------------- do lunar terms ------------------ */</span>
<a name="l00753"></a>00753      dedt = ses + s1 * znl * s5;
<a name="l00754"></a>00754      didt = sis + s2 * znl * (z11 + z13);
<a name="l00755"></a>00755      dmdt = sls - znl * s3 * (z1 + z3 - 14.0 - 6.0 * emsq);
<a name="l00756"></a>00756      sghl = s4 * znl * (z31 + z33 - 6.0);
<a name="l00757"></a>00757      shll = -znl * s2 * (z21 + z23);
<a name="l00758"></a>00758      <span class="comment">// sgp4fix for 180 deg incl</span>
<a name="l00759"></a>00759      <span class="keywordflow">if</span> ((inclm &lt; 5.2359877e-2) || (inclm &gt; <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a> - 5.2359877e-2))
<a name="l00760"></a>00760          shll = 0.0;
<a name="l00761"></a>00761      domdt = sgs + sghl;
<a name="l00762"></a>00762      dnodt = shs;
<a name="l00763"></a>00763      <span class="keywordflow">if</span> (sinim != 0.0)
<a name="l00764"></a>00764        {
<a name="l00765"></a>00765          domdt = domdt - cosim / sinim * shll;
<a name="l00766"></a>00766          dnodt = dnodt + shll / sinim;
<a name="l00767"></a>00767        }
<a name="l00768"></a>00768 
<a name="l00769"></a>00769      <span class="comment">/* ----------- calculate deep space resonance effects -------- */</span>
<a name="l00770"></a>00770      dndt   = 0.0;
<a name="l00771"></a>00771      theta  = fmod(gsto + tc * rptim, twopi);
<a name="l00772"></a>00772      em     = em + dedt * t;
<a name="l00773"></a>00773      inclm  = inclm + didt * t;
<a name="l00774"></a>00774      argpm  = argpm + domdt * t;
<a name="l00775"></a>00775      nodem  = nodem + dnodt * t;
<a name="l00776"></a>00776      mm     = mm + dmdt * t;
<a name="l00777"></a>00777      <span class="comment">//   sgp4fix for negative inclinations</span>
<a name="l00778"></a>00778      <span class="comment">//   the following if statement should be commented out</span>
<a name="l00779"></a>00779      <span class="comment">//if (inclm &lt; 0.0)</span>
<a name="l00780"></a>00780      <span class="comment">//  {</span>
<a name="l00781"></a>00781      <span class="comment">//    inclm  = -inclm;</span>
<a name="l00782"></a>00782      <span class="comment">//    argpm  = argpm - pi;</span>
<a name="l00783"></a>00783      <span class="comment">//    nodem = nodem + pi;</span>
<a name="l00784"></a>00784      <span class="comment">//  }</span>
<a name="l00785"></a>00785 
<a name="l00786"></a>00786      <span class="comment">/* -------------- initialize the resonance terms ------------- */</span>
<a name="l00787"></a>00787      <span class="keywordflow">if</span> (irez != 0)
<a name="l00788"></a>00788        {
<a name="l00789"></a>00789          aonv = pow(nm / xke, x2o3);
<a name="l00790"></a>00790 
<a name="l00791"></a>00791          <span class="comment">/* ---------- geopotential resonance for 12 hour orbits ------ */</span>
<a name="l00792"></a>00792          <span class="keywordflow">if</span> (irez == 2)
<a name="l00793"></a>00793            {
<a name="l00794"></a>00794              cosisq = cosim * cosim;
<a name="l00795"></a>00795              emo    = em;
<a name="l00796"></a>00796              em     = ecco;
<a name="l00797"></a>00797              emsqo  = emsq;
<a name="l00798"></a>00798              emsq   = eccsq;
<a name="l00799"></a>00799              eoc    = em * emsq;
<a name="l00800"></a>00800              g201   = -0.306 - (em - 0.64) * 0.440;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802              <span class="keywordflow">if</span> (em &lt;= 0.65)
<a name="l00803"></a>00803                {
<a name="l00804"></a>00804                  g211 =    3.616  -  13.2470 * em +  16.2900 * emsq;
<a name="l00805"></a>00805                  g310 =  -19.302  + 117.3900 * em - 228.4190 * emsq +  156.5910 * eoc;
<a name="l00806"></a>00806                  g322 =  -18.9068 + 109.7927 * em - 214.6334 * emsq +  146.5816 * eoc;
<a name="l00807"></a>00807                  g410 =  -41.122  + 242.6940 * em - 471.0940 * emsq +  313.9530 * eoc;
<a name="l00808"></a>00808                  g422 = -146.407  + 841.8800 * em - 1629.014 * emsq + 1083.4350 * eoc;
<a name="l00809"></a>00809                  g520 = -532.114  + 3017.977 * em - 5740.032 * emsq + 3708.2760 * eoc;
<a name="l00810"></a>00810                }
<a name="l00811"></a>00811                <span class="keywordflow">else</span>
<a name="l00812"></a>00812                {
<a name="l00813"></a>00813                  g211 =   -72.099 +   331.819 * em -   508.738 * emsq +   266.724 * eoc;
<a name="l00814"></a>00814                  g310 =  -346.844 +  1582.851 * em -  2415.925 * emsq +  1246.113 * eoc;
<a name="l00815"></a>00815                  g322 =  -342.585 +  1554.908 * em -  2366.899 * emsq +  1215.972 * eoc;
<a name="l00816"></a>00816                  g410 = -1052.797 +  4758.686 * em -  7193.992 * emsq +  3651.957 * eoc;
<a name="l00817"></a>00817                  g422 = -3581.690 + 16178.110 * em - 24462.770 * emsq + 12422.520 * eoc;
<a name="l00818"></a>00818                  <span class="keywordflow">if</span> (em &gt; 0.715)
<a name="l00819"></a>00819                      g520 =-5149.66 + 29936.92 * em - 54087.36 * emsq + 31324.56 * eoc;
<a name="l00820"></a>00820                    <span class="keywordflow">else</span>
<a name="l00821"></a>00821                      g520 = 1464.74 -  4664.75 * em +  3763.64 * emsq;
<a name="l00822"></a>00822                }
<a name="l00823"></a>00823              <span class="keywordflow">if</span> (em &lt; 0.7)
<a name="l00824"></a>00824                {
<a name="l00825"></a>00825                  g533 = -919.22770 + 4988.6100 * em - 9064.7700 * emsq + 5542.21  * eoc;
<a name="l00826"></a>00826                  g521 = -822.71072 + 4568.6173 * em - 8491.4146 * emsq + 5337.524 * eoc;
<a name="l00827"></a>00827                  g532 = -853.66600 + 4690.2500 * em - 8624.7700 * emsq + 5341.4  * eoc;
<a name="l00828"></a>00828                }
<a name="l00829"></a>00829                <span class="keywordflow">else</span>
<a name="l00830"></a>00830                {
<a name="l00831"></a>00831                  g533 =-37995.780 + 161616.52 * em - 229838.20 * emsq + 109377.94 * eoc;
<a name="l00832"></a>00832                  g521 =-51752.104 + 218913.95 * em - 309468.16 * emsq + 146349.42 * eoc;
<a name="l00833"></a>00833                  g532 =-40023.880 + 170470.89 * em - 242699.48 * emsq + 115605.82 * eoc;
<a name="l00834"></a>00834                }
<a name="l00835"></a>00835 
<a name="l00836"></a>00836              sini2=  sinim * sinim;
<a name="l00837"></a>00837              f220 =  0.75 * (1.0 + 2.0 * cosim+cosisq);
<a name="l00838"></a>00838              f221 =  1.5 * sini2;
<a name="l00839"></a>00839              f321 =  1.875 * sinim  *  (1.0 - 2.0 * cosim - 3.0 * cosisq);
<a name="l00840"></a>00840              f322 = -1.875 * sinim  *  (1.0 + 2.0 * cosim - 3.0 * cosisq);
<a name="l00841"></a>00841              f441 = 35.0 * sini2 * f220;
<a name="l00842"></a>00842              f442 = 39.3750 * sini2 * sini2;
<a name="l00843"></a>00843              f522 =  9.84375 * sinim * (sini2 * (1.0 - 2.0 * cosim- 5.0 * cosisq) +
<a name="l00844"></a>00844                      0.33333333 * (-2.0 + 4.0 * cosim + 6.0 * cosisq) );
<a name="l00845"></a>00845              f523 = sinim * (4.92187512 * sini2 * (-2.0 - 4.0 * cosim +
<a name="l00846"></a>00846                     10.0 * cosisq) + 6.56250012 * (1.0+2.0 * cosim - 3.0 * cosisq));
<a name="l00847"></a>00847              f542 = 29.53125 * sinim * (2.0 - 8.0 * cosim+cosisq *
<a name="l00848"></a>00848                     (-12.0 + 8.0 * cosim + 10.0 * cosisq));
<a name="l00849"></a>00849              f543 = 29.53125 * sinim * (-2.0 - 8.0 * cosim+cosisq *
<a name="l00850"></a>00850                     (12.0 + 8.0 * cosim - 10.0 * cosisq));
<a name="l00851"></a>00851              xno2  =  nm * nm;
<a name="l00852"></a>00852              ainv2 =  aonv * aonv;
<a name="l00853"></a>00853              temp1 =  3.0 * xno2 * ainv2;
<a name="l00854"></a>00854              temp  =  temp1 * root22;
<a name="l00855"></a>00855              d2201 =  temp * f220 * g201;
<a name="l00856"></a>00856              d2211 =  temp * f221 * g211;
<a name="l00857"></a>00857              temp1 =  temp1 * aonv;
<a name="l00858"></a>00858              temp  =  temp1 * root32;
<a name="l00859"></a>00859              d3210 =  temp * f321 * g310;
<a name="l00860"></a>00860              d3222 =  temp * f322 * g322;
<a name="l00861"></a>00861              temp1 =  temp1 * aonv;
<a name="l00862"></a>00862              temp  =  2.0 * temp1 * root44;
<a name="l00863"></a>00863              d4410 =  temp * f441 * g410;
<a name="l00864"></a>00864              d4422 =  temp * f442 * g422;
<a name="l00865"></a>00865              temp1 =  temp1 * aonv;
<a name="l00866"></a>00866              temp  =  temp1 * root52;
<a name="l00867"></a>00867              d5220 =  temp * f522 * g520;
<a name="l00868"></a>00868              d5232 =  temp * f523 * g532;
<a name="l00869"></a>00869              temp  =  2.0 * temp1 * root54;
<a name="l00870"></a>00870              d5421 =  temp * f542 * g521;
<a name="l00871"></a>00871              d5433 =  temp * f543 * g533;
<a name="l00872"></a>00872              xlamo =  fmod(mo + nodeo + nodeo-theta - theta, twopi);
<a name="l00873"></a>00873              xfact =  mdot + dmdt + 2.0 * (nodedot + dnodt - rptim) - no;
<a name="l00874"></a>00874              em    = emo;
<a name="l00875"></a>00875              emsq  = emsqo;
<a name="l00876"></a>00876            }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878          <span class="comment">/* ---------------- synchronous resonance terms -------------- */</span>
<a name="l00879"></a>00879          <span class="keywordflow">if</span> (irez == 1)
<a name="l00880"></a>00880            {
<a name="l00881"></a>00881              g200  = 1.0 + emsq * (-2.5 + 0.8125 * emsq);
<a name="l00882"></a>00882              g310  = 1.0 + 2.0 * emsq;
<a name="l00883"></a>00883              g300  = 1.0 + emsq * (-6.0 + 6.60937 * emsq);
<a name="l00884"></a>00884              f220  = 0.75 * (1.0 + cosim) * (1.0 + cosim);
<a name="l00885"></a>00885              f311  = 0.9375 * sinim * sinim * (1.0 + 3.0 * cosim) - 0.75 * (1.0 + cosim);
<a name="l00886"></a>00886              f330  = 1.0 + cosim;
<a name="l00887"></a>00887              f330  = 1.875 * f330 * f330 * f330;
<a name="l00888"></a>00888              del1  = 3.0 * nm * nm * aonv * aonv;
<a name="l00889"></a>00889              del2  = 2.0 * del1 * f220 * g200 * q22;
<a name="l00890"></a>00890              del3  = 3.0 * del1 * f330 * g300 * q33 * aonv;
<a name="l00891"></a>00891              del1  = del1 * f311 * g310 * q31 * aonv;
<a name="l00892"></a>00892              xlamo = fmod(mo + nodeo + argpo - theta, twopi);
<a name="l00893"></a>00893              xfact = mdot + xpidot - rptim + dmdt + domdt + dnodt - no;
<a name="l00894"></a>00894            }
<a name="l00895"></a>00895 
<a name="l00896"></a>00896          <span class="comment">/* ------------ for sgp4, initialize the integrator ---------- */</span>
<a name="l00897"></a>00897          xli   = xlamo;
<a name="l00898"></a>00898          xni   = no;
<a name="l00899"></a>00899          atime = 0.0;
<a name="l00900"></a>00900          nm    = no + dndt;
<a name="l00901"></a>00901        }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 <span class="comment">//#include &quot;debug3.cpp&quot;</span>
<a name="l00904"></a>00904 }  <span class="comment">// end dsinit</span>
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l00907"></a>00907 <span class="comment">*</span>
<a name="l00908"></a>00908 <span class="comment">*                           procedure dspace</span>
<a name="l00909"></a>00909 <span class="comment">*</span>
<a name="l00910"></a>00910 <span class="comment">*  this procedure provides deep space contributions to mean elements for</span>
<a name="l00911"></a>00911 <span class="comment">*    perturbing third body.  these effects have been averaged over one</span>
<a name="l00912"></a>00912 <span class="comment">*    revolution of the sun and moon.  for earth resonance effects, the</span>
<a name="l00913"></a>00913 <span class="comment">*    effects have been averaged over no revolutions of the satellite.</span>
<a name="l00914"></a>00914 <span class="comment">*    (mean motion)</span>
<a name="l00915"></a>00915 <span class="comment">*</span>
<a name="l00916"></a>00916 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l00917"></a>00917 <span class="comment">*</span>
<a name="l00918"></a>00918 <span class="comment">*  inputs        :</span>
<a name="l00919"></a>00919 <span class="comment">*    d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433 -</span>
<a name="l00920"></a>00920 <span class="comment">*    dedt        -</span>
<a name="l00921"></a>00921 <span class="comment">*    del1, del2, del3  -</span>
<a name="l00922"></a>00922 <span class="comment">*    didt        -</span>
<a name="l00923"></a>00923 <span class="comment">*    dmdt        -</span>
<a name="l00924"></a>00924 <span class="comment">*    dnodt       -</span>
<a name="l00925"></a>00925 <span class="comment">*    domdt       -</span>
<a name="l00926"></a>00926 <span class="comment">*    irez        - flag for resonance           0-none, 1-one day, 2-half day</span>
<a name="l00927"></a>00927 <span class="comment">*    argpo       - argument of perigee</span>
<a name="l00928"></a>00928 <span class="comment">*    argpdot     - argument of perigee dot (rate)</span>
<a name="l00929"></a>00929 <span class="comment">*    t           - time</span>
<a name="l00930"></a>00930 <span class="comment">*    tc          -</span>
<a name="l00931"></a>00931 <span class="comment">*    gsto        - gst</span>
<a name="l00932"></a>00932 <span class="comment">*    xfact       -</span>
<a name="l00933"></a>00933 <span class="comment">*    xlamo       -</span>
<a name="l00934"></a>00934 <span class="comment">*    no          - mean motion</span>
<a name="l00935"></a>00935 <span class="comment">*    atime       -</span>
<a name="l00936"></a>00936 <span class="comment">*    em          - eccentricity</span>
<a name="l00937"></a>00937 <span class="comment">*    ft          -</span>
<a name="l00938"></a>00938 <span class="comment">*    argpm       - argument of perigee</span>
<a name="l00939"></a>00939 <span class="comment">*    inclm       - inclination</span>
<a name="l00940"></a>00940 <span class="comment">*    xli         -</span>
<a name="l00941"></a>00941 <span class="comment">*    mm          - mean anomaly</span>
<a name="l00942"></a>00942 <span class="comment">*    xni         - mean motion</span>
<a name="l00943"></a>00943 <span class="comment">*    nodem       - right ascension of ascending node</span>
<a name="l00944"></a>00944 <span class="comment">*</span>
<a name="l00945"></a>00945 <span class="comment">*  outputs       :</span>
<a name="l00946"></a>00946 <span class="comment">*    atime       -</span>
<a name="l00947"></a>00947 <span class="comment">*    em          - eccentricity</span>
<a name="l00948"></a>00948 <span class="comment">*    argpm       - argument of perigee</span>
<a name="l00949"></a>00949 <span class="comment">*    inclm       - inclination</span>
<a name="l00950"></a>00950 <span class="comment">*    xli         -</span>
<a name="l00951"></a>00951 <span class="comment">*    mm          - mean anomaly</span>
<a name="l00952"></a>00952 <span class="comment">*    xni         -</span>
<a name="l00953"></a>00953 <span class="comment">*    nodem       - right ascension of ascending node</span>
<a name="l00954"></a>00954 <span class="comment">*    dndt        -</span>
<a name="l00955"></a>00955 <span class="comment">*    nm          - mean motion</span>
<a name="l00956"></a>00956 <span class="comment">*</span>
<a name="l00957"></a>00957 <span class="comment">*  locals        :</span>
<a name="l00958"></a>00958 <span class="comment">*    delt        -</span>
<a name="l00959"></a>00959 <span class="comment">*    ft          -</span>
<a name="l00960"></a>00960 <span class="comment">*    theta       -</span>
<a name="l00961"></a>00961 <span class="comment">*    x2li        -</span>
<a name="l00962"></a>00962 <span class="comment">*    x2omi       -</span>
<a name="l00963"></a>00963 <span class="comment">*    xl          -</span>
<a name="l00964"></a>00964 <span class="comment">*    xldot       -</span>
<a name="l00965"></a>00965 <span class="comment">*    xnddt       -</span>
<a name="l00966"></a>00966 <span class="comment">*    xndt        -</span>
<a name="l00967"></a>00967 <span class="comment">*    xomi        -</span>
<a name="l00968"></a>00968 <span class="comment">*</span>
<a name="l00969"></a>00969 <span class="comment">*  coupling      :</span>
<a name="l00970"></a>00970 <span class="comment">*    none        -</span>
<a name="l00971"></a>00971 <span class="comment">*</span>
<a name="l00972"></a>00972 <span class="comment">*  references    :</span>
<a name="l00973"></a>00973 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00974"></a>00974 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l00975"></a>00975 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l00976"></a>00976 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l00977"></a>00977 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l00978"></a>00978 
<a name="l00979"></a>00979 <span class="keyword">static</span> <span class="keywordtype">void</span> dspace
<a name="l00980"></a>00980      (
<a name="l00981"></a>00981        <span class="keywordtype">int</span> irez,
<a name="l00982"></a>00982        <span class="keywordtype">double</span> d2201,  <span class="keywordtype">double</span> d2211,  <span class="keywordtype">double</span> d3210,   <span class="keywordtype">double</span> d3222,  <span class="keywordtype">double</span> d4410,
<a name="l00983"></a>00983        <span class="keywordtype">double</span> d4422,  <span class="keywordtype">double</span> d5220,  <span class="keywordtype">double</span> d5232,   <span class="keywordtype">double</span> d5421,  <span class="keywordtype">double</span> d5433,
<a name="l00984"></a>00984        <span class="keywordtype">double</span> dedt,   <span class="keywordtype">double</span> del1,   <span class="keywordtype">double</span> del2,    <span class="keywordtype">double</span> del3,   <span class="keywordtype">double</span> didt,
<a name="l00985"></a>00985        <span class="keywordtype">double</span> dmdt,   <span class="keywordtype">double</span> dnodt,  <span class="keywordtype">double</span> domdt,   <span class="keywordtype">double</span> argpo,  <span class="keywordtype">double</span> argpdot,
<a name="l00986"></a>00986        <span class="keywordtype">double</span> t,      <span class="keywordtype">double</span> tc,     <span class="keywordtype">double</span> gsto,    <span class="keywordtype">double</span> xfact,  <span class="keywordtype">double</span> xlamo,
<a name="l00987"></a>00987        <span class="keywordtype">double</span> no,
<a name="l00988"></a>00988        <span class="keywordtype">double</span>&amp; atime, <span class="keywordtype">double</span>&amp; em,    <span class="keywordtype">double</span>&amp; argpm,  <span class="keywordtype">double</span>&amp; inclm, <span class="keywordtype">double</span>&amp; xli,
<a name="l00989"></a>00989        <span class="keywordtype">double</span>&amp; mm,    <span class="keywordtype">double</span>&amp; xni,   <span class="keywordtype">double</span>&amp; nodem,  <span class="keywordtype">double</span>&amp; dndt,  <span class="keywordtype">double</span>&amp; nm
<a name="l00990"></a>00990      )
<a name="l00991"></a>00991 {
<a name="l00992"></a>00992      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l00993"></a>00993      <span class="keywordtype">int</span> iretn , iret;
<a name="l00994"></a>00994      <span class="keywordtype">double</span> delt, ft, theta, x2li, x2omi, xl, xldot , xnddt, xndt, xomi, g22, g32,
<a name="l00995"></a>00995           g44, g52, g54, fasx2, fasx4, fasx6, rptim , step2, stepn , stepp;
<a name="l00996"></a>00996 
<a name="l00997"></a>00997      ft    = 0.0;
<a name="l00998"></a>00998      fasx2 = 0.13130908;
<a name="l00999"></a>00999      fasx4 = 2.8843198;
<a name="l01000"></a>01000      fasx6 = 0.37448087;
<a name="l01001"></a>01001      g22   = 5.7686396;
<a name="l01002"></a>01002      g32   = 0.95240898;
<a name="l01003"></a>01003      g44   = 1.8014998;
<a name="l01004"></a>01004      g52   = 1.0508330;
<a name="l01005"></a>01005      g54   = 4.4108898;
<a name="l01006"></a>01006      rptim = 4.37526908801129966e-3; <span class="comment">// this equates to 7.29211514668855e-5 rad/sec</span>
<a name="l01007"></a>01007      stepp =    720.0;
<a name="l01008"></a>01008      stepn =   -720.0;
<a name="l01009"></a>01009      step2 = 259200.0;
<a name="l01010"></a>01010 
<a name="l01011"></a>01011      <span class="comment">/* ----------- calculate deep space resonance effects ----------- */</span>
<a name="l01012"></a>01012      dndt   = 0.0;
<a name="l01013"></a>01013      theta  = fmod(gsto + tc * rptim, twopi);
<a name="l01014"></a>01014      em     = em + dedt * t;
<a name="l01015"></a>01015 
<a name="l01016"></a>01016      inclm  = inclm + didt * t;
<a name="l01017"></a>01017      argpm  = argpm + domdt * t;
<a name="l01018"></a>01018      nodem  = nodem + dnodt * t;
<a name="l01019"></a>01019      mm     = mm + dmdt * t;
<a name="l01020"></a>01020 
<a name="l01021"></a>01021      <span class="comment">//   sgp4fix for negative inclinations</span>
<a name="l01022"></a>01022      <span class="comment">//   the following if statement should be commented out</span>
<a name="l01023"></a>01023      <span class="comment">//  if (inclm &lt; 0.0)</span>
<a name="l01024"></a>01024      <span class="comment">// {</span>
<a name="l01025"></a>01025      <span class="comment">//    inclm = -inclm;</span>
<a name="l01026"></a>01026      <span class="comment">//    argpm = argpm - pi;</span>
<a name="l01027"></a>01027      <span class="comment">//    nodem = nodem + pi;</span>
<a name="l01028"></a>01028      <span class="comment">//  }</span>
<a name="l01029"></a>01029 
<a name="l01030"></a>01030      <span class="comment">/* - update resonances : numerical (euler-maclaurin) integration - */</span>
<a name="l01031"></a>01031      <span class="comment">/* ------------------------- epoch restart ----------------------  */</span>
<a name="l01032"></a>01032      <span class="comment">//   sgp4fix for propagator problems</span>
<a name="l01033"></a>01033      <span class="comment">//   the following integration works for negative time steps and periods</span>
<a name="l01034"></a>01034      <span class="comment">//   the specific changes are unknown because the original code was so convoluted</span>
<a name="l01035"></a>01035 
<a name="l01036"></a>01036      ft    = 0.0;
<a name="l01037"></a>01037      atime = 0.0;
<a name="l01038"></a>01038      <span class="keywordflow">if</span> (irez != 0)
<a name="l01039"></a>01039        {
<a name="l01040"></a>01040          <span class="keywordflow">if</span> ((atime == 0.0) || ((t &gt;= 0.0) &amp;&amp; (atime &lt; 0.0)) ||
<a name="l01041"></a>01041              ((t &lt; 0.0) &amp;&amp; (atime &gt;= 0.0)))
<a name="l01042"></a>01042            {
<a name="l01043"></a>01043              <span class="keywordflow">if</span> (t &gt;= 0.0)
<a name="l01044"></a>01044                  delt = stepp;
<a name="l01045"></a>01045                <span class="keywordflow">else</span>
<a name="l01046"></a>01046                  delt = stepn;
<a name="l01047"></a>01047              atime  = 0.0;
<a name="l01048"></a>01048              xni    = no;
<a name="l01049"></a>01049              xli    = xlamo;
<a name="l01050"></a>01050            }
<a name="l01051"></a>01051          iretn = 381; <span class="comment">// added for do loop</span>
<a name="l01052"></a>01052          iret  =   0; <span class="comment">// added for loop</span>
<a name="l01053"></a>01053          <span class="keywordflow">while</span> (iretn == 381)
<a name="l01054"></a>01054            {
<a name="l01055"></a>01055              <span class="keywordflow">if</span> ((fabs(t) &lt; fabs(atime)) || (iret == 351))
<a name="l01056"></a>01056                {
<a name="l01057"></a>01057                  <span class="keywordflow">if</span> (t &gt;= 0.0)
<a name="l01058"></a>01058                      delt = stepn;
<a name="l01059"></a>01059                    <span class="keywordflow">else</span>
<a name="l01060"></a>01060                      delt = stepp;
<a name="l01061"></a>01061                  iret  = 351;
<a name="l01062"></a>01062                  iretn = 381;
<a name="l01063"></a>01063                }
<a name="l01064"></a>01064                <span class="keywordflow">else</span>
<a name="l01065"></a>01065                {
<a name="l01066"></a>01066                  <span class="keywordflow">if</span> (t &gt; 0.0)  <span class="comment">// error if prev if has atime:=0.0 and t:=0.0 (ge)</span>
<a name="l01067"></a>01067                      delt = stepp;
<a name="l01068"></a>01068                    <span class="keywordflow">else</span>
<a name="l01069"></a>01069                      delt = stepn;
<a name="l01070"></a>01070                  <span class="keywordflow">if</span> (fabs(t - atime) &gt;= stepp)
<a name="l01071"></a>01071                    {
<a name="l01072"></a>01072                      iret  = 0;
<a name="l01073"></a>01073                      iretn = 381;
<a name="l01074"></a>01074                    }
<a name="l01075"></a>01075                    <span class="keywordflow">else</span>
<a name="l01076"></a>01076                    {
<a name="l01077"></a>01077                      ft    = t - atime;
<a name="l01078"></a>01078                      iretn = 0;
<a name="l01079"></a>01079                    }
<a name="l01080"></a>01080                }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082              <span class="comment">/* ------------------- dot terms calculated ------------- */</span>
<a name="l01083"></a>01083              <span class="comment">/* ----------- near - synchronous resonance terms ------- */</span>
<a name="l01084"></a>01084              <span class="keywordflow">if</span> (irez != 2)
<a name="l01085"></a>01085                {
<a name="l01086"></a>01086                  xndt  = del1 * sin(xli - fasx2) + del2 * sin(2.0 * (xli - fasx4)) +
<a name="l01087"></a>01087                          del3 * sin(3.0 * (xli - fasx6));
<a name="l01088"></a>01088                  xldot = xni + xfact;
<a name="l01089"></a>01089                  xnddt = del1 * cos(xli - fasx2) +
<a name="l01090"></a>01090                          2.0 * del2 * cos(2.0 * (xli - fasx4)) +
<a name="l01091"></a>01091                          3.0 * del3 * cos(3.0 * (xli - fasx6));
<a name="l01092"></a>01092                  xnddt = xnddt * xldot;
<a name="l01093"></a>01093                }
<a name="l01094"></a>01094                <span class="keywordflow">else</span>
<a name="l01095"></a>01095                {
<a name="l01096"></a>01096                  <span class="comment">/* --------- near - half-day resonance terms -------- */</span>
<a name="l01097"></a>01097                  xomi  = argpo + argpdot * atime;
<a name="l01098"></a>01098                  x2omi = xomi + xomi;
<a name="l01099"></a>01099                  x2li  = xli + xli;
<a name="l01100"></a>01100                  xndt  = d2201 * sin(x2omi + xli - g22) + d2211 * sin(xli - g22) +
<a name="l01101"></a>01101                        d3210 * sin(xomi + xli - g32)  + d3222 * sin(-xomi + xli - g32)+
<a name="l01102"></a>01102                        d4410 * sin(x2omi + x2li - g44)+ d4422 * sin(x2li - g44) +
<a name="l01103"></a>01103                        d5220 * sin(xomi + xli - g52)  + d5232 * sin(-xomi + xli - g52)+
<a name="l01104"></a>01104                        d5421 * sin(xomi + x2li - g54) + d5433 * sin(-xomi + x2li - g54);
<a name="l01105"></a>01105                  xldot = xni + xfact;
<a name="l01106"></a>01106                  xnddt = d2201 * cos(x2omi + xli - g22) + d2211 * cos(xli - g22) +
<a name="l01107"></a>01107                        d3210 * cos(xomi + xli - g32) + d3222 * cos(-xomi + xli - g32) +
<a name="l01108"></a>01108                        d5220 * cos(xomi + xli - g52) + d5232 * cos(-xomi + xli - g52) +
<a name="l01109"></a>01109                        2.0 * (d4410 * cos(x2omi + x2li - g44) +
<a name="l01110"></a>01110                        d4422 * cos(x2li - g44) + d5421 * cos(xomi + x2li - g54) +
<a name="l01111"></a>01111                        d5433 * cos(-xomi + x2li - g54));
<a name="l01112"></a>01112                  xnddt = xnddt * xldot;
<a name="l01113"></a>01113                }
<a name="l01114"></a>01114 
<a name="l01115"></a>01115              <span class="comment">/* ----------------------- integrator ------------------- */</span>
<a name="l01116"></a>01116              <span class="keywordflow">if</span> (iretn == 381)
<a name="l01117"></a>01117                {
<a name="l01118"></a>01118                  xli   = xli + xldot * delt + xndt * step2;
<a name="l01119"></a>01119                  xni   = xni + xndt * delt + xnddt * step2;
<a name="l01120"></a>01120                  atime = atime + delt;
<a name="l01121"></a>01121                }
<a name="l01122"></a>01122            }  <span class="comment">// while iretn = 381</span>
<a name="l01123"></a>01123 
<a name="l01124"></a>01124          nm = xni + xndt * ft + xnddt * ft * ft * 0.5;
<a name="l01125"></a>01125          xl = xli + xldot * ft + xndt * ft * ft * 0.5;
<a name="l01126"></a>01126          <span class="keywordflow">if</span> (irez != 1)
<a name="l01127"></a>01127            {
<a name="l01128"></a>01128              mm   = xl - 2.0 * nodem + 2.0 * theta;
<a name="l01129"></a>01129              dndt = nm - no;
<a name="l01130"></a>01130            }
<a name="l01131"></a>01131            <span class="keywordflow">else</span>
<a name="l01132"></a>01132            {
<a name="l01133"></a>01133              mm   = xl - nodem - argpm + theta;
<a name="l01134"></a>01134              dndt = nm - no;
<a name="l01135"></a>01135            }
<a name="l01136"></a>01136          nm = no + dndt;
<a name="l01137"></a>01137        }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139 <span class="comment">//#include &quot;debug4.cpp&quot;</span>
<a name="l01140"></a>01140 }  <span class="comment">// end dsspace</span>
<a name="l01141"></a>01141 
<a name="l01142"></a>01142 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01143"></a>01143 <span class="comment">*</span>
<a name="l01144"></a>01144 <span class="comment">*                           procedure initl</span>
<a name="l01145"></a>01145 <span class="comment">*</span>
<a name="l01146"></a>01146 <span class="comment">*       SGP4プロパゲーターの初期化1</span>
<a name="l01147"></a>01147 <span class="comment">*</span>
<a name="l01148"></a>01148 <span class="comment">*  this procedure initializes the spg4 propagator. all the initialization is</span>
<a name="l01149"></a>01149 <span class="comment">*    consolidated here instead of having multiple loops inside other routines.</span>
<a name="l01150"></a>01150 <span class="comment">*</span>
<a name="l01151"></a>01151 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l01152"></a>01152 <span class="comment">*</span>
<a name="l01153"></a>01153 <span class="comment">*  inputs        :</span>
<a name="l01154"></a>01154 <span class="comment">*    ecco        - eccentricity                           0.0 - 1.0</span>
<a name="l01155"></a>01155 <span class="comment">*    epoch       - epoch time in days from jan 0, 1950. 0 hr</span>
<a name="l01156"></a>01156 <span class="comment">*    inclo       - inclination of satellite</span>
<a name="l01157"></a>01157 <span class="comment">*    no          - mean motion of satellite</span>
<a name="l01158"></a>01158 <span class="comment">*    satn        - satellite number</span>
<a name="l01159"></a>01159 <span class="comment">*</span>
<a name="l01160"></a>01160 <span class="comment">*  outputs       :</span>
<a name="l01161"></a>01161 <span class="comment">*    ainv        - 1.0 / a</span>
<a name="l01162"></a>01162 <span class="comment">*    ao          - semi major axis</span>
<a name="l01163"></a>01163 <span class="comment">*    con41       -</span>
<a name="l01164"></a>01164 <span class="comment">*    con42       - 1.0 - 5.0 cos(i)</span>
<a name="l01165"></a>01165 <span class="comment">*    cosio       - cosine of inclination</span>
<a name="l01166"></a>01166 <span class="comment">*    cosio2      - cosio squared</span>
<a name="l01167"></a>01167 <span class="comment">*    eccsq       - eccentricity squared</span>
<a name="l01168"></a>01168 <span class="comment">*    method      - flag for deep space                    &#39;d&#39;, &#39;n&#39;</span>
<a name="l01169"></a>01169 <span class="comment">*    omeosq      - 1.0 - ecco * ecco</span>
<a name="l01170"></a>01170 <span class="comment">*    posq        - semi-parameter squared</span>
<a name="l01171"></a>01171 <span class="comment">*    rp          - radius of perigee</span>
<a name="l01172"></a>01172 <span class="comment">*    rteosq      - square root of (1.0 - ecco*ecco)</span>
<a name="l01173"></a>01173 <span class="comment">*    sinio       - sine of inclination</span>
<a name="l01174"></a>01174 <span class="comment">*    gsto        - gst at time of observation               rad</span>
<a name="l01175"></a>01175 <span class="comment">*    no          - mean motion of satellite</span>
<a name="l01176"></a>01176 <span class="comment">*</span>
<a name="l01177"></a>01177 <span class="comment">*  locals        :</span>
<a name="l01178"></a>01178 <span class="comment">*    ak          -</span>
<a name="l01179"></a>01179 <span class="comment">*    d1          -</span>
<a name="l01180"></a>01180 <span class="comment">*    del         -</span>
<a name="l01181"></a>01181 <span class="comment">*    adel        -</span>
<a name="l01182"></a>01182 <span class="comment">*    po          -</span>
<a name="l01183"></a>01183 <span class="comment">*</span>
<a name="l01184"></a>01184 <span class="comment">*  coupling      :</span>
<a name="l01185"></a>01185 <span class="comment">*    getgravconst</span>
<a name="l01186"></a>01186 <span class="comment">*    gstime      - find greenwich sidereal time from the julian date</span>
<a name="l01187"></a>01187 <span class="comment">*</span>
<a name="l01188"></a>01188 <span class="comment">*  references    :</span>
<a name="l01189"></a>01189 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01190"></a>01190 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l01191"></a>01191 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l01192"></a>01192 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l01193"></a>01193 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l01194"></a>01194 
<a name="l01195"></a>01195 <span class="keyword">static</span> <span class="keywordtype">void</span> initl
<a name="l01196"></a>01196      (
<a name="l01197"></a>01197        <span class="keywordtype">int</span> satn,      <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,
<a name="l01198"></a>01198        <span class="keywordtype">double</span> ecco,   <span class="keywordtype">double</span> epoch,  <span class="keywordtype">double</span> inclo,   <span class="keywordtype">double</span>&amp; no,
<a name="l01199"></a>01199        <span class="keywordtype">char</span>&amp; method,
<a name="l01200"></a>01200        <span class="keywordtype">double</span>&amp; ainv,  <span class="keywordtype">double</span>&amp; ao,    <span class="keywordtype">double</span>&amp; con41,  <span class="keywordtype">double</span>&amp; con42, <span class="keywordtype">double</span>&amp; cosio,
<a name="l01201"></a>01201        <span class="keywordtype">double</span>&amp; cosio2, <span class="keywordtype">double</span>&amp; eccsq, <span class="keywordtype">double</span>&amp; omeosq, <span class="keywordtype">double</span>&amp; posq,
<a name="l01202"></a>01202        <span class="keywordtype">double</span>&amp; rp,    <span class="keywordtype">double</span>&amp; rteosq, <span class="keywordtype">double</span>&amp; sinio , <span class="keywordtype">double</span>&amp; gsto
<a name="l01203"></a>01203      )
<a name="l01204"></a>01204 {
<a name="l01205"></a>01205      <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l01206"></a>01206      <span class="keywordtype">double</span> ak, d1, del, adel, po, x2o3, j2, xke,
<a name="l01207"></a>01207             tumin, mu, radiusearthkm, j3, j4, j3oj2;
<a name="l01208"></a>01208 
<a name="l01209"></a>01209      <span class="comment">// sgp4fix use old way of finding gst</span>
<a name="l01210"></a>01210      <span class="keywordtype">int</span> ids70;
<a name="l01211"></a>01211      <span class="keywordtype">double</span> ts70, ds70, tfrac, c1, thgr70, fk5r, c1p2p, thgr, thgro;
<a name="l01212"></a>01212      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l01213"></a>01213 
<a name="l01214"></a>01214      <span class="comment">/* ----------------------- earth constants ---------------------- */</span>
<a name="l01215"></a>01215      <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01216"></a>01216      <a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">getgravconst</a>( whichconst, tumin, mu, radiusearthkm, xke, j2, j3, j4, j3oj2 );
<a name="l01217"></a>01217      x2o3   = 2.0 / 3.0;
<a name="l01218"></a>01218 
<a name="l01219"></a>01219      <span class="comment">/* ------------- calculate auxillary epoch quantities ---------- */</span>
<a name="l01220"></a>01220      eccsq  = ecco * ecco;
<a name="l01221"></a>01221      omeosq = 1.0 - eccsq;
<a name="l01222"></a>01222      rteosq = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(omeosq);
<a name="l01223"></a>01223      cosio  = cos(inclo);
<a name="l01224"></a>01224      cosio2 = cosio * cosio;
<a name="l01225"></a>01225 
<a name="l01226"></a>01226      <span class="comment">/* ------------------ un-kozai the mean motion ----------------- */</span>
<a name="l01227"></a>01227      ak    = pow(xke / no, x2o3);
<a name="l01228"></a>01228      d1    = 0.75 * j2 * (3.0 * cosio2 - 1.0) / (rteosq * omeosq);
<a name="l01229"></a>01229      del   = d1 / (ak * ak);
<a name="l01230"></a>01230      adel  = ak * (1.0 - del * del - del *
<a name="l01231"></a>01231              (1.0 / 3.0 + 134.0 * del * del / 81.0));
<a name="l01232"></a>01232      del   = d1/(adel * adel);
<a name="l01233"></a>01233      no    = no / (1.0 + del);
<a name="l01234"></a>01234 
<a name="l01235"></a>01235      ao    = pow(xke / no, x2o3);
<a name="l01236"></a>01236      sinio = sin(inclo);
<a name="l01237"></a>01237      po    = ao * omeosq;
<a name="l01238"></a>01238      con42 = 1.0 - 5.0 * cosio2;
<a name="l01239"></a>01239      con41 = -con42-cosio2-cosio2;
<a name="l01240"></a>01240      ainv  = 1.0 / ao;
<a name="l01241"></a>01241      posq  = po * po;
<a name="l01242"></a>01242      rp    = ao * (1.0 - ecco);
<a name="l01243"></a>01243      method = <span class="charliteral">&#39;n&#39;</span>;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245      <span class="comment">// sgp4fix modern approach to finding sidereal timew</span>
<a name="l01246"></a>01246      <span class="comment">// gsto = gstime(epoch + 2433281.5);</span>
<a name="l01247"></a>01247 
<a name="l01248"></a>01248      <span class="comment">// sgp4fix use old way of finding gst</span>
<a name="l01249"></a>01249      <span class="comment">// count integer number of days from 0 jan 1970</span>
<a name="l01250"></a>01250      ts70  = epoch - 7305.0;
<a name="l01251"></a>01251      ids70 = floor(ts70 + 1.0e-8);
<a name="l01252"></a>01252      ds70  = ids70;
<a name="l01253"></a>01253      tfrac = ts70 - ds70;
<a name="l01254"></a>01254      <span class="comment">// find greenwich location at epoch</span>
<a name="l01255"></a>01255      c1    = 1.72027916940703639e-2;
<a name="l01256"></a>01256      thgr70= 1.7321343856509374;
<a name="l01257"></a>01257      fk5r  = 5.07551419432269442e-15;
<a name="l01258"></a>01258      c1p2p = c1 + twopi;
<a name="l01259"></a>01259      gsto  = fmod( thgr70 + c1*ds70 + c1p2p*tfrac + ts70*ts70*fk5r, twopi);
<a name="l01260"></a>01260      <span class="keywordflow">if</span> ( gsto &lt; 0.0 )
<a name="l01261"></a>01261          gsto = gsto + twopi;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 <span class="comment">//#include &quot;debug5.cpp&quot;</span>
<a name="l01264"></a>01264 }  <span class="comment">// end initl</span>
<a name="l01265"></a>01265 
<a name="l01266"></a>01266 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01267"></a>01267 <span class="comment">*</span>
<a name="l01268"></a>01268 <span class="comment">*                             procedure sgp4init</span>
<a name="l01269"></a>01269 <span class="comment">*</span>
<a name="l01270"></a>01270 <span class="comment">*       SGP4の初期化</span>
<a name="l01271"></a>01271 <span class="comment">*</span>
<a name="l01272"></a>01272 <span class="comment">*  this procedure initializes variables for sgp4.</span>
<a name="l01273"></a>01273 <span class="comment">*</span>
<a name="l01274"></a>01274 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l01275"></a>01275 <span class="comment">*</span>
<a name="l01276"></a>01276 <span class="comment">*  inputs        :</span>
<a name="l01277"></a>01277 <span class="comment">*    satn        - satellite number</span>
<a name="l01278"></a>01278 <span class="comment">*    bstar       - sgp4 type drag coefficient              kg/m2er</span>
<a name="l01279"></a>01279 <span class="comment">*    ecco        - eccentricity</span>
<a name="l01280"></a>01280 <span class="comment">*    epoch       - epoch time in days from jan 0, 1950. 0 hr</span>
<a name="l01281"></a>01281 <span class="comment">*    argpo       - argument of perigee (output if ds)</span>
<a name="l01282"></a>01282 <span class="comment">*    inclo       - inclination</span>
<a name="l01283"></a>01283 <span class="comment">*    mo          - mean anomaly (output if ds)</span>
<a name="l01284"></a>01284 <span class="comment">*    no          - mean motion</span>
<a name="l01285"></a>01285 <span class="comment">*    nodeo       - right ascension of ascending node</span>
<a name="l01286"></a>01286 <span class="comment">*</span>
<a name="l01287"></a>01287 <span class="comment">*  outputs       :</span>
<a name="l01288"></a>01288 <span class="comment">*    satrec      - common values for subsequent calls</span>
<a name="l01289"></a>01289 <span class="comment">*    return code - non-zero on error.</span>
<a name="l01290"></a>01290 <span class="comment">*                   1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span>
<a name="l01291"></a>01291 <span class="comment">*                   2 - mean motion less than 0.0</span>
<a name="l01292"></a>01292 <span class="comment">*                   3 - pert elements, ecc &lt; 0.0  or  ecc &gt; 1.0</span>
<a name="l01293"></a>01293 <span class="comment">*                   4 - semi-latus rectum &lt; 0.0</span>
<a name="l01294"></a>01294 <span class="comment">*                   5 - epoch elements are sub-orbital</span>
<a name="l01295"></a>01295 <span class="comment">*                   6 - satellite has decayed</span>
<a name="l01296"></a>01296 <span class="comment">*</span>
<a name="l01297"></a>01297 <span class="comment">*  locals        :</span>
<a name="l01298"></a>01298 <span class="comment">*    cnodm  , snodm  , cosim  , sinim  , cosomm , sinomm</span>
<a name="l01299"></a>01299 <span class="comment">*    cc1sq  , cc2    , cc3</span>
<a name="l01300"></a>01300 <span class="comment">*    coef   , coef1</span>
<a name="l01301"></a>01301 <span class="comment">*    cosio4      -</span>
<a name="l01302"></a>01302 <span class="comment">*    day         -</span>
<a name="l01303"></a>01303 <span class="comment">*    dndt        -</span>
<a name="l01304"></a>01304 <span class="comment">*    em          - eccentricity</span>
<a name="l01305"></a>01305 <span class="comment">*    emsq        - eccentricity squared</span>
<a name="l01306"></a>01306 <span class="comment">*    eeta        -</span>
<a name="l01307"></a>01307 <span class="comment">*    etasq       -</span>
<a name="l01308"></a>01308 <span class="comment">*    gam         -</span>
<a name="l01309"></a>01309 <span class="comment">*    argpm       - argument of perigee</span>
<a name="l01310"></a>01310 <span class="comment">*    nodem       -</span>
<a name="l01311"></a>01311 <span class="comment">*    inclm       - inclination</span>
<a name="l01312"></a>01312 <span class="comment">*    mm          - mean anomaly</span>
<a name="l01313"></a>01313 <span class="comment">*    nm          - mean motion</span>
<a name="l01314"></a>01314 <span class="comment">*    perige      - perigee</span>
<a name="l01315"></a>01315 <span class="comment">*    pinvsq      -</span>
<a name="l01316"></a>01316 <span class="comment">*    psisq       -</span>
<a name="l01317"></a>01317 <span class="comment">*    qzms24      -</span>
<a name="l01318"></a>01318 <span class="comment">*    rtemsq      -</span>
<a name="l01319"></a>01319 <span class="comment">*    s1, s2, s3, s4, s5, s6, s7          -</span>
<a name="l01320"></a>01320 <span class="comment">*    sfour       -</span>
<a name="l01321"></a>01321 <span class="comment">*    ss1, ss2, ss3, ss4, ss5, ss6, ss7         -</span>
<a name="l01322"></a>01322 <span class="comment">*    sz1, sz2, sz3</span>
<a name="l01323"></a>01323 <span class="comment">*    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33        -</span>
<a name="l01324"></a>01324 <span class="comment">*    tc          -</span>
<a name="l01325"></a>01325 <span class="comment">*    temp        -</span>
<a name="l01326"></a>01326 <span class="comment">*    temp1, temp2, temp3       -</span>
<a name="l01327"></a>01327 <span class="comment">*    tsi         -</span>
<a name="l01328"></a>01328 <span class="comment">*    xpidot      -</span>
<a name="l01329"></a>01329 <span class="comment">*    xhdot1      -</span>
<a name="l01330"></a>01330 <span class="comment">*    z1, z2, z3          -</span>
<a name="l01331"></a>01331 <span class="comment">*    z11, z12, z13, z21, z22, z23, z31, z32, z33         -</span>
<a name="l01332"></a>01332 <span class="comment">*</span>
<a name="l01333"></a>01333 <span class="comment">*  coupling      :</span>
<a name="l01334"></a>01334 <span class="comment">*    getgravconst-</span>
<a name="l01335"></a>01335 <span class="comment">*    initl       -</span>
<a name="l01336"></a>01336 <span class="comment">*    dscom       -</span>
<a name="l01337"></a>01337 <span class="comment">*    dpper       -</span>
<a name="l01338"></a>01338 <span class="comment">*    dsinit      -</span>
<a name="l01339"></a>01339 <span class="comment">*    sgp4        -</span>
<a name="l01340"></a>01340 <span class="comment">*</span>
<a name="l01341"></a>01341 <span class="comment">*  references    :</span>
<a name="l01342"></a>01342 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01343"></a>01343 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l01344"></a>01344 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l01345"></a>01345 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l01346"></a>01346 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l01347"></a>01347 
<a name="l01348"></a>01348 <span class="keywordtype">int</span> <a class="code" href="namespacesgp4.html#ac99253d85e493f5725d01920b0303a69">sgp4init</a>
<a name="l01349"></a><a class="code" href="namespacesgp4.html#ac99253d85e493f5725d01920b0303a69">01349</a>      (
<a name="l01350"></a>01350        <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,       <span class="keyword">const</span> <span class="keywordtype">int</span> satn,     <span class="keyword">const</span> <span class="keywordtype">double</span> epoch,
<a name="l01351"></a>01351        <span class="keyword">const</span> <span class="keywordtype">double</span> xbstar,  <span class="keyword">const</span> <span class="keywordtype">double</span> xecco, <span class="keyword">const</span> <span class="keywordtype">double</span> xargpo,
<a name="l01352"></a>01352        <span class="keyword">const</span> <span class="keywordtype">double</span> xinclo,  <span class="keyword">const</span> <span class="keywordtype">double</span> xmo,   <span class="keyword">const</span> <span class="keywordtype">double</span> xno,
<a name="l01353"></a>01353        <span class="keyword">const</span> <span class="keywordtype">double</span> xnodeo,  <a class="code" href="structsgp4_1_1elsetrec.html">elsetrec</a>&amp; satrec
<a name="l01354"></a>01354      )
<a name="l01355"></a>01355 {
<a name="l01356"></a>01356      <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l01357"></a>01357      <span class="keywordtype">double</span> ao, ainv,   con42, cosio, sinio, cosio2, eccsq,
<a name="l01358"></a>01358           omeosq, posq,   <a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>,     rteosq,
<a name="l01359"></a>01359           cnodm , snodm , cosim , sinim , cosomm, sinomm, cc1sq ,
<a name="l01360"></a>01360           cc2   , cc3   , coef  , coef1 , cosio4, day   , dndt  ,
<a name="l01361"></a>01361           em    , emsq  , eeta  , etasq , gam   , argpm , nodem ,
<a name="l01362"></a>01362           inclm , mm    , nm    , perige, pinvsq, psisq , qzms24,
<a name="l01363"></a>01363           rtemsq, s1    , s2    , s3    , s4    , s5    , s6    ,
<a name="l01364"></a>01364           s7    , sfour , ss1   , ss2   , ss3   , ss4   , ss5   ,
<a name="l01365"></a>01365           ss6   , ss7   , sz1   , sz2   , sz3   , sz11  , sz12  ,
<a name="l01366"></a>01366           sz13  , sz21  , sz22  , sz23  , sz31  , sz32  , sz33  ,
<a name="l01367"></a>01367           tc    , temp  , temp1 , temp2 , temp3 , tsi   , xpidot,
<a name="l01368"></a>01368           xhdot1, z1    , z2    , z3    , z11   , z12   , z13   ,
<a name="l01369"></a>01369           z21   , z22   , z23   , z31   , z32   , z33,
<a name="l01370"></a>01370           qzms2t, ss, j2, j3oj2, j4, x2o3, r[3], <a class="code" href="namespacestf.html#afa89a4a0c80d3727c2f396aa3ead41cd">v</a>[3],
<a name="l01371"></a>01371           tumin, mu, radiusearthkm, xke, j3;
<a name="l01372"></a>01372 
<a name="l01373"></a>01373      <span class="comment">/* ------------------------ initialization --------------------- */</span>
<a name="l01374"></a>01374      <span class="comment">// sgp4fix divisor for divide by zero check on inclination</span>
<a name="l01375"></a>01375      <span class="keyword">const</span> <span class="keywordtype">double</span> temp4    =   1.0 + cos(<a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>-1.0e-9);
<a name="l01376"></a>01376 
<a name="l01377"></a>01377      <span class="comment">/* ----------- set all near earth variables to zero ------------ */</span>
<a name="l01378"></a>01378      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a>   = 0;   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> = <span class="charliteral">&#39;n&#39;</span>; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6628418041a8ebe808d4cb5322c48f83">aycof</a>    = 0.0;
<a name="l01379"></a>01379      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>    = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aae7fc51e21ea0269e24402e4d677f2db">cc4</a>      = 0.0;
<a name="l01380"></a>01380      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7c1f86f775aca064ee704ee42412ebfc">cc5</a>     = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a>     = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2448c199295591c61cf9962872f2bb62">d3</a>       = 0.0;
<a name="l01381"></a>01381      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acec9f436198a40930b88133e8e388ef3">d4</a>      = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4d61c03338eb47ff5cb5159289a8b8ab">delmo</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a>      = 0.0;
<a name="l01382"></a>01382      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3794dfa4655891ff11ef04d30ce20e34">argpdot</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1a3066b5b1e170b1b54b6e1ebb95dde1">omgcof</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac1728506007ef3f8efc09ccfea258621">sinmao</a>   = 0.0;
<a name="l01383"></a>01383      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>       = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9406c83b6827ed0c886718636759a89c">t2cof</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a92b9a67758364f84cac8fe1d2231664c">t3cof</a>    = 0.0;
<a name="l01384"></a>01384      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b4b9d524f7a78a7621af6967fe97c0f">t4cof</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d7e5b2212e83963aa032e8977853072">t5cof</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a>   = 0.0;
<a name="l01385"></a>01385      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a778cfb16c16daf12b5838cec9e0ec4c9">x7thm1</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad3e5f43bf6e0edf97d4c5c13d1768a90">mdot</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6624e53fad0564a2e3fba8197a87cd2b">nodedot</a>  = 0.0;
<a name="l01386"></a>01386      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2cd45705ee518d0c2159e7d0d5e73c68">xmcof</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad31d1bb03dbc1676425a7756d8d89a8c">nodecf</a>   = 0.0;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388      <span class="comment">/* ----------- set all deep space variables to zero ------------ */</span>
<a name="l01389"></a>01389      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b5682d73c044235a090201f327770c1">irez</a>  = 0;   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aac83ffb5c1170491175bb9c617ed1b9a">d2201</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a69d0c093b184a168557344a6c693082f">d2211</a> = 0.0;
<a name="l01390"></a>01390      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae71649dd5d5786ba38a6729b41ee0c9b">d3210</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea737c740844f44e6855db3cf8ff0c4f">d3222</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a130498f44d3fc5ce920e62e7cfa68a2b">d4410</a> = 0.0;
<a name="l01391"></a>01391      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a81e28e9fe4d5ca7ad94ac482468a0871">d4422</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a91109cb1efb96c6726c64745aae89994">d5220</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86fbaaf3d669c3a6ba359f20eb120378">d5232</a> = 0.0;
<a name="l01392"></a>01392      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af0eaed781559fa4dcb0d4b090d74c9c1">d5421</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad407f986f615de2a613e0bdf2bac763d">d5433</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a724907a580d1b66425aaa0c1f8482668">dedt</a>  = 0.0;
<a name="l01393"></a>01393      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a95ac15d69f7e75a08904205f36678460">del1</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0b7270c4f4244227b98f47485e756278">del2</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af4fb07427d4dcd3d843fbc16bb53a233">del3</a>  = 0.0;
<a name="l01394"></a>01394      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a02ef249044b06a9e5fdc4ca8089b9231">didt</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a695f8cb0aac5e3b550b845f44c2924df">dmdt</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3fb10a17e6c143a5fab645c3e0b98e11">dnodt</a> = 0.0;
<a name="l01395"></a>01395      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac05e45d1246973a9a8546affabc14227">domdt</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9eacf102e1268b71c466ef684d89894d">e3</a>    = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a21e76be159604312f507b51c96cc96e6">ee2</a>   = 0.0;
<a name="l01396"></a>01396      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a03f656819059e7918aaac76bc6d41952">peo</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7ed720fe7860613acadf950654993f13">pgho</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acd215b2e1829d8bbb1cef7fafe7a2d38">pho</a>   = 0.0;
<a name="l01397"></a>01397      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a549cffe2ff75f58f2a87ebefb34d57b8">pinco</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8a9039a5d6f680f7afaa00cb59200e55">plo</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acb96292b29e70810885f7b87392b3440">se2</a>   = 0.0;
<a name="l01398"></a>01398      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aeb0954d6b88572d22011197971383314">se3</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a29e70825ad053b216468503455bb0214">sgh2</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a20c7463d9a37296e4f7593aef4b9dc54">sgh3</a>  = 0.0;
<a name="l01399"></a>01399      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47354314263672ffdc413e858d973796">sgh4</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8efadcbb15a1adbad8c11bf5f40a78a0">sh2</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8cae07adc4894d76f34f1151106b7c5a">sh3</a>   = 0.0;
<a name="l01400"></a>01400      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5726b45b77929f68360f45c10e691c38">si2</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab92ea3cda54836cf52f1f49a45a091d6">si3</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86aa5d798754dfa4980396b2e64dbe94">sl2</a>   = 0.0;
<a name="l01401"></a>01401      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47e07031ea280bbb8e83e806ce8a56f1">sl3</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a66240f96efc1da3dcae357b8d60abcf9">sl4</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a38a4546562b348f0890d4bf9c39e98b2">gsto</a>  = 0.0;
<a name="l01402"></a>01402      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#addb30c60d5ea06d984f90a6e04bce0e8">xfact</a> = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1bca79b6c4c54618eed4d63119b0e1f8">xgh2</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af05ab627562d999c64e336df0fa91648">xgh3</a>  = 0.0;
<a name="l01403"></a>01403      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2eae2d27e095fa865573eb1e7960b1d6">xgh4</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aacee312ecab1273b95338ee624cab26c">xh2</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4f3dfcf62b28e3edfd88c661dee36865">xh3</a>   = 0.0;
<a name="l01404"></a>01404      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0ed2e9d63d21b47f40e8c607d5a213a7">xi2</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a27d129b5fb6c31bb6f8078331ad96fc0">xi3</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#abf7ca8d516b87cce30507326c24dbd88">xl2</a>   = 0.0;
<a name="l01405"></a>01405      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a54bf99247669242d5c363ae466c296f7">xl3</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a807456dc2b50d3d68890b43771cc6d6c">xl4</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3c60763587db12c58b5644d40bfdb5d3">xlamo</a> = 0.0;
<a name="l01406"></a>01406      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aec34eac95a270e7c2b17d79380b9ec2f">zmol</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae613bff93cb6d8e07ef1c2d418dae7ae">zmos</a>  = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d54a44189d18c4636e1567f91940f5c">atime</a> = 0.0;
<a name="l01407"></a>01407      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#afd627bb2d2267d2ded602af8bd5905f4">xli</a>   = 0.0; satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae87a01e4666ac0918defce52457e6c16">xni</a>   = 0.0;
<a name="l01408"></a>01408 
<a name="l01409"></a>01409      <span class="comment">// sgp4fix - note the following variables are also passed directly via satrec.</span>
<a name="l01410"></a>01410      <span class="comment">// it is possible to streamline the sgp4init call by deleting the &quot;x&quot;</span>
<a name="l01411"></a>01411      <span class="comment">// variables, but the user would need to set the satrec.* values first. we</span>
<a name="l01412"></a>01412      <span class="comment">// include the additional assignments in case twoline2rv is not used.</span>
<a name="l01413"></a>01413          <span class="comment">//TLEを使わないで６要素を代入するとき用？</span>
<a name="l01414"></a>01414      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a>   = xbstar;
<a name="l01415"></a>01415      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>    = xecco;
<a name="l01416"></a>01416      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>   = xargpo;
<a name="l01417"></a>01417      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>   = xinclo;
<a name="l01418"></a>01418      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a>      = xmo;
<a name="l01419"></a>01419      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>      = xno;
<a name="l01420"></a>01420      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5c105875bca592c8e6b6d2ed88e9daca">nodeo</a>   = xnodeo;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422      <span class="comment">/* ------------------------ earth constants ----------------------- */</span>
<a name="l01423"></a>01423      <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01424"></a>01424      <a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">getgravconst</a>( whichconst, tumin, mu, radiusearthkm, xke, j2, j3, j4, j3oj2 );
<a name="l01425"></a>01425      ss     = 78.0 / radiusearthkm + 1.0;
<a name="l01426"></a>01426      qzms2t = pow(((120.0 - 78.0) / radiusearthkm), 4);
<a name="l01427"></a>01427      x2o3   =  2.0 / 3.0;
<a name="l01428"></a>01428 
<a name="l01429"></a>01429      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3a14295c4f7d70336f4d0c9059b6335c">init</a> = <span class="charliteral">&#39;y&#39;</span>;
<a name="l01430"></a>01430      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>    = 0.0;
<a name="l01431"></a>01431 
<a name="l01432"></a>01432      initl
<a name="l01433"></a>01433          (
<a name="l01434"></a>01434            satn, whichconst, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>, epoch, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a>,
<a name="l01435"></a>01435            ainv, ao, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a>, con42, cosio, cosio2, eccsq, omeosq,
<a name="l01436"></a>01436            posq, rp, rteosq, sinio, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a38a4546562b348f0890d4bf9c39e98b2">gsto</a>
<a name="l01437"></a>01437          );
<a name="l01438"></a>01438      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 0;
<a name="l01439"></a>01439 
<a name="l01440"></a>01440      <span class="keywordflow">if</span> (rp &lt; 1.0)
<a name="l01441"></a>01441        {
<a name="l01442"></a>01442 <span class="comment">//         printf(&quot;# *** satn%d epoch elts sub-orbital ***\n&quot;, satn);</span>
<a name="l01443"></a>01443          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 5;
<a name="l01444"></a>01444        }
<a name="l01445"></a>01445 
<a name="l01446"></a>01446      <span class="keywordflow">if</span> ((omeosq &gt;= 0.0 ) || ( satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> &gt;= 0.0))
<a name="l01447"></a>01447        {
<a name="l01448"></a>01448          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a> = 0;
<a name="l01449"></a>01449          <span class="keywordflow">if</span> (rp &lt; (220.0 / radiusearthkm + 1.0))
<a name="l01450"></a>01450              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a> = 1;
<a name="l01451"></a>01451          sfour  = ss;
<a name="l01452"></a>01452          qzms24 = qzms2t;
<a name="l01453"></a>01453          perige = (rp - 1.0) * radiusearthkm;
<a name="l01454"></a>01454 
<a name="l01455"></a>01455          <span class="comment">/* - for perigees below 156 km, s and qoms2t are altered - */</span>
<a name="l01456"></a>01456          <span class="keywordflow">if</span> (perige &lt; 156.0)
<a name="l01457"></a>01457            {
<a name="l01458"></a>01458              sfour = perige - 78.0;
<a name="l01459"></a>01459              <span class="keywordflow">if</span> (perige &lt; 98.0)
<a name="l01460"></a>01460                  sfour = 20.0;
<a name="l01461"></a>01461              qzms24 = pow(((120.0 - sfour) / radiusearthkm), 4.0);
<a name="l01462"></a>01462              sfour  = sfour / radiusearthkm + 1.0;
<a name="l01463"></a>01463            }
<a name="l01464"></a>01464          pinvsq = 1.0 / posq;
<a name="l01465"></a>01465 
<a name="l01466"></a>01466          tsi  = 1.0 / (ao - sfour);
<a name="l01467"></a>01467          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a>  = ao * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a> * tsi;
<a name="l01468"></a>01468          etasq = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a>;
<a name="l01469"></a>01469          eeta  = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a>;
<a name="l01470"></a>01470          psisq = fabs(1.0 - etasq);
<a name="l01471"></a>01471          coef  = qzms24 * pow(tsi, 4.0);
<a name="l01472"></a>01472          coef1 = coef / pow(psisq, 3.5);
<a name="l01473"></a>01473          cc2   = coef1 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> * (ao * (1.0 + 1.5 * etasq + eeta *
<a name="l01474"></a>01474                         (4.0 + etasq)) + 0.375 * j2 * tsi / psisq * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a> *
<a name="l01475"></a>01475                         (8.0 + 3.0 * etasq * (8.0 + etasq)));
<a name="l01476"></a>01476          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>   = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a> * cc2;
<a name="l01477"></a>01477          cc3   = 0.0;
<a name="l01478"></a>01478          <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a> &gt; 1.0e-4)
<a name="l01479"></a>01479              cc3 = -2.0 * coef * tsi * j3oj2 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> * sinio / satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>;
<a name="l01480"></a>01480          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> = 1.0 - cosio2;
<a name="l01481"></a>01481          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aae7fc51e21ea0269e24402e4d677f2db">cc4</a>    = 2.0* satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> * coef1 * ao * omeosq *
<a name="l01482"></a>01482                            (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a> * (2.0 + 0.5 * etasq) + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a> *
<a name="l01483"></a>01483                            (0.5 + 2.0 * etasq) - j2 * tsi / (ao * psisq) *
<a name="l01484"></a>01484                            (-3.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a> * (1.0 - 2.0 * eeta + etasq *
<a name="l01485"></a>01485                            (1.5 - 0.5 * eeta)) + 0.75 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> *
<a name="l01486"></a>01486                            (2.0 * etasq - eeta * (1.0 + etasq)) * cos(2.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>)));
<a name="l01487"></a>01487          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7c1f86f775aca064ee704ee42412ebfc">cc5</a> = 2.0 * coef1 * ao * omeosq * (1.0 + 2.75 *
<a name="l01488"></a>01488                         (etasq + eeta) + eeta * etasq);
<a name="l01489"></a>01489          cosio4 = cosio2 * cosio2;
<a name="l01490"></a>01490          temp1  = 1.5 * j2 * pinvsq * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>;
<a name="l01491"></a>01491          temp2  = 0.5 * temp1 * j2 * pinvsq;
<a name="l01492"></a>01492          temp3  = -0.46875 * j4 * pinvsq * pinvsq * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>;
<a name="l01493"></a>01493          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad3e5f43bf6e0edf97d4c5c13d1768a90">mdot</a>     = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> + 0.5 * temp1 * rteosq * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a> + 0.0625 *
<a name="l01494"></a>01494                             temp2 * rteosq * (13.0 - 78.0 * cosio2 + 137.0 * cosio4);
<a name="l01495"></a>01495          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3794dfa4655891ff11ef04d30ce20e34">argpdot</a>  = -0.5 * temp1 * con42 + 0.0625 * temp2 *
<a name="l01496"></a>01496                              (7.0 - 114.0 * cosio2 + 395.0 * cosio4) +
<a name="l01497"></a>01497                              temp3 * (3.0 - 36.0 * cosio2 + 49.0 * cosio4);
<a name="l01498"></a>01498          xhdot1            = -temp1 * cosio;
<a name="l01499"></a>01499          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6624e53fad0564a2e3fba8197a87cd2b">nodedot</a> = xhdot1 + (0.5 * temp2 * (4.0 - 19.0 * cosio2) +
<a name="l01500"></a>01500                               2.0 * temp3 * (3.0 - 7.0 * cosio2)) * cosio;
<a name="l01501"></a>01501          xpidot            =  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3794dfa4655891ff11ef04d30ce20e34">argpdot</a>+ satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6624e53fad0564a2e3fba8197a87cd2b">nodedot</a>;
<a name="l01502"></a>01502          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1a3066b5b1e170b1b54b6e1ebb95dde1">omgcof</a>   = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a> * cc3 * cos(satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>);
<a name="l01503"></a>01503          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2cd45705ee518d0c2159e7d0d5e73c68">xmcof</a>    = 0.0;
<a name="l01504"></a>01504          <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a> &gt; 1.0e-4)
<a name="l01505"></a>01505              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2cd45705ee518d0c2159e7d0d5e73c68">xmcof</a> = -x2o3 * coef * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a> / eeta;
<a name="l01506"></a>01506          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad31d1bb03dbc1676425a7756d8d89a8c">nodecf</a> = 3.5 * omeosq * xhdot1 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>;
<a name="l01507"></a>01507          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9406c83b6827ed0c886718636759a89c">t2cof</a>   = 1.5 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>;
<a name="l01508"></a>01508          <span class="comment">// sgp4fix for divide by zero with xinco = 180 deg</span>
<a name="l01509"></a>01509          <span class="keywordflow">if</span> (fabs(cosio+1.0) &gt; 1.5e-12)
<a name="l01510"></a>01510              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a> = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / (1.0 + cosio);
<a name="l01511"></a>01511            <span class="keywordflow">else</span>
<a name="l01512"></a>01512              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a> = -0.25 * j3oj2 * sinio * (3.0 + 5.0 * cosio) / temp4;
<a name="l01513"></a>01513          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6628418041a8ebe808d4cb5322c48f83">aycof</a>   = -0.5 * j3oj2 * sinio;
<a name="l01514"></a>01514          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4d61c03338eb47ff5cb5159289a8b8ab">delmo</a>   = pow((1.0 + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a> * cos(satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a>)), 3);
<a name="l01515"></a>01515          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac1728506007ef3f8efc09ccfea258621">sinmao</a>  = sin(satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a>);
<a name="l01516"></a>01516          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a778cfb16c16daf12b5838cec9e0ec4c9">x7thm1</a>  = 7.0 * cosio2 - 1.0;
<a name="l01517"></a>01517 
<a name="l01518"></a>01518          <span class="comment">/* --------------- deep space initialization ------------- */</span>
<a name="l01519"></a>01519          <span class="keywordflow">if</span> ((2*<a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a> / satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>) &gt;= 225.0)
<a name="l01520"></a>01520            {
<a name="l01521"></a>01521              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> = <span class="charliteral">&#39;d&#39;</span>;
<a name="l01522"></a>01522              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a>  = 1;
<a name="l01523"></a>01523              tc    =  0.0;
<a name="l01524"></a>01524              inclm = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>;
<a name="l01525"></a>01525 
<a name="l01526"></a>01526              dscom
<a name="l01527"></a>01527                  (
<a name="l01528"></a>01528                    epoch, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>, tc, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5c105875bca592c8e6b6d2ed88e9daca">nodeo</a>,
<a name="l01529"></a>01529                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>, snodm, cnodm,  sinim, cosim, sinomm,     cosomm,
<a name="l01530"></a>01530                    day, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9eacf102e1268b71c466ef684d89894d">e3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a21e76be159604312f507b51c96cc96e6">ee2</a>, em,         emsq, gam,
<a name="l01531"></a>01531                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a03f656819059e7918aaac76bc6d41952">peo</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7ed720fe7860613acadf950654993f13">pgho</a>,   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acd215b2e1829d8bbb1cef7fafe7a2d38">pho</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a549cffe2ff75f58f2a87ebefb34d57b8">pinco</a>,
<a name="l01532"></a>01532                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8a9039a5d6f680f7afaa00cb59200e55">plo</a>,  rtemsq,        satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acb96292b29e70810885f7b87392b3440">se2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aeb0954d6b88572d22011197971383314">se3</a>,
<a name="l01533"></a>01533                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a29e70825ad053b216468503455bb0214">sgh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a20c7463d9a37296e4f7593aef4b9dc54">sgh3</a>,   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47354314263672ffdc413e858d973796">sgh4</a>,
<a name="l01534"></a>01534                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8efadcbb15a1adbad8c11bf5f40a78a0">sh2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8cae07adc4894d76f34f1151106b7c5a">sh3</a>,    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5726b45b77929f68360f45c10e691c38">si2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab92ea3cda54836cf52f1f49a45a091d6">si3</a>,
<a name="l01535"></a>01535                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86aa5d798754dfa4980396b2e64dbe94">sl2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47e07031ea280bbb8e83e806ce8a56f1">sl3</a>,    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a66240f96efc1da3dcae357b8d60abcf9">sl4</a>, s1, s2, s3, s4, s5,
<a name="l01536"></a>01536                    s6,   s7,   ss1,  ss2,  ss3,  ss4,  ss5,  ss6,  ss7, sz1, sz2, sz3,
<a name="l01537"></a>01537                    sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33,
<a name="l01538"></a>01538                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1bca79b6c4c54618eed4d63119b0e1f8">xgh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af05ab627562d999c64e336df0fa91648">xgh3</a>,   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2eae2d27e095fa865573eb1e7960b1d6">xgh4</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aacee312ecab1273b95338ee624cab26c">xh2</a>,
<a name="l01539"></a>01539                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4f3dfcf62b28e3edfd88c661dee36865">xh3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0ed2e9d63d21b47f40e8c607d5a213a7">xi2</a>,    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a27d129b5fb6c31bb6f8078331ad96fc0">xi3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#abf7ca8d516b87cce30507326c24dbd88">xl2</a>,
<a name="l01540"></a>01540                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a54bf99247669242d5c363ae466c296f7">xl3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a807456dc2b50d3d68890b43771cc6d6c">xl4</a>,    nm, z1, z2, z3, z11,
<a name="l01541"></a>01541                    z12, z13, z21, z22, z23, z31, z32, z33,
<a name="l01542"></a>01542                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aec34eac95a270e7c2b17d79380b9ec2f">zmol</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae613bff93cb6d8e07ef1c2d418dae7ae">zmos</a>
<a name="l01543"></a>01543                  );
<a name="l01544"></a>01544              dpper
<a name="l01545"></a>01545                  (
<a name="l01546"></a>01546                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9eacf102e1268b71c466ef684d89894d">e3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a21e76be159604312f507b51c96cc96e6">ee2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a03f656819059e7918aaac76bc6d41952">peo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7ed720fe7860613acadf950654993f13">pgho</a>,
<a name="l01547"></a>01547                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acd215b2e1829d8bbb1cef7fafe7a2d38">pho</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a549cffe2ff75f58f2a87ebefb34d57b8">pinco</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8a9039a5d6f680f7afaa00cb59200e55">plo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acb96292b29e70810885f7b87392b3440">se2</a>,
<a name="l01548"></a>01548                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aeb0954d6b88572d22011197971383314">se3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a29e70825ad053b216468503455bb0214">sgh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a20c7463d9a37296e4f7593aef4b9dc54">sgh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47354314263672ffdc413e858d973796">sgh4</a>,
<a name="l01549"></a>01549                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8efadcbb15a1adbad8c11bf5f40a78a0">sh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8cae07adc4894d76f34f1151106b7c5a">sh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5726b45b77929f68360f45c10e691c38">si2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab92ea3cda54836cf52f1f49a45a091d6">si3</a>,
<a name="l01550"></a>01550                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86aa5d798754dfa4980396b2e64dbe94">sl2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47e07031ea280bbb8e83e806ce8a56f1">sl3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a66240f96efc1da3dcae357b8d60abcf9">sl4</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>,
<a name="l01551"></a>01551                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1bca79b6c4c54618eed4d63119b0e1f8">xgh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af05ab627562d999c64e336df0fa91648">xgh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2eae2d27e095fa865573eb1e7960b1d6">xgh4</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aacee312ecab1273b95338ee624cab26c">xh2</a>,
<a name="l01552"></a>01552                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4f3dfcf62b28e3edfd88c661dee36865">xh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0ed2e9d63d21b47f40e8c607d5a213a7">xi2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a27d129b5fb6c31bb6f8078331ad96fc0">xi3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#abf7ca8d516b87cce30507326c24dbd88">xl2</a>,
<a name="l01553"></a>01553                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a54bf99247669242d5c363ae466c296f7">xl3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a807456dc2b50d3d68890b43771cc6d6c">xl4</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aec34eac95a270e7c2b17d79380b9ec2f">zmol</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae613bff93cb6d8e07ef1c2d418dae7ae">zmos</a>, inclm, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3a14295c4f7d70336f4d0c9059b6335c">init</a>,
<a name="l01554"></a>01554                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5c105875bca592c8e6b6d2ed88e9daca">nodeo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a>
<a name="l01555"></a>01555                  );
<a name="l01556"></a>01556 
<a name="l01557"></a>01557              argpm  = 0.0;
<a name="l01558"></a>01558              nodem  = 0.0;
<a name="l01559"></a>01559              mm     = 0.0;
<a name="l01560"></a>01560 
<a name="l01561"></a>01561              dsinit
<a name="l01562"></a>01562                  (
<a name="l01563"></a>01563                    whichconst,
<a name="l01564"></a>01564                    cosim, emsq, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>, s1, s2, s3, s4, s5, sinim, ss1, ss2, ss3, ss4,
<a name="l01565"></a>01565                    ss5, sz1, sz3, sz11, sz13, sz21, sz23, sz31, sz33, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>, tc,
<a name="l01566"></a>01566                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a38a4546562b348f0890d4bf9c39e98b2">gsto</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad3e5f43bf6e0edf97d4c5c13d1768a90">mdot</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5c105875bca592c8e6b6d2ed88e9daca">nodeo</a>,
<a name="l01567"></a>01567                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6624e53fad0564a2e3fba8197a87cd2b">nodedot</a>, xpidot, z1, z3, z11, z13, z21, z23, z31, z33,
<a name="l01568"></a>01568                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>, eccsq, em, argpm, inclm, mm, nm, nodem,
<a name="l01569"></a>01569                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b5682d73c044235a090201f327770c1">irez</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d54a44189d18c4636e1567f91940f5c">atime</a>,
<a name="l01570"></a>01570                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aac83ffb5c1170491175bb9c617ed1b9a">d2201</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a69d0c093b184a168557344a6c693082f">d2211</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae71649dd5d5786ba38a6729b41ee0c9b">d3210</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea737c740844f44e6855db3cf8ff0c4f">d3222</a> ,
<a name="l01571"></a>01571                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a130498f44d3fc5ce920e62e7cfa68a2b">d4410</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a81e28e9fe4d5ca7ad94ac482468a0871">d4422</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a91109cb1efb96c6726c64745aae89994">d5220</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86fbaaf3d669c3a6ba359f20eb120378">d5232</a>,
<a name="l01572"></a>01572                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af0eaed781559fa4dcb0d4b090d74c9c1">d5421</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad407f986f615de2a613e0bdf2bac763d">d5433</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a724907a580d1b66425aaa0c1f8482668">dedt</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a02ef249044b06a9e5fdc4ca8089b9231">didt</a>,
<a name="l01573"></a>01573                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a695f8cb0aac5e3b550b845f44c2924df">dmdt</a>,  dndt,         satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3fb10a17e6c143a5fab645c3e0b98e11">dnodt</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac05e45d1246973a9a8546affabc14227">domdt</a> ,
<a name="l01574"></a>01574                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a95ac15d69f7e75a08904205f36678460">del1</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0b7270c4f4244227b98f47485e756278">del2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af4fb07427d4dcd3d843fbc16bb53a233">del3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#addb30c60d5ea06d984f90a6e04bce0e8">xfact</a>,
<a name="l01575"></a>01575                    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3c60763587db12c58b5644d40bfdb5d3">xlamo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#afd627bb2d2267d2ded602af8bd5905f4">xli</a>,   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae87a01e4666ac0918defce52457e6c16">xni</a>
<a name="l01576"></a>01576                  );
<a name="l01577"></a>01577            }
<a name="l01578"></a>01578 
<a name="l01579"></a>01579        <span class="comment">/* ----------- set variables if not deep space ----------- */</span>
<a name="l01580"></a>01580        <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a> != 1)
<a name="l01581"></a>01581          {
<a name="l01582"></a>01582            cc1sq          = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>;
<a name="l01583"></a>01583            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a>    = 4.0 * ao * tsi * cc1sq;
<a name="l01584"></a>01584            temp           = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> * tsi * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a> / 3.0;
<a name="l01585"></a>01585            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2448c199295591c61cf9962872f2bb62">d3</a>    = (17.0 * ao + sfour) * temp;
<a name="l01586"></a>01586            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acec9f436198a40930b88133e8e388ef3">d4</a>    = 0.5 * temp * ao * tsi * (221.0 * ao + 31.0 * sfour) *
<a name="l01587"></a>01587                             satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a>;
<a name="l01588"></a>01588            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a92b9a67758364f84cac8fe1d2231664c">t3cof</a> = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> + 2.0 * cc1sq;
<a name="l01589"></a>01589            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b4b9d524f7a78a7621af6967fe97c0f">t4cof</a> = 0.25 * (3.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2448c199295591c61cf9962872f2bb62">d3</a> + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a> *
<a name="l01590"></a>01590                             (12.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> + 10.0 * cc1sq));
<a name="l01591"></a>01591            satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d7e5b2212e83963aa032e8977853072">t5cof</a> = 0.2 * (3.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acec9f436198a40930b88133e8e388ef3">d4</a> +
<a name="l01592"></a>01592                             12.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2448c199295591c61cf9962872f2bb62">d3</a> +
<a name="l01593"></a>01593                             6.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> +
<a name="l01594"></a>01594                             15.0 * cc1sq * (2.0 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> + cc1sq));
<a name="l01595"></a>01595          }
<a name="l01596"></a>01596        } <span class="comment">// if omeosq = 0 ...</span>
<a name="l01597"></a>01597 
<a name="l01598"></a>01598        <span class="comment">/* finally propogate to zero epoch to initialise all others. */</span>
<a name="l01599"></a>01599        <span class="keywordflow">if</span>(satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> == 0)
<a name="l01600"></a>01600            <a class="code" href="namespacesgp4.html#adee1a80d66854d4af45c2a24df69a594">sgp4</a>(whichconst, satrec, 0.0, r, v);
<a name="l01601"></a>01601 
<a name="l01602"></a>01602        satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3a14295c4f7d70336f4d0c9059b6335c">init</a> = <span class="charliteral">&#39;n&#39;</span>;
<a name="l01603"></a>01603 
<a name="l01604"></a>01604 <span class="comment">//#include &quot;debug6.cpp&quot;</span>
<a name="l01605"></a>01605        <span class="keywordflow">return</span> satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a>;
<a name="l01606"></a>01606 }  <span class="comment">// end sgp4init</span>
<a name="l01607"></a>01607 
<a name="l01608"></a>01608 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01609"></a>01609 <span class="comment">*</span>
<a name="l01610"></a>01610 <span class="comment">*                             procedure sgp4</span>
<a name="l01611"></a>01611 <span class="comment">*</span>
<a name="l01612"></a>01612 <span class="comment">*       SGP4の計算</span>
<a name="l01613"></a>01613 <span class="comment">*       AIAA-2006に基づいており、このバージョンではSGP4とSDP4を併せて書いている。</span>
<a name="l01614"></a>01614 <span class="comment">*       軌道周期が225secより長いか短いかでDEEPSPACEかどうか条件分岐している(satrec.method)</span>
<a name="l01615"></a>01615 <span class="comment">*</span>
<a name="l01616"></a>01616 <span class="comment">*  this procedure is the sgp4 prediction model from space command. this is an</span>
<a name="l01617"></a>01617 <span class="comment">*    updated and combined version of sgp4 and sdp4, which were originally</span>
<a name="l01618"></a>01618 <span class="comment">*    published separately in spacetrack report #3. this version follows the</span>
<a name="l01619"></a>01619 <span class="comment">*    methodology from the aiaa paper (2006) describing the history and</span>
<a name="l01620"></a>01620 <span class="comment">*    development of the code.</span>
<a name="l01621"></a>01621 <span class="comment">*</span>
<a name="l01622"></a>01622 <span class="comment">*  author        : david vallado                  719-573-2600   28 jun 2005</span>
<a name="l01623"></a>01623 <span class="comment">*</span>
<a name="l01624"></a>01624 <span class="comment">*  inputs        :</span>
<a name="l01625"></a>01625 <span class="comment">*    satrec      - initialised structure from sgp4init() call.</span>
<a name="l01626"></a>01626 <span class="comment">*    tsince      - time eince epoch (minutes)   元期からの経過時間</span>
<a name="l01627"></a>01627 <span class="comment">*</span>
<a name="l01628"></a>01628 <span class="comment">*  outputs       :</span>
<a name="l01629"></a>01629 <span class="comment">*    r           - position vector                     km</span>
<a name="l01630"></a>01630 <span class="comment">*    v           - velocity                            km/sec</span>
<a name="l01631"></a>01631 <span class="comment">*  return code - non-zero on error.</span>
<a name="l01632"></a>01632 <span class="comment">*                   1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span>
<a name="l01633"></a>01633 <span class="comment">*                   2 - mean motion less than 0.0</span>
<a name="l01634"></a>01634 <span class="comment">*                   3 - pert elements, ecc &lt; 0.0  or  ecc &gt; 1.0</span>
<a name="l01635"></a>01635 <span class="comment">*                   4 - semi-latus rectum &lt; 0.0</span>
<a name="l01636"></a>01636 <span class="comment">*                   5 - epoch elements are sub-orbital</span>
<a name="l01637"></a>01637 <span class="comment">*                   6 - satellite has decayed</span>
<a name="l01638"></a>01638 <span class="comment">*</span>
<a name="l01639"></a>01639 <span class="comment">*  locals        :</span>
<a name="l01640"></a>01640 <span class="comment">*    am          -</span>
<a name="l01641"></a>01641 <span class="comment">*    axnl, aynl        -</span>
<a name="l01642"></a>01642 <span class="comment">*    betal       -</span>
<a name="l01643"></a>01643 <span class="comment">*    cosim   , sinim   , cosomm  , sinomm  , cnod    , snod    , cos2u   ,</span>
<a name="l01644"></a>01644 <span class="comment">*    sin2u   , coseo1  , sineo1  , cosi    , sini    , cosip   , sinip   ,</span>
<a name="l01645"></a>01645 <span class="comment">*    cosisq  , cossu   , sinsu   , cosu    , sinu</span>
<a name="l01646"></a>01646 <span class="comment">*    delm        -</span>
<a name="l01647"></a>01647 <span class="comment">*    delomg      -</span>
<a name="l01648"></a>01648 <span class="comment">*    dndt        -</span>
<a name="l01649"></a>01649 <span class="comment">*    eccm        -</span>
<a name="l01650"></a>01650 <span class="comment">*    emsq        -</span>
<a name="l01651"></a>01651 <span class="comment">*    ecose       -</span>
<a name="l01652"></a>01652 <span class="comment">*    el2         -</span>
<a name="l01653"></a>01653 <span class="comment">*    eo1         -</span>
<a name="l01654"></a>01654 <span class="comment">*    eccp        -</span>
<a name="l01655"></a>01655 <span class="comment">*    esine       -</span>
<a name="l01656"></a>01656 <span class="comment">*    argpm       -</span>
<a name="l01657"></a>01657 <span class="comment">*    argpp       -</span>
<a name="l01658"></a>01658 <span class="comment">*    omgadf      -</span>
<a name="l01659"></a>01659 <span class="comment">*    pl          -</span>
<a name="l01660"></a>01660 <span class="comment">*    r           -</span>
<a name="l01661"></a>01661 <span class="comment">*    rtemsq      -</span>
<a name="l01662"></a>01662 <span class="comment">*    rdotl       -</span>
<a name="l01663"></a>01663 <span class="comment">*    rl          -</span>
<a name="l01664"></a>01664 <span class="comment">*    rvdot       -</span>
<a name="l01665"></a>01665 <span class="comment">*    rvdotl      -</span>
<a name="l01666"></a>01666 <span class="comment">*    su          -</span>
<a name="l01667"></a>01667 <span class="comment">*    t2  , t3   , t4    , tc</span>
<a name="l01668"></a>01668 <span class="comment">*    tem5, temp , temp1 , temp2  , tempa  , tempe  , templ</span>
<a name="l01669"></a>01669 <span class="comment">*    u   , ux   , uy    , uz     , vx     , vy     , vz</span>
<a name="l01670"></a>01670 <span class="comment">*    inclm       - inclination</span>
<a name="l01671"></a>01671 <span class="comment">*    mm          - mean anomaly</span>
<a name="l01672"></a>01672 <span class="comment">*    nm          - mean motion</span>
<a name="l01673"></a>01673 <span class="comment">*    nodem       - right asc of ascending node</span>
<a name="l01674"></a>01674 <span class="comment">*    xinc        -</span>
<a name="l01675"></a>01675 <span class="comment">*    xincp       -</span>
<a name="l01676"></a>01676 <span class="comment">*    xl          -</span>
<a name="l01677"></a>01677 <span class="comment">*    xlm         -</span>
<a name="l01678"></a>01678 <span class="comment">*    mp          -</span>
<a name="l01679"></a>01679 <span class="comment">*    xmdf        -</span>
<a name="l01680"></a>01680 <span class="comment">*    xmx         -</span>
<a name="l01681"></a>01681 <span class="comment">*    xmy         -</span>
<a name="l01682"></a>01682 <span class="comment">*    nodedf      -</span>
<a name="l01683"></a>01683 <span class="comment">*    xnode       -</span>
<a name="l01684"></a>01684 <span class="comment">*    nodep       -</span>
<a name="l01685"></a>01685 <span class="comment">*    np          -</span>
<a name="l01686"></a>01686 <span class="comment">*</span>
<a name="l01687"></a>01687 <span class="comment">*  coupling      :</span>
<a name="l01688"></a>01688 <span class="comment">*    getgravconst-</span>
<a name="l01689"></a>01689 <span class="comment">*    dpper</span>
<a name="l01690"></a>01690 <span class="comment">*    dpspace</span>
<a name="l01691"></a>01691 <span class="comment">*</span>
<a name="l01692"></a>01692 <span class="comment">*  references    :</span>
<a name="l01693"></a>01693 <span class="comment">*    hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01694"></a>01694 <span class="comment">*    hoots, norad spacetrack report #6 1986</span>
<a name="l01695"></a>01695 <span class="comment">*    hoots, schumacher and glover 2004</span>
<a name="l01696"></a>01696 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l01697"></a>01697 <span class="comment">  ----------------------------------------------------------------------------*/</span>
<a name="l01698"></a>01698 
<a name="l01699"></a>01699 <span class="keywordtype">int</span> <a class="code" href="namespacesgp4.html#adee1a80d66854d4af45c2a24df69a594">sgp4</a>
<a name="l01700"></a><a class="code" href="namespacesgp4.html#adee1a80d66854d4af45c2a24df69a594">01700</a>      (
<a name="l01701"></a>01701        <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst, <a class="code" href="structsgp4_1_1elsetrec.html">elsetrec</a>&amp; satrec,  <span class="keywordtype">double</span> tsince,
<a name="l01702"></a>01702        <span class="keywordtype">double</span> r[3],  <span class="keywordtype">double</span> <a class="code" href="namespacestf.html#afa89a4a0c80d3727c2f396aa3ead41cd">v</a>[3]
<a name="l01703"></a>01703      )
<a name="l01704"></a>01704 {
<a name="l01705"></a>01705      <span class="keywordtype">double</span> am   , axnl  , aynl , betal ,  cosim , cnod  ,
<a name="l01706"></a>01706          cos2u, coseo1, cosi , cosip ,  cosisq, cossu , cosu,
<a name="l01707"></a>01707          delm , delomg, em   , emsq  ,  ecose , el2   , eo1 ,
<a name="l01708"></a>01708          ep   , esine , argpm, argpp ,  argpdf, pl,     mrt = 0.0,
<a name="l01709"></a>01709          mvt  , rdotl , rl   , rvdot ,  rvdotl, sinim ,
<a name="l01710"></a>01710          sin2u, sineo1, sini , sinip ,  sinsu , sinu  ,
<a name="l01711"></a>01711          snod , su    , t2   , t3    ,  t4    , tem5  , temp,
<a name="l01712"></a>01712          temp1, temp2 , tempa, tempe ,  templ , u     , ux  ,
<a name="l01713"></a>01713          uy   , uz    , vx   , vy    ,  vz    , inclm , mm  ,
<a name="l01714"></a>01714          nm   , nodem, xinc , xincp ,  xl    , xlm   , mp  ,
<a name="l01715"></a>01715          xmdf , xmx   , xmy  , nodedf, xnode , nodep, tc  , dndt,
<a name="l01716"></a>01716          twopi, x2o3  , j2   , j3    , tumin, j4 , xke   , j3oj2, radiusearthkm,
<a name="l01717"></a>01717          mu, vkmpersec;
<a name="l01718"></a>01718      <span class="keywordtype">int</span> ktr;
<a name="l01719"></a>01719 
<a name="l01720"></a>01720      <span class="comment">/* ------------------ set mathematical constants --------------- */</span>
<a name="l01721"></a>01721      <span class="comment">// sgp4fix divisor for divide by zero check on inclination</span>
<a name="l01722"></a>01722      <span class="keyword">const</span> <span class="keywordtype">double</span> temp4    =   1.0 + cos(<a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>-1.0e-9);
<a name="l01723"></a>01723      twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l01724"></a>01724      x2o3  = 2.0 / 3.0;
<a name="l01725"></a>01725      <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01726"></a>01726      <a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">getgravconst</a>( whichconst, tumin, mu, radiusearthkm, xke, j2, j3, j4, j3oj2 );
<a name="l01727"></a>01727      vkmpersec     = radiusearthkm * xke/60.0;
<a name="l01728"></a>01728 
<a name="l01729"></a>01729      <span class="comment">/* --------------------- clear sgp4 error flag ----------------- */</span>
<a name="l01730"></a>01730      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>     = tsince;
<a name="l01731"></a>01731      satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 0;
<a name="l01732"></a>01732 
<a name="l01733"></a>01733      <span class="comment">/* ------- update for secular gravity and atmospheric drag ----- */</span>
<a name="l01734"></a>01734          <span class="comment">//永続的な重力と大気抵抗のアップデート</span>
<a name="l01735"></a>01735      xmdf    = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aaccdff46abfb7e511b85796baf2d3651">mo</a> + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad3e5f43bf6e0edf97d4c5c13d1768a90">mdot</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01736"></a>01736      argpdf  = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a> + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3794dfa4655891ff11ef04d30ce20e34">argpdot</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01737"></a>01737      nodedf  = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5c105875bca592c8e6b6d2ed88e9daca">nodeo</a> + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6624e53fad0564a2e3fba8197a87cd2b">nodedot</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01738"></a>01738      argpm   = argpdf;
<a name="l01739"></a>01739      mm      = xmdf;
<a name="l01740"></a>01740      t2      = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01741"></a>01741      nodem   = nodedf + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad31d1bb03dbc1676425a7756d8d89a8c">nodecf</a> * t2;
<a name="l01742"></a>01742      tempa   = 1.0 - satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aa3ec27519ffb3b4452deb061cc2cdb90">cc1</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01743"></a>01743      tempe   = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aae7fc51e21ea0269e24402e4d677f2db">cc4</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01744"></a>01744      templ   = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9406c83b6827ed0c886718636759a89c">t2cof</a> * t2;
<a name="l01745"></a>01745 
<a name="l01746"></a>01746      <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a876864ac3959dae82f1c15d90491b5d7">isimp</a> != 1)
<a name="l01747"></a>01747        {
<a name="l01748"></a>01748          delomg = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1a3066b5b1e170b1b54b6e1ebb95dde1">omgcof</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01749"></a>01749          delm   = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2cd45705ee518d0c2159e7d0d5e73c68">xmcof</a> *
<a name="l01750"></a>01750                   (pow((1.0 + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#adc39edc5028b8ebc12e8659645640868">eta</a> * cos(xmdf)), 3) -
<a name="l01751"></a>01751                   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4d61c03338eb47ff5cb5159289a8b8ab">delmo</a>);
<a name="l01752"></a>01752          temp   = delomg + delm;
<a name="l01753"></a>01753          mm     = xmdf + temp;
<a name="l01754"></a>01754          argpm  = argpdf - temp;
<a name="l01755"></a>01755          t3     = t2 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01756"></a>01756          t4     = t3 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01757"></a>01757          tempa  = tempa - satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad626d3e0c9ff30b82f1f45256116bfe0">d2</a> * t2 - satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2448c199295591c61cf9962872f2bb62">d3</a> * t3 -
<a name="l01758"></a>01758                           satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acec9f436198a40930b88133e8e388ef3">d4</a> * t4;
<a name="l01759"></a>01759          tempe  = tempe + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad233e8f033deadeb4fba78afca69f1e2">bstar</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7c1f86f775aca064ee704ee42412ebfc">cc5</a> * (sin(mm) -
<a name="l01760"></a>01760                           satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac1728506007ef3f8efc09ccfea258621">sinmao</a>);
<a name="l01761"></a>01761          templ  = templ + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a92b9a67758364f84cac8fe1d2231664c">t3cof</a> * t3 + t4 * (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b4b9d524f7a78a7621af6967fe97c0f">t4cof</a> +
<a name="l01762"></a>01762                           satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a> * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d7e5b2212e83963aa032e8977853072">t5cof</a>);
<a name="l01763"></a>01763        }
<a name="l01764"></a>01764 
<a name="l01765"></a>01765      nm    = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>;
<a name="l01766"></a>01766      em    = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea8f7ce64ca1d8ac15e199800cb4ec2d">ecco</a>;
<a name="l01767"></a>01767      inclm = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>;
<a name="l01768"></a>01768      <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> == <span class="charliteral">&#39;d&#39;</span>)
<a name="l01769"></a>01769        {
<a name="l01770"></a>01770          tc = satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>;
<a name="l01771"></a>01771          dspace
<a name="l01772"></a>01772              (
<a name="l01773"></a>01773                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5b5682d73c044235a090201f327770c1">irez</a>,
<a name="l01774"></a>01774                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aac83ffb5c1170491175bb9c617ed1b9a">d2201</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a69d0c093b184a168557344a6c693082f">d2211</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae71649dd5d5786ba38a6729b41ee0c9b">d3210</a>,
<a name="l01775"></a>01775                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aea737c740844f44e6855db3cf8ff0c4f">d3222</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a130498f44d3fc5ce920e62e7cfa68a2b">d4410</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a81e28e9fe4d5ca7ad94ac482468a0871">d4422</a>,
<a name="l01776"></a>01776                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a91109cb1efb96c6726c64745aae89994">d5220</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86fbaaf3d669c3a6ba359f20eb120378">d5232</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af0eaed781559fa4dcb0d4b090d74c9c1">d5421</a>,
<a name="l01777"></a>01777                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad407f986f615de2a613e0bdf2bac763d">d5433</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a724907a580d1b66425aaa0c1f8482668">dedt</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a95ac15d69f7e75a08904205f36678460">del1</a>,
<a name="l01778"></a>01778                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0b7270c4f4244227b98f47485e756278">del2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af4fb07427d4dcd3d843fbc16bb53a233">del3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a02ef249044b06a9e5fdc4ca8089b9231">didt</a>,
<a name="l01779"></a>01779                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a695f8cb0aac5e3b550b845f44c2924df">dmdt</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3fb10a17e6c143a5fab645c3e0b98e11">dnodt</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ac05e45d1246973a9a8546affabc14227">domdt</a>,
<a name="l01780"></a>01780                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a073ae4cc4c39266a89e0af4d00a5b0c9">argpo</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3794dfa4655891ff11ef04d30ce20e34">argpdot</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>, tc,
<a name="l01781"></a>01781                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a38a4546562b348f0890d4bf9c39e98b2">gsto</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#addb30c60d5ea06d984f90a6e04bce0e8">xfact</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a3c60763587db12c58b5644d40bfdb5d3">xlamo</a>,
<a name="l01782"></a>01782                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5d54a44189d18c4636e1567f91940f5c">atime</a>,
<a name="l01783"></a>01783                em, argpm, inclm, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#afd627bb2d2267d2ded602af8bd5905f4">xli</a>, mm, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae87a01e4666ac0918defce52457e6c16">xni</a>,
<a name="l01784"></a>01784                nodem, dndt, nm
<a name="l01785"></a>01785              );
<a name="l01786"></a>01786        } <span class="comment">// if method = d</span>
<a name="l01787"></a>01787 
<a name="l01788"></a>01788      <span class="keywordflow">if</span> (nm &lt;= 0.0)
<a name="l01789"></a>01789        {
<a name="l01790"></a>01790 <span class="comment">//         printf(&quot;# error nm %f\n&quot;, nm);</span>
<a name="l01791"></a>01791          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 2;
<a name="l01792"></a>01792        }
<a name="l01793"></a>01793      am = pow((xke / nm), x2o3) * tempa * tempa;
<a name="l01794"></a>01794      nm = xke / pow(am, 1.5);
<a name="l01795"></a>01795      em = em - tempe;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797      <span class="comment">// fix tolerance for error recognition</span>
<a name="l01798"></a>01798      <span class="keywordflow">if</span> ((em &gt;= 1.0) || (em &lt; -0.001) || (am &lt; 0.95))
<a name="l01799"></a>01799        {
<a name="l01800"></a>01800 <span class="comment">//         printf(&quot;# error em %f\n&quot;, em);</span>
<a name="l01801"></a>01801          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 1;
<a name="l01802"></a>01802        }
<a name="l01803"></a>01803      <span class="keywordflow">if</span> (em &lt; 0.0)
<a name="l01804"></a>01804          em  = 1.0e-6;
<a name="l01805"></a>01805      mm     = mm + satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab27aa09ea2d04427a21ddb763ca3c449">no</a> * templ;
<a name="l01806"></a>01806      xlm    = mm + argpm + nodem;
<a name="l01807"></a>01807      emsq   = em * em;
<a name="l01808"></a>01808      temp   = 1.0 - emsq;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810      nodem  = fmod(nodem, twopi);
<a name="l01811"></a>01811      argpm  = fmod(argpm, twopi);
<a name="l01812"></a>01812      xlm    = fmod(xlm, twopi);
<a name="l01813"></a>01813      mm     = fmod(xlm - argpm - nodem, twopi);
<a name="l01814"></a>01814 
<a name="l01815"></a>01815      <span class="comment">/* ----------------- compute extra mean quantities ------------- */</span>
<a name="l01816"></a>01816      sinim = sin(inclm);
<a name="l01817"></a>01817      cosim = cos(inclm);
<a name="l01818"></a>01818 
<a name="l01819"></a>01819      <span class="comment">/* -------------------- add lunar-solar periodics -------------- */</span>
<a name="l01820"></a>01820      ep     = em;
<a name="l01821"></a>01821      xincp  = inclm;
<a name="l01822"></a>01822      argpp  = argpm;
<a name="l01823"></a>01823      nodep  = nodem;
<a name="l01824"></a>01824      mp     = mm;
<a name="l01825"></a>01825      sinip  = sinim;
<a name="l01826"></a>01826      cosip  = cosim;
<a name="l01827"></a>01827      <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> == <span class="charliteral">&#39;d&#39;</span>)
<a name="l01828"></a>01828        {
<a name="l01829"></a>01829          dpper
<a name="l01830"></a>01830              (
<a name="l01831"></a>01831                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a9eacf102e1268b71c466ef684d89894d">e3</a>,   satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a21e76be159604312f507b51c96cc96e6">ee2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a03f656819059e7918aaac76bc6d41952">peo</a>,
<a name="l01832"></a>01832                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a7ed720fe7860613acadf950654993f13">pgho</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acd215b2e1829d8bbb1cef7fafe7a2d38">pho</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a549cffe2ff75f58f2a87ebefb34d57b8">pinco</a>,
<a name="l01833"></a>01833                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8a9039a5d6f680f7afaa00cb59200e55">plo</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acb96292b29e70810885f7b87392b3440">se2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aeb0954d6b88572d22011197971383314">se3</a>,
<a name="l01834"></a>01834                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a29e70825ad053b216468503455bb0214">sgh2</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a20c7463d9a37296e4f7593aef4b9dc54">sgh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47354314263672ffdc413e858d973796">sgh4</a>,
<a name="l01835"></a>01835                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8efadcbb15a1adbad8c11bf5f40a78a0">sh2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a8cae07adc4894d76f34f1151106b7c5a">sh3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a5726b45b77929f68360f45c10e691c38">si2</a>,
<a name="l01836"></a>01836                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab92ea3cda54836cf52f1f49a45a091d6">si3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a86aa5d798754dfa4980396b2e64dbe94">sl2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a47e07031ea280bbb8e83e806ce8a56f1">sl3</a>,
<a name="l01837"></a>01837                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a66240f96efc1da3dcae357b8d60abcf9">sl4</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2918667d82664601fdbb1adf0fe44b1a">t</a>,    satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1bca79b6c4c54618eed4d63119b0e1f8">xgh2</a>,
<a name="l01838"></a>01838                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af05ab627562d999c64e336df0fa91648">xgh3</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a2eae2d27e095fa865573eb1e7960b1d6">xgh4</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aacee312ecab1273b95338ee624cab26c">xh2</a>,
<a name="l01839"></a>01839                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a4f3dfcf62b28e3edfd88c661dee36865">xh3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a0ed2e9d63d21b47f40e8c607d5a213a7">xi2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a27d129b5fb6c31bb6f8078331ad96fc0">xi3</a>,
<a name="l01840"></a>01840                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#abf7ca8d516b87cce30507326c24dbd88">xl2</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a54bf99247669242d5c363ae466c296f7">xl3</a>,  satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a807456dc2b50d3d68890b43771cc6d6c">xl4</a>,
<a name="l01841"></a>01841                satrec.<a class="code" href="structsgp4_1_1elsetrec.html#aec34eac95a270e7c2b17d79380b9ec2f">zmol</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ae613bff93cb6d8e07ef1c2d418dae7ae">zmos</a>, satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ad69aded71b2fbc457bf143b1bbca4077">inclo</a>,
<a name="l01842"></a>01842                <span class="charliteral">&#39;n&#39;</span>, ep, xincp, nodep, argpp, mp
<a name="l01843"></a>01843              );
<a name="l01844"></a>01844          <span class="keywordflow">if</span> (xincp &lt; 0.0)
<a name="l01845"></a>01845            {
<a name="l01846"></a>01846              xincp  = -xincp;
<a name="l01847"></a>01847              nodep = nodep + <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l01848"></a>01848              argpp  = argpp - <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l01849"></a>01849            }
<a name="l01850"></a>01850          <span class="keywordflow">if</span> ((ep &lt; 0.0 ) || ( ep &gt; 1.0))
<a name="l01851"></a>01851            {
<a name="l01852"></a>01852  <span class="comment">//            printf(&quot;# error ep %f\n&quot;, ep);</span>
<a name="l01853"></a>01853              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 3;
<a name="l01854"></a>01854            }
<a name="l01855"></a>01855        } <span class="comment">// if method = d</span>
<a name="l01856"></a>01856 
<a name="l01857"></a>01857      <span class="comment">/* -------------------- long period periodics ------------------ */</span>
<a name="l01858"></a>01858      <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> == <span class="charliteral">&#39;d&#39;</span>)
<a name="l01859"></a>01859        {
<a name="l01860"></a>01860          sinip =  sin(xincp);
<a name="l01861"></a>01861          cosip =  cos(xincp);
<a name="l01862"></a>01862          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6628418041a8ebe808d4cb5322c48f83">aycof</a> = -0.5*j3oj2*sinip;
<a name="l01863"></a>01863          <span class="comment">// sgp4fix for divide by zero for xincp = 180 deg</span>
<a name="l01864"></a>01864          <span class="keywordflow">if</span> (fabs(cosip+1.0) &gt; 1.5e-12)
<a name="l01865"></a>01865              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a> = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / (1.0 + cosip);
<a name="l01866"></a>01866            <span class="keywordflow">else</span>
<a name="l01867"></a>01867              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a> = -0.25 * j3oj2 * sinip * (3.0 + 5.0 * cosip) / temp4;
<a name="l01868"></a>01868        }
<a name="l01869"></a>01869      axnl = ep * cos(argpp);
<a name="l01870"></a>01870      temp = 1.0 / (am * (1.0 - ep * ep));
<a name="l01871"></a>01871      aynl = ep* sin(argpp) + temp * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a6628418041a8ebe808d4cb5322c48f83">aycof</a>;
<a name="l01872"></a>01872      xl   = mp + argpp + nodep + temp * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#af2cefc87aa6c05a5fc79076cc335f599">xlcof</a> * axnl;
<a name="l01873"></a>01873 
<a name="l01874"></a>01874      <span class="comment">/* --------------------- solve kepler&#39;s equation --------------- */</span>
<a name="l01875"></a>01875          <span class="comment">//ケプラー方程式を解く</span>
<a name="l01876"></a>01876      u    = fmod(xl - nodep, twopi);
<a name="l01877"></a>01877      eo1  = u;
<a name="l01878"></a>01878      tem5 = 9999.9;
<a name="l01879"></a>01879      ktr = 1;
<a name="l01880"></a>01880      <span class="comment">//   sgp4fix for kepler iteration</span>
<a name="l01881"></a>01881      <span class="comment">//   the following iteration needs better limits on corrections</span>
<a name="l01882"></a>01882      <span class="keywordflow">while</span> (( fabs(tem5) &gt;= 1.0e-12) &amp;&amp; (ktr &lt;= 10) )
<a name="l01883"></a>01883        {
<a name="l01884"></a>01884          sineo1 = sin(eo1);
<a name="l01885"></a>01885          coseo1 = cos(eo1);
<a name="l01886"></a>01886          tem5   = 1.0 - coseo1 * axnl - sineo1 * aynl;
<a name="l01887"></a>01887          tem5   = (u - aynl * coseo1 + axnl * sineo1 - eo1) / tem5;
<a name="l01888"></a>01888          <span class="keywordflow">if</span>(fabs(tem5) &gt;= 0.95)
<a name="l01889"></a>01889              tem5 = tem5 &gt; 0.0 ? 0.95 : -0.95;
<a name="l01890"></a>01890          eo1    = eo1 + tem5;
<a name="l01891"></a>01891          ktr = ktr + 1;
<a name="l01892"></a>01892        }
<a name="l01893"></a>01893 
<a name="l01894"></a>01894      <span class="comment">/* ------------- short period preliminary quantities ----------- */</span>
<a name="l01895"></a>01895      ecose = axnl*coseo1 + aynl*sineo1;
<a name="l01896"></a>01896      esine = axnl*sineo1 - aynl*coseo1;
<a name="l01897"></a>01897      el2   = axnl*axnl + aynl*aynl;
<a name="l01898"></a>01898      pl    = am*(1.0-el2);
<a name="l01899"></a>01899      <span class="keywordflow">if</span> (pl &lt; 0.0)
<a name="l01900"></a>01900        {
<a name="l01901"></a>01901 <span class="comment">//         printf(&quot;# error pl %f\n&quot;, pl);</span>
<a name="l01902"></a>01902          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 4;
<a name="l01903"></a>01903        }
<a name="l01904"></a>01904        <span class="keywordflow">else</span>
<a name="l01905"></a>01905        {
<a name="l01906"></a>01906          rl     = am * (1.0 - ecose);
<a name="l01907"></a>01907          rdotl  = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(am) * esine/rl;
<a name="l01908"></a>01908          rvdotl = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(pl) / rl;
<a name="l01909"></a>01909          betal  = <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(1.0 - el2);
<a name="l01910"></a>01910          temp   = esine / (1.0 + betal);
<a name="l01911"></a>01911          sinu   = am / rl * (sineo1 - aynl - axnl * temp);
<a name="l01912"></a>01912          cosu   = am / rl * (coseo1 - axnl + aynl * temp);
<a name="l01913"></a>01913          su     = atan2(sinu, cosu);
<a name="l01914"></a>01914          sin2u  = (cosu + cosu) * sinu;
<a name="l01915"></a>01915          cos2u  = 1.0 - 2.0 * sinu * sinu;
<a name="l01916"></a>01916          temp   = 1.0 / pl;
<a name="l01917"></a>01917          temp1  = 0.5 * j2 * temp;
<a name="l01918"></a>01918          temp2  = temp1 * temp;
<a name="l01919"></a>01919 
<a name="l01920"></a>01920          <span class="comment">/* -------------- update for short period periodics ------------ */</span>
<a name="l01921"></a>01921          <span class="keywordflow">if</span> (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#acbea6d8ebef99e4988322cb3cfec5569">method</a> == <span class="charliteral">&#39;d&#39;</span>)
<a name="l01922"></a>01922            {
<a name="l01923"></a>01923              cosisq                 = cosip * cosip;
<a name="l01924"></a>01924              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a>  = 3.0*cosisq - 1.0;
<a name="l01925"></a>01925              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> = 1.0 - cosisq;
<a name="l01926"></a>01926              satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a778cfb16c16daf12b5838cec9e0ec4c9">x7thm1</a> = 7.0*cosisq - 1.0;
<a name="l01927"></a>01927            }
<a name="l01928"></a>01928          mrt   = rl * (1.0 - 1.5 * temp2 * betal * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a>) +
<a name="l01929"></a>01929                  0.5 * temp1 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> * cos2u;
<a name="l01930"></a>01930          su    = su - 0.25 * temp2 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a778cfb16c16daf12b5838cec9e0ec4c9">x7thm1</a> * sin2u;
<a name="l01931"></a>01931          xnode = nodep + 1.5 * temp2 * cosip * sin2u;
<a name="l01932"></a>01932          xinc  = xincp + 1.5 * temp2 * cosip * sinip * cos2u;
<a name="l01933"></a>01933          mvt   = rdotl - nm * temp1 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> * sin2u / xke;
<a name="l01934"></a>01934          rvdot = rvdotl + nm * temp1 * (satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a1f073ef414189dd4901f8be74f4a1ade">x1mth2</a> * cos2u +
<a name="l01935"></a>01935                  1.5 * satrec.<a class="code" href="structsgp4_1_1elsetrec.html#a16ccb0fb0cd64d34c304756d1303f70a">con41</a>) / xke;
<a name="l01936"></a>01936 
<a name="l01937"></a>01937          <span class="comment">/* --------------------- orientation vectors ------------------- */</span>
<a name="l01938"></a>01938          sinsu =  sin(su);
<a name="l01939"></a>01939          cossu =  cos(su);
<a name="l01940"></a>01940          snod  =  sin(xnode);
<a name="l01941"></a>01941          cnod  =  cos(xnode);
<a name="l01942"></a>01942          sini  =  sin(xinc);
<a name="l01943"></a>01943          cosi  =  cos(xinc);
<a name="l01944"></a>01944          xmx   = -snod * cosi;
<a name="l01945"></a>01945          xmy   =  cnod * cosi;
<a name="l01946"></a>01946          ux    =  xmx * sinsu + cnod * cossu;
<a name="l01947"></a>01947          uy    =  xmy * sinsu + snod * cossu;
<a name="l01948"></a>01948          uz    =  sini * sinsu;
<a name="l01949"></a>01949          vx    =  xmx * cossu - cnod * sinsu;
<a name="l01950"></a>01950          vy    =  xmy * cossu - snod * sinsu;
<a name="l01951"></a>01951          vz    =  sini * cossu;
<a name="l01952"></a>01952 
<a name="l01953"></a>01953          <span class="comment">/* --------- position and velocity (in km and km/sec) ---------- */</span>
<a name="l01954"></a>01954          r[0] = (mrt * ux)* radiusearthkm;
<a name="l01955"></a>01955          r[1] = (mrt * uy)* radiusearthkm;
<a name="l01956"></a>01956          r[2] = (mrt * uz)* radiusearthkm;
<a name="l01957"></a>01957          v[0] = (mvt * ux + rvdot * vx) * vkmpersec;
<a name="l01958"></a>01958          v[1] = (mvt * uy + rvdot * vy) * vkmpersec;
<a name="l01959"></a>01959          v[2] = (mvt * uz + rvdot * vz) * vkmpersec;
<a name="l01960"></a>01960        }  <span class="comment">// if pl &gt; 0</span>
<a name="l01961"></a>01961 
<a name="l01962"></a>01962      <span class="comment">// sgp4fix for decaying satellites</span>
<a name="l01963"></a>01963      <span class="keywordflow">if</span> (mrt &lt; 1.0)             <span class="comment">//地球に激突して破壊？</span>
<a name="l01964"></a>01964        {
<a name="l01965"></a>01965 <span class="comment">//         printf(&quot;# decay condition %11.6f \n&quot;, mrt);</span>
<a name="l01966"></a>01966          satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a> = 6;
<a name="l01967"></a>01967        }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 
<a name="l01970"></a>01970 <span class="comment">//#include &quot;debug7.cpp&quot;</span>
<a name="l01971"></a>01971      <span class="keywordflow">return</span> satrec.<a class="code" href="structsgp4_1_1elsetrec.html#ab57488058495a162e7c6af4125010601">error</a>;
<a name="l01972"></a>01972 }  <span class="comment">// end sgp4</span>
<a name="l01973"></a>01973 
<a name="l01974"></a>01974 
<a name="l01975"></a>01975 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l01976"></a>01976 <span class="comment">*</span>
<a name="l01977"></a>01977 <span class="comment">*                           function gstime</span>
<a name="l01978"></a>01978 <span class="comment">*</span>
<a name="l01979"></a>01979 <span class="comment">*       ユリウス日から、グリニッジ平均恒星時の計算</span>
<a name="l01980"></a>01980 <span class="comment">*</span>
<a name="l01981"></a>01981 <span class="comment">*  this function finds the greenwich sidereal time.</span>
<a name="l01982"></a>01982 <span class="comment">*</span>
<a name="l01983"></a>01983 <span class="comment">*  author        : david vallado                  719-573-2600    1 mar 2001</span>
<a name="l01984"></a>01984 <span class="comment">*</span>
<a name="l01985"></a>01985 <span class="comment">*  inputs          description                    range / units</span>
<a name="l01986"></a>01986 <span class="comment">*    jdut1       - julian date in ut1             days from 4713 bc</span>
<a name="l01987"></a>01987 <span class="comment">*</span>
<a name="l01988"></a>01988 <span class="comment">*  outputs       :</span>
<a name="l01989"></a>01989 <span class="comment">*    gstime      - greenwich sidereal time        0 to 2pi rad</span>
<a name="l01990"></a>01990 <span class="comment">*</span>
<a name="l01991"></a>01991 <span class="comment">*  locals        :</span>
<a name="l01992"></a>01992 <span class="comment">*    temp        - temporary variable for doubles   rad</span>
<a name="l01993"></a>01993 <span class="comment">*    tut1        - julian centuries from the</span>
<a name="l01994"></a>01994 <span class="comment">*                  jan 1, 2000 12 h epoch (ut1)</span>
<a name="l01995"></a>01995 <span class="comment">*</span>
<a name="l01996"></a>01996 <span class="comment">*  coupling      :</span>
<a name="l01997"></a>01997 <span class="comment">*    none</span>
<a name="l01998"></a>01998 <span class="comment">*</span>
<a name="l01999"></a>01999 <span class="comment">*  references    :</span>
<a name="l02000"></a>02000 <span class="comment">*    vallado       2004, 191, eq 3-45</span>
<a name="l02001"></a>02001 <span class="comment">* --------------------------------------------------------------------------- */</span>
<a name="l02002"></a>02002 
<a name="l02003"></a>02003 <span class="keywordtype">double</span>  <a class="code" href="namespacesgp4.html#a865dc3d18e20afacb5bdf13a1e3a21cc">gstime</a>
<a name="l02004"></a><a class="code" href="namespacesgp4.html#a865dc3d18e20afacb5bdf13a1e3a21cc">02004</a>         (
<a name="l02005"></a>02005           <span class="keywordtype">double</span> jdut1
<a name="l02006"></a>02006         )
<a name="l02007"></a>02007    {
<a name="l02008"></a>02008      <span class="keyword">const</span> <span class="keywordtype">double</span> twopi = 2.0 * <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>;
<a name="l02009"></a>02009      <span class="keyword">const</span> <span class="keywordtype">double</span> deg2rad = <a class="code" href="sgp4unit_8cpp.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a> / 180.0;
<a name="l02010"></a>02010      <span class="keywordtype">double</span>       temp, tut1;
<a name="l02011"></a>02011 
<a name="l02012"></a>02012      tut1 = (jdut1 - 2451545.0) / 36525.0;
<a name="l02013"></a>02013      temp = -6.2e-6* tut1 * tut1 * tut1 + 0.093104 * tut1 * tut1 +
<a name="l02014"></a>02014              (876600.0*3600 + 8640184.812866) * tut1 + 67310.54841;  <span class="comment">// sec</span>
<a name="l02015"></a>02015      temp = fmod(temp * deg2rad / 240.0, twopi); <span class="comment">//360/86400 = 1/240, to deg, to rad</span>
<a name="l02016"></a>02016 
<a name="l02017"></a>02017      <span class="comment">// ------------------------ check quadrants ---------------------</span>
<a name="l02018"></a>02018      <span class="keywordflow">if</span> (temp &lt; 0.0)
<a name="l02019"></a>02019          temp += twopi;
<a name="l02020"></a>02020 
<a name="l02021"></a>02021 <span class="comment">/*</span>
<a name="l02022"></a>02022 <span class="comment">//debug用</span>
<a name="l02023"></a>02023 <span class="comment">        int temp1, temp2;</span>
<a name="l02024"></a>02024 <span class="comment">        double temp3;</span>
<a name="l02025"></a>02025 <span class="comment">        temp1 = (int)(temp*180/pi/15);</span>
<a name="l02026"></a>02026 <span class="comment">        temp2 = (int)((temp*180/pi/15-temp1)*60);</span>
<a name="l02027"></a>02027 <span class="comment">        temp3 = (((temp*180/pi/15-temp1)*60)-temp2)*60;</span>
<a name="l02028"></a>02028 <span class="comment">        std::cout &lt;&lt; &quot;グリニッジ平均恒星時gstime &quot; &lt;&lt; temp1 &lt;&lt; &quot;h&quot; &lt;&lt; temp2 &lt;&lt;  &quot;m&quot; &lt;&lt; temp3 &lt;&lt; &quot;s&quot; &lt;&lt; std::endl;</span>
<a name="l02029"></a>02029 <span class="comment">*/</span>
<a name="l02030"></a>02030 
<a name="l02031"></a>02031         <span class="keywordflow">return</span> temp;
<a name="l02032"></a>02032    }  <span class="comment">// end gstime</span>
<a name="l02033"></a>02033 
<a name="l02034"></a>02034 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l02035"></a>02035 <span class="comment">*</span>
<a name="l02036"></a>02036 <span class="comment">*                           function getgravconst</span>
<a name="l02037"></a>02037 <span class="comment">*</span>
<a name="l02038"></a>02038 <span class="comment">*       地球の扁平の情報（定数値）</span>
<a name="l02039"></a>02039 <span class="comment">*</span>
<a name="l02040"></a>02040 <span class="comment">*  this function gets constants for the propagator. note that mu is identified to</span>
<a name="l02041"></a>02041 <span class="comment">*    facilitiate comparisons with newer models. the common useage is wgs72.</span>
<a name="l02042"></a>02042 <span class="comment">*</span>
<a name="l02043"></a>02043 <span class="comment">*  author        : david vallado                  719-573-2600   21 jul 2006</span>
<a name="l02044"></a>02044 <span class="comment">*</span>
<a name="l02045"></a>02045 <span class="comment">*  inputs        :</span>
<a name="l02046"></a>02046 <span class="comment">*    whichconst  - which set of constants to use  wgs72old, wgs72, wgs84</span>
<a name="l02047"></a>02047 <span class="comment">*</span>
<a name="l02048"></a>02048 <span class="comment">*  outputs       :</span>
<a name="l02049"></a>02049 <span class="comment">*    tumin       - minutes in one time unit</span>
<a name="l02050"></a>02050 <span class="comment">*    mu          - earth gravitational parameter</span>
<a name="l02051"></a>02051 <span class="comment">*    radiusearthkm - radius of the earth in km</span>
<a name="l02052"></a>02052 <span class="comment">*    xke         - reciprocal of tumin</span>
<a name="l02053"></a>02053 <span class="comment">*    j2, j3, j4  - un-normalized zonal harmonic values</span>
<a name="l02054"></a>02054 <span class="comment">*    j3oj2       - j3 divided by j2</span>
<a name="l02055"></a>02055 <span class="comment">*</span>
<a name="l02056"></a>02056 <span class="comment">*  locals        :</span>
<a name="l02057"></a>02057 <span class="comment">*</span>
<a name="l02058"></a>02058 <span class="comment">*  coupling      :</span>
<a name="l02059"></a>02059 <span class="comment">*    none</span>
<a name="l02060"></a>02060 <span class="comment">*</span>
<a name="l02061"></a>02061 <span class="comment">*  references    :</span>
<a name="l02062"></a>02062 <span class="comment">*    norad spacetrack report #3</span>
<a name="l02063"></a>02063 <span class="comment">*    vallado, crawford, hujsak, kelso  2006</span>
<a name="l02064"></a>02064 <span class="comment">  --------------------------------------------------------------------------- */</span>
<a name="l02065"></a>02065 
<a name="l02066"></a>02066 <span class="keywordtype">void</span> <a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">getgravconst</a>
<a name="l02067"></a><a class="code" href="namespacesgp4.html#a31d2ab9f0caa3186f2cf69282ceeb062">02067</a>      (
<a name="l02068"></a>02068       <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9e">gravconsttype</a> whichconst,
<a name="l02069"></a>02069       <span class="keywordtype">double</span>&amp; tumin,
<a name="l02070"></a>02070       <span class="keywordtype">double</span>&amp; mu,
<a name="l02071"></a>02071       <span class="keywordtype">double</span>&amp; radiusearthkm,
<a name="l02072"></a>02072       <span class="keywordtype">double</span>&amp; xke,
<a name="l02073"></a>02073       <span class="keywordtype">double</span>&amp; j2,
<a name="l02074"></a>02074       <span class="keywordtype">double</span>&amp; j3,
<a name="l02075"></a>02075       <span class="keywordtype">double</span>&amp; j4,
<a name="l02076"></a>02076       <span class="keywordtype">double</span>&amp; j3oj2
<a name="l02077"></a>02077      )
<a name="l02078"></a>02078      {
<a name="l02079"></a>02079 
<a name="l02080"></a>02080        <span class="keywordflow">switch</span> (whichconst)
<a name="l02081"></a>02081          {
<a name="l02082"></a>02082            <span class="comment">// -- wgs-72 low precision str#3 constants --</span>
<a name="l02083"></a>02083            <span class="keywordflow">case</span> <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9eada1c4cc7011593a9ddb004935f8001fd">wgs72old</a>:
<a name="l02084"></a>02084            mu     = 398600.79964;        <span class="comment">// in km3 / s2</span>
<a name="l02085"></a>02085            radiusearthkm = 6378.135;     <span class="comment">// km</span>
<a name="l02086"></a>02086            xke    = 0.0743669161;
<a name="l02087"></a>02087            tumin  = 1.0 / xke;
<a name="l02088"></a>02088            j2     =   0.001082616;
<a name="l02089"></a>02089            j3     =  -0.00000253881;
<a name="l02090"></a>02090            j4     =  -0.00000165597;
<a name="l02091"></a>02091            j3oj2  =  j3 / j2;
<a name="l02092"></a>02092          <span class="keywordflow">break</span>;
<a name="l02093"></a>02093            <span class="comment">// ------------ wgs-72 constants ------------</span>
<a name="l02094"></a>02094            <span class="keywordflow">case</span> <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9ea61278da3b464fd069a7e15add91bd2f1">wgs72</a>:
<a name="l02095"></a>02095            mu     = 398600.8;            <span class="comment">// in km3 / s2</span>
<a name="l02096"></a>02096            radiusearthkm = 6378.135;     <span class="comment">// km</span>
<a name="l02097"></a>02097            xke    = 60.0 / <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(radiusearthkm*radiusearthkm*radiusearthkm/mu);
<a name="l02098"></a>02098            tumin  = 1.0 / xke;
<a name="l02099"></a>02099            j2     =   0.001082616;
<a name="l02100"></a>02100            j3     =  -0.00000253881;
<a name="l02101"></a>02101            j4     =  -0.00000165597;
<a name="l02102"></a>02102            j3oj2  =  j3 / j2;
<a name="l02103"></a>02103          <span class="keywordflow">break</span>;
<a name="l02104"></a>02104            <span class="keywordflow">case</span> <a class="code" href="namespacesgp4.html#a84be244094e484a8e83cc5dcb7b46e9eaa032d1c92304c8ac7c3d596f2c5d15d3">wgs84</a>:
<a name="l02105"></a>02105            <span class="comment">// ------------ wgs-84 constants ------------</span>
<a name="l02106"></a>02106            mu     = 398600.5;            <span class="comment">// in km3 / s2</span>
<a name="l02107"></a>02107            radiusearthkm = 6378.137;     <span class="comment">// km</span>
<a name="l02108"></a>02108            xke    = 60.0 / <a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(radiusearthkm*radiusearthkm*radiusearthkm/mu);
<a name="l02109"></a>02109            tumin  = 1.0 / xke;
<a name="l02110"></a>02110            j2     =   0.00108262998905;
<a name="l02111"></a>02111            j3     =  -0.00000253215306;
<a name="l02112"></a>02112            j4     =  -0.00000161098761;
<a name="l02113"></a>02113            j3oj2  =  j3 / j2;
<a name="l02114"></a>02114          <span class="keywordflow">break</span>;
<a name="l02115"></a>02115          <span class="keywordflow">default</span>:
<a name="l02116"></a>02116            fprintf(stderr, <span class="stringliteral">&quot;unknown gravity option (%d)\n&quot;</span>, whichconst);
<a name="l02117"></a>02117          <span class="keywordflow">break</span>;
<a name="l02118"></a>02118          }
<a name="l02119"></a>02119 
<a name="l02120"></a>02120      }   <span class="comment">// end getgravconst</span>
<a name="l02121"></a>02121 
<a name="l02122"></a>02122 } <span class="comment">/* end of namespace sgp4 */</span>
<a name="l02123"></a>02123 
<a name="l02124"></a>02124 
<a name="l02125"></a>02125 
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>クラス</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>STFに対してTue Mar 1 2011 03:45:41に生成されました。&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
